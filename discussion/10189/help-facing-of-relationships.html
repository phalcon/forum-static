---
layout: default
title: 'help facing of relationships - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">help facing of relationships</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a></span>
            <time itemprop="dateCreated" datetime="2016-01-16T03:06:17-07:00">Jan '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-01-16T03:06:17-07:00">Jan '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>399</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a></span>
                <span class="karma">3.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C10189" href="#C10189">
        <time class="action-date">Jan '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hello, i need help facing of relationships thrugh models,
in particular need to understand how best to manage to be able to take advantage of these.</p>
<p>I have this table:</p>
<pre><code class="language-php">
CREATE TABLE `album` (
    `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
    `title` VARCHAR(50) NULL DEFAULT NULL,
    `created_at` DATE NULL DEFAULT NULL,
    `updated_at` DATETIME NULL DEFAULT NULL,
    PRIMARY KEY (`id`)
)

CREATE TABLE `images` (
    `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
    `name` VARCHAR(50) NOT NULL,
    `tags` VARCHAR(50) NOT NULL,
    `created_at` DATE NULL DEFAULT NULL,
    `updated_at` DATETIME NULL DEFAULT NULL,
    PRIMARY KEY (`id`)
)

CREATE TABLE `user` (
    `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
    `email` VARCHAR(50) NOT NULL DEFAULT '0',
    `password` VARCHAR(128) NOT NULL DEFAULT '0',
    `role` ENUM('guest','user','admin') NOT NULL DEFAULT 'user',
    `created_at` DATETIME NULL DEFAULT '0000-00-00 00:00:00',
    `updated_at` DATETIME NULL DEFAULT '0000-00-00 00:00:00',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `email` (`email`)
)

CREATE TABLE `album_link` (
    `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
    `album_id` INT(10) NOT NULL,
    `image_id` INT(10) NOT NULL,
    `user_id` INT(10) NOT NULL,
    `created_at` DATE NULL DEFAULT NULL,
    `updated_at` DATETIME NULL DEFAULT NULL,
    PRIMARY KEY (`id`)
)
</code></pre>
<p>How i can manage relation betwin these tables, using models?</p>
<p>Thank you in advance.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/64937fb03590ecec8fe9b55cd7b307cc?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5153/patrickascher" class="user-moderator-N"><span itemprop="name">Patrick Ascher</span></a>        </span>
        <br>

        <span class="karma">8.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28963" href="#C28963">
                <time itemprop="dateCreated" datetime="2016-01-16T03:11:18-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>you should take the time and read the manual first!
<a href="https://docs.phalcon.io/en/latest/reference/models.html">https://docs.phalcon.io/en/latest/reference/models.html</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28963" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28963" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28967" href="#C28967">
                <time itemprop="dateCreated" datetime="2016-01-16T03:17:44-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Readed yet! im asking the best method to do that! hasMany or many.to-many...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28967" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28967" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d13fbfe44ba667e08060bc76bd53108d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4165/butamuh4o" class="user-moderator-N"><span itemprop="name">Boris Delev</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="28987" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '16</span>
              </span><br/><a name="C28987" href="#C28987">
                <time itemprop="dateCreated" datetime="2016-01-16T06:52:30-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Album -&gt; hasMany images / hasOne link (not sure what this link do, maybe is wrong has one, couse of image_id, but in that case, must be AlbumLinkS)</p>
<p>Images -&gt; belongsTo Album / hasOne link (its not bad idea to rename it to album_images... just a thought)</p>
<p>User -&gt; hasMany albums / hasOne link</p>
<p>AlbumLink -&gt; belongsTo Album, Image... etc</p>
<p>I didnt need many-to-many relation... not in that case.
Its up to u :) Good luck</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28987" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28987" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28993" href="#C28993">
                <time itemprop="dateCreated" datetime="2016-01-16T09:37:59-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>just time to try it ;)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28993" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28993" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28995" href="#C28995">
                <time itemprop="dateCreated" datetime="2016-01-16T09:51:06-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>OK...im stuck again, How i can take advantage from this models?</p>
<p>&lt;?php
$album-&gt;Images-&gt;name; ?
?&gt;</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28995" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28995" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d13fbfe44ba667e08060bc76bd53108d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4165/butamuh4o" class="user-moderator-N"><span itemprop="name">Boris Delev</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="29001" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '16</span>
              </span><br/><a name="C29001" href="#C29001">
                <time itemprop="dateCreated" datetime="2016-01-16T10:34:22-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thats easy. This relation will be hasMany, so, u can use something like that:</p>
<pre><code class="language-php">  $album = Models\Album::findFirst();
  $images = $album-&gt;getImages(); // Or just $album-&gt;Images... depends of alias or your needs and configuration
  foreach($images as $img) {
      echo $img-&gt;title;
  }</code></pre>
<p>If u have hasOne/belongsTo relation (emagine that album has only one image), u can use it the same way u describe : $album-&gt;Image-&gt;name;</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="29001" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="29001" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C29003" href="#C29003">
                <time itemprop="dateCreated" datetime="2016-01-16T12:14:53-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thank you, but findFirst return only 1 row into AlbumLink table,
if i try</p>
<pre><code>    $album = AlbumLink::find("album_id = $album_id");
     $images = $album-&gt;getImages();

     foreach($images as $img) {
         echo $img . "&lt;br/&gt;";
     }</code></pre>
<p>return:
Call to undefined method Phalcon\Mvc\Model\Resultset\Simple::getImages()</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="29003" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="29003" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="29005" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '16</span>
              </span><br/><a name="C29005" href="#C29005">
                <time itemprop="dateCreated" datetime="2016-01-16T13:09:34-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">$album = AlbumLink::findFirstByAlbumId($album_id);
$images = $album-&gt;getImages();
foreach ($images as $img) {
      echo $img . "&lt;br/&gt;";
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="29005" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="29005" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e87e77e80a7be9f33e718e7930c3e995?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/5807/starbuckit" class="user-moderator-N"><span itemprop="name">starbuckit</span></a>        </span>
        <br>

        <span class="karma">3.4k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="29007" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '16</span>
              </span><br/><a name="C29007" href="#C29007">
                <time itemprop="dateCreated" datetime="2016-01-16T13:24:31-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>fetch only one record but, i find a way to do this, i dont know if is the &quot;best&quot; but work:</p>
<pre><code>     $album_id = $this-&gt;request-&gt;getPost('album_id');

     $conditions = "album_id = :album_id:";
     $parameters = array(
         "album_id" =&gt; "$album_id"
     );

     $album = AlbumLink::find(
         array(
              $conditions,
              "bind" =&gt; $parameters
             )
     );

     $this-&gt;view-&gt;setVar('album', $album);

     -----VOLT TEMPLATE-----

     {% raw %}{%{% endraw %} for img in album {% raw %}%}{% endraw %}
     ..
     ....
     &lt;img id="{% raw %}{{{% endraw %} img.Images.id {% raw %}}}{% endraw %}" class="img-responsive" src="../albums_images/{% raw %}{{{% endraw %} img.Images.name {% raw %}}}{% endraw %}" alt=""&gt;
     ...
     ..
     {% raw %}{%{% endraw %} endfor {% raw %}%}{% endraw %}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="29007" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="29007" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d13fbfe44ba667e08060bc76bd53108d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4165/butamuh4o" class="user-moderator-N"><span itemprop="name">Boris Delev</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C29015" href="#C29015">
                <time itemprop="dateCreated" datetime="2016-01-17T05:22:51-07:00" class="action-date">Jan '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>:) seems fine, but u can consider that tips:</p>
<ol>
<li>too much variables, more simple/faster is just:</li>
</ol>
<pre><code class="language-php">  $this-&gt;view-&gt;album = AlbumLink::find([
    'conditions' =&gt; 'album_id = {album:int}',
    'bind' =&gt; ['album' =&gt; (int)$this-&gt;request-&gt;getPost('album_id')]
  ]); </code></pre>
<ol start="2">
<li>
<p>Try to think about relations and their names depends of number. For example, that <code>{% raw %}{{{% endraw %} img.Images.id {% raw %}}}{% endraw %}</code> its better to be just <code>{% raw %}{{{% endraw %} img.Image.id {% raw %}}}{% endraw %}</code></p>
</li>
<li>Check for exceptions - u can check in controller (for example) if u find any AlbumLink. If u didnt - return 404 error:</li>
</ol>
<pre><code class="language-php">$album = AlbumLink::find([
  'conditions' =&gt; 'album_id = {album:int}',
  'bind' =&gt; ['album' =&gt; (int)$this-&gt;request-&gt;getPost('album_id')]
]);

if (!$album) {
  $this-&gt;response-&gt;setStatusCode(404);  // switch to page 404 or redirect to it. (show diferent view)

  return ...
}

$this-&gt;view-&gt;album = $album;</code></pre>
<p>Good luck.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="29015" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="29015" data-cf-modified-9c457652c7e0be0bf4c8f8e8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="10189" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>