---
layout: default
title: 'Redirection form Micro application to Phalcon controller Not working - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/22/micro">Micro</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Redirection form Micro application to Phalcon controller Not working</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/6751/jackhad" class="user-moderator-N"><span itemprop="name">Aaronkeith</span></a></span>
            <time itemprop="dateCreated" datetime="2016-04-14T21:51:22-07:00">Apr '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-04-14T21:51:22-07:00">Apr '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Apr '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>640</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/ccbc99a41b75a854746cafe32377661e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/6751/jackhad" class="user-moderator-N"><span itemprop="name">Aaronkeith</span></a></span>
                <span class="karma">773</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11163" href="#C11163">
        <time class="action-date">Apr '16</time>
    </a>
</div>
<div class="post-content"><div><p>Im trying a application with phalcon and all the operations by web service .So Using Micro application for RestFul services.</p>
<p>See below my code: Usertypecontroller.php</p>
<p>public function createAction()
{
$ch = curl_init();  </p>
<p>curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
curl_setopt($ch, CURLOPT_POSTFIELDS, $_POST);
curl_setopt($ch,CURLOPT_URL,'<a href="http://localhost/xxx/yyy/api/usertype">http://localhost/xxx/yyy/api/usertype</a>');
curl_setopt($ch, CURLOPT_HEADER, FALSE);
curl_setopt($ch, CURLOPT_VERBOSE, 0);<br />
curl_setopt($ch, CURLOPT_RETURNTRANSFER, FALSE);
$data =  curl_exec();
curl_close($ch);
print_r($data);   // Here not printing the output!!
$this-&gt;dispatcher-&gt;forward(array(
'controller' =&gt; &quot;usertype&quot;,
'action' =&gt; 'index'
));
}</p>
<p>myrestAPI index.php file</p>
<p>$app-&gt;post('/api/usertype', function () use ($app) {
$usertype = new Usertype();
$usertype-&gt;name = $this-&gt;request-&gt;getPost(&quot;name&quot;);
$usertype-&gt;status = $this-&gt;request-&gt;getPost(&quot;status&quot;);
$usertype-&gt;createdon = $this-&gt;request-&gt;getPost(&quot;createdon&quot;);
$usertype-&gt;updateon = $this-&gt;request-&gt;getPost(&quot;updateon&quot;);
if (!$usertype-&gt;save()) {
foreach ($usertype-&gt;getMessages() as $message) {
$this-&gt;flash-&gt;error($message);
}
return;
}
// Create a response
$response = new Response();</p>
<pre><code>// Check if the insertion was successful
if ($usertype-&gt;save() == true) {

    // Change the HTTP status
    $response-&gt;setStatusCode(201, "Created");

    $usertype-&gt;user_type_id = $usertype-&gt;user_type_id;

    $response-&gt;setJsonContent(
        array(
            'status' =&gt; 'OK',
            'data'   =&gt; $usertype
        )
    );

} else {

    // Change the HTTP status
    $response-&gt;setStatusCode(409, "Conflict");

    // Send errors to the client
    $errors = array();
    foreach ($status-&gt;getMessages() as $message) {
        $errors[] = $message-&gt;getMessage();
    }

    $response-&gt;setJsonContent(
        array(
            'status'   =&gt; 'ERROR',
            'messages' =&gt; $errors
        )
    );
}    

return $response;</code></pre>
<p>});</p>
<p>Using Curl the the values are posting fine and inserting but its not redirecting to my controller and not showing my index page .it jut stops at my Curl and displaying</p>
<p>{&quot;status&quot;:&quot;OK&quot;,&quot;data&quot;:{&quot;user_type_id&quot;:&quot;71&quot;,&quot;name&quot;:&quot;zczxc&quot;,&quot;status&quot;:&quot;1&quot;{% raw %}}}{% endraw %}
I have tried with CURLOPT_RETURNTRANSFER and CURLOPT_FOLLOWLOCATION configs but nothing works.Anybody can help me would be grateful.Thanks</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1f92c8832155ca96cb3147af3cad27b0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6311/davihu" class="user-moderator-N"><span itemprop="name">David Hübner</span></a>        </span>
        <br>

        <span class="karma">9.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C32611" href="#C32611">
                <time itemprop="dateCreated" datetime="2016-04-15T06:47:23-07:00" class="action-date">Apr '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You are forwarding and not redirecting. I think you cant forward from micro application to regular application, try to use redirect instead</p>
<pre><code class="language-php">// Redirect to the default URI
$response-&gt;redirect();

// Redirect to the local base URI
$response-&gt;redirect("posts/index");

// Redirect to an external URL
$response-&gt;redirect("http://en.wikipedia.org", true);

// Redirect specifying the HTTP status code
$response-&gt;redirect("http://www.example.com/new-location", true, 301);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="32611" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="32611" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ccbc99a41b75a854746cafe32377661e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6751/jackhad" class="user-moderator-N"><span itemprop="name">Aaronkeith</span></a>        </span>
        <br>

        <span class="karma">773</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C32619" href="#C32619">
                <time itemprop="dateCreated" datetime="2016-04-15T07:36:50-07:00" class="action-date">Apr '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok but How to redirect with my response data? it seems very confusing</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="32619" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="32619" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1f92c8832155ca96cb3147af3cad27b0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6311/davihu" class="user-moderator-N"><span itemprop="name">David Hübner</span></a>        </span>
        <br>

        <span class="karma">9.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="32659" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '16</span>
              </span><br/><a name="C32659" href="#C32659">
                <time itemprop="dateCreated" datetime="2016-04-17T23:37:26-07:00" class="action-date">Apr '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You have to put it to query params</p>
<pre><code class="language-php">$response-&gt;redirect("http://www.example.com/new-location?status=OK&amp;data[usertypeid]=71&amp;...", true, 301);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="32659" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="32659" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ccbc99a41b75a854746cafe32377661e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6751/jackhad" class="user-moderator-N"><span itemprop="name">Aaronkeith</span></a>        </span>
        <br>

        <span class="karma">773</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="32671" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '16</span>
              </span><br/><a name="C32671" href="#C32671">
                <time itemprop="dateCreated" datetime="2016-04-18T02:04:08-07:00" class="action-date">Apr '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Not working!!
Here is my code:</p>
<p>$app-&gt;post('/api/usertype', function () use ($app) {
$usertype = new Usertype();
$usertype-&gt;name = $this-&gt;request-&gt;getPost(&quot;name&quot;);
$usertype-&gt;status = $this-&gt;request-&gt;getPost(&quot;status&quot;);
$usertype-&gt;createdon = $this-&gt;request-&gt;getPost(&quot;createdon&quot;);
$usertype-&gt;updatedon = $this-&gt;request-&gt;getPost(&quot;updatedon&quot;);</p>
<pre><code>if (!$usertype-&gt;save()) {
        foreach ($usertype-&gt;getMessages() as $message) {
            $this-&gt;flash-&gt;error($message);
        }

        return;
    }
 // Create a response
$response = new Response();
if ($usertype-&gt;save() == 1) {
    response-&gt;redirect("../xxxyyzzz/usertype/create?status=OK&amp;data[".$usertype-&gt;user_type_id."]", true, 301);

}else{
    $response-&gt;redirect("../xxxyyzzz/usertype/create?status=ERROR", true, 301);
}
});</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="32671" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="32671" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1f92c8832155ca96cb3147af3cad27b0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6311/davihu" class="user-moderator-N"><span itemprop="name">David Hübner</span></a>        </span>
        <br>

        <span class="karma">9.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C32679" href="#C32679">
                <time itemprop="dateCreated" datetime="2016-04-18T03:21:58-07:00" class="action-date">Apr '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Try ti send that response or return it? Does it return some error or what happens?</p>
<pre><code class="language-php">$response-&gt;send();

// or

return $response;</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="32679" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="32679" data-cf-modified-ecfbefeed5d0d72bf47c36d8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11163" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>