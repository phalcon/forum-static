---
layout: default
title: 'Only insert if both models dosent give error - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Only insert if both models dosent give error</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-29T02:23:41-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-29T02:23:41-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">8</span>
                </td>
                <td>
                    <label>Views</label><br>402</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
                <span class="karma">40.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7859" href="#C7859">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>How to do I stop one model from inserting if another model is failing?</p>
<p>I used this:</p>
<pre><code>if ($robot-&gt;save() == false &amp;&amp; $robot2-&gt;save == false) {
  echo "Umh, We can store robots: ";
  foreach ($robot-&gt;getMessages() as $message) {
echo message;
  }
 } else {
  echo "Great, a new robot was saved successfully!";
 }</code></pre>
<p>But if one of the robots success, it will insert, but the other one wont insert.. How do i make them talk together?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/4fcc65fc58f145c03887f40426db6ec0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4385/tyurderi" class="user-moderator-N"><span itemprop="name">Tommy</span></a>        </span>
        <br>

        <span class="karma">7.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21287" href="#C21287">
                <time itemprop="dateCreated" datetime="2015-07-29T02:28:41-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Use an array and iterate through it. When one robot can't be created or saved break the loop and so on.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21287" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21287" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21291" href="#C21291">
                <time itemprop="dateCreated" datetime="2015-07-29T03:16:45-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Do you mind giving me an example code?</p>
<p>And thanks for answering :-)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21291" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21291" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/4fcc65fc58f145c03887f40426db6ec0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4385/tyurderi" class="user-moderator-N"><span itemprop="name">Tommy</span></a>        </span>
        <br>

        <span class="karma">7.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21301" href="#C21301">
                <time itemprop="dateCreated" datetime="2015-07-29T04:27:44-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sure. But it isn't tested.</p>
<pre><code class="language-php">$robots = array(/*there are your robots you wanna save laterly*/);
$allSaved = true;

foreach($robots as $robot) {
    if(!$robot-&gt;save()) {
        echo "Umh, we can't store robot: ";
        foreach($robot-&gt;getMessages() as $message) {
            echo $message;
        }

        $allSaved = false;

        break;
    }
}

if($allSaved) {
    echo "Great, a new robot was saved successfully!";
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21301" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21301" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/b9095cdfa274d5bcc1aec8671313c172?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4527/nsossonko" class="user-moderator-N"><span itemprop="name">nsossonko</span></a>        </span>
        <br>

        <span class="karma">7.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21305" href="#C21305">
                <time itemprop="dateCreated" datetime="2015-07-29T04:54:29-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Actually you're looking for a transaction. You can set the transaction before starting the loop and then rollback at the end if there are any failures, otherwise commit. See here: <a href="https://docs.phalcon.io/en/latest/api/Phalcon_Mvc_Model_Transaction.html">https://docs.phalcon.io/en/latest/api/Phalcon_Mvc_Model_Transaction.html</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21305" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21305" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21313" href="#C21313">
                <time itemprop="dateCreated" datetime="2015-07-29T07:12:46-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You have to use transactions: <a href="https://docs.phalcon.io/en/latest/reference/model-transactions.html">https://docs.phalcon.io/en/latest/reference/model-transactions.html</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21313" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21313" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="21355" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C21355" href="#C21355">
                <time itemprop="dateCreated" datetime="2015-07-30T01:45:15-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for the many answers.</p>
<p>The problem is still there - If Users fails, but Blogs succed, then it will still create a blog with the domain name giving. But no user will be created...</p>
<pre><code class="language-php">$this-&gt;db-&gt;begin();
$robot              = new \Users();
$robot-&gt;firstname        = "WALL·E";

if ($robot-&gt;save() == false) {
    foreach ($robot-&gt;getMessages() as $message) {
            echo $message, "\n";
    }
return;
}

                    $robotPart            = new \Blogs();
                    $robotPart-&gt;userid = $robot-&gt;id;
                    $robotPart-&gt;domain      = "domain";

                    if ($robotPart-&gt;save() == false) {
                        foreach ($robotPart-&gt;getMessages() as $message) {
        echo $message, "\n";
    }
}

$this-&gt;db-&gt;commit();</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21355" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21355" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/b9095cdfa274d5bcc1aec8671313c172?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4527/nsossonko" class="user-moderator-N"><span itemprop="name">nsossonko</span></a>        </span>
        <br>

        <span class="karma">7.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21367" href="#C21367">
                <time itemprop="dateCreated" datetime="2015-07-30T07:11:20-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You're not rolling back the transaction...you need to rollback in case of error. In fact, in the case of the blogs error, you're not even returning early, you're proceeding straight to the commit...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21367" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21367" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21371" href="#C21371">
                <time itemprop="dateCreated" datetime="2015-07-30T07:26:36-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hm, i don't seem to understand, could you make an example ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21371" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21371" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21373" href="#C21373">
                <time itemprop="dateCreated" datetime="2015-07-30T07:35:53-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>When i put in $this-&gt;db-&gt;rollback() i get this error &quot;There is no active transaction&quot;</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21373" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21373" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/b9095cdfa274d5bcc1aec8671313c172?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4527/nsossonko" class="user-moderator-N"><span itemprop="name">nsossonko</span></a>        </span>
        <br>

        <span class="karma">7.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21377" href="#C21377">
                <time itemprop="dateCreated" datetime="2015-07-30T08:13:38-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">                $this-&gt;db-&gt;begin();

                $robot              = new \Users();
                $robot-&gt;firstname        = "WALL·E";

                $robotPart            = new \Blogs();
                $robotPart-&gt;userid = $robot-&gt;id;
                $robotPart-&gt;domain      = "domain";

                if ($robot-&gt;save() == false) {
                    foreach ($robot-&gt;getMessages() as $message) {
                        echo $message, "\n";
                    }
                    return;
                }
                if ($robotPart-&gt;save() == false) {
                    foreach ($robotPart-&gt;getMessages() as $message) {
                        echo $message, "\n";
                    }
                    if ($this-&gt;db-&gt;isUnderTransaction()) {
                        $this-&gt;db-&gt;rollback();
                    }
                    return;
                }

                $this-&gt;db-&gt;commit();</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21377" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21377" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21381" href="#C21381">
                <time itemprop="dateCreated" datetime="2015-07-30T08:59:39-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Okay, i dont get the error from $RobotPart - Only if $robot success and i need all errors at once.. :-I</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21381" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21381" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/b9095cdfa274d5bcc1aec8671313c172?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4527/nsossonko" class="user-moderator-N"><span itemprop="name">nsossonko</span></a>        </span>
        <br>

        <span class="karma">7.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21383" href="#C21383">
                <time itemprop="dateCreated" datetime="2015-07-30T09:07:15-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>So store the result of the save in a variable and check it at the end. Then rollback and return only at the end.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21383" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21383" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21393" href="#C21393">
                <time itemprop="dateCreated" datetime="2015-07-30T09:22:21-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">try {
    $this-&gt;db-&gt;begin();

    $robot              = new \Users();
    $robot-&gt;firstname        = "WALL·E";

    $robotPart            = new \Blogs();
    $robotPart-&gt;userid = $robot-&gt;id;
    $robotPart-&gt;domain      = "domain";

    if ($robot-&gt;save() == false) {
        foreach ($robot-&gt;getMessages() as $message) {
            throw new Exception((string) $message-&gt;getMessage());
        }        
    }

    if ($robotPart-&gt;save() == false) {
        foreach ($robotPart-&gt;getMessages() as $message) {
            throw new Exception((string) $message-&gt;getMessage());
        }
    }

    $this-&gt;db-&gt;commit();

} catch (\Exception $e) {
    $this-&gt;db-&gt;rollback();
    echo $e-&gt;getMessage();
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21393" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21393" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21407" href="#C21407">
                <time itemprop="dateCreated" datetime="2015-07-31T02:15:44-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Andres thanks for you answer, but that dosent solve my problem.. I need to insert only if robot and robotpart is success, and i need to display all the errors from robot and robotPart at once.. Your code only displays one error..</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21407" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21407" data-cf-modified-31aa5cb4ac5a3a2757963c71-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7859" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>