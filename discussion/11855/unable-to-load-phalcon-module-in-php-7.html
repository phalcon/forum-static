---
layout: default
title: 'Unable to load Phalcon module in PHP 7 - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/6/installation">Installation</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Unable to load Phalcon module in PHP 7</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/7531/newcom" class="user-moderator-N"><span itemprop="name">newcom</span></a></span>
            <time itemprop="dateCreated" datetime="2016-06-16T17:06:36-07:00">Jun '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-06-16T17:06:36-07:00">Jun '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>1408</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/f942d9fd11c8cbf891aad5f0e31b767d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/7531/newcom" class="user-moderator-N"><span itemprop="name">newcom</span></a></span>
                <span class="karma">1.5k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11855" href="#C11855">
        <time class="action-date">Jun '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hi Phalconites,</p>
<p>I have been trying to install phalcon under PHP 7 without success.</p>
<p>The install runs fine, however when i try to start php-fpm i receive the following error:</p>
<p><strong>&gt; undefined symbol: zend_std_call_user_call in Unknown on line 0</strong></p>
<p>I am very new to Phalcon and would appreciate any assistance available.</p>
<p>Thanks</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1f10cf3015dc4f8e9ff090600b8cf39f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2755/xeleniumz" class="user-moderator-N"><span itemprop="name">xeleniumz</span></a>        </span>
        <br>

        <span class="karma">11.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35685" href="#C35685">
                <time itemprop="dateCreated" datetime="2016-06-16T19:33:06-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>give us more detail about your system envirovment</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35685" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35685" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35687" href="#C35687">
                <time itemprop="dateCreated" datetime="2016-06-16T23:34:16-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>How did you install it ? You need to use latests zephir and phalcon 2.1.x repository. You sure you have php7 dev package ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35687" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35687" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f942d9fd11c8cbf891aad5f0e31b767d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/7531/newcom" class="user-moderator-N"><span itemprop="name">newcom</span></a>        </span>
        <br>

        <span class="karma">1.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35715" href="#C35715">
                <time itemprop="dateCreated" datetime="2016-06-17T06:54:43-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for the response.</p>
<p>So the installation steps are below:</p>
<ul>
<li>Installed NGINX</li>
<li>Installed php-fpm 5.6</li>
<li>Installed php-fpm 7.1</li>
<li>git clone phalcon and run ./install</li>
<li>copied generated phalcon.so files to both php 5.6 and 7.1 directories</li>
<li>started both php-fpm 5.6 and 7.1</li>
<li>upon starting php-fpm 5.6, i got the notice message &quot;undefined symbol: php_pdo_get_dbh_ce in Unknown on line 0&quot;, but when looking through phpinfo, the module was loaded</li>
<li>when starting php-fpm 7.1 i get the message &quot;undefined symbol: zend_std_call_user_call in Unknown on line 0&quot;</li>
<li>ran command 'yum install re2c php-json php-dev libpcre3-dev'. libpcre3-dev was not found but the below steps still processed successfully (could be an issue)</li>
<li>i then git cloned zephir, ran install successfully</li>
<li>then went to the cphalcon directory and ran the command 'git checkout 2.1.x'</li>
<li>then ran command 'zephir build --zendEngine=3'</li>
</ul>
<p>I think the steps I am missing are:</p>
<ul>
<li>after running 'zephir build --zendEngine=3' and the process is completed, I am not sure where the newly generated library files are.</li>
<li>I installed php-dev which used version 5.6. Seeing that both php 5.6 and 7.1 is installed, is there a way to create the library files for each version?</li>
<li>I have since installed php71-php-devel. How can I build the phalcon library using this version?</li>
</ul>
<p>A quick background on why i have done the install this way, is that i am trying to test the difference in performance between php 5.6 and 7.1 using Phalcon.</p>
<p>Based on this I can put a case forward for using Phalcon for our future/existing projects and also explore upgrading to PHP 7.</p>
<p>Any help would be appreciated.</p>
<p>Thanks</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35715" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35715" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="35717" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '16</span>
              </span><br/><a name="C35717" href="#C35717">
                <time itemprop="dateCreated" datetime="2016-06-17T07:07:41-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You need to build phalcon seperate for php 5.6 and php 7.1, the same extension can't work for both versions, first try to write php -v and check on which version you currently are. If you are on php 7 then you just need use zephir for building it and phalcon <strong>2.1.x</strong></p>
<p>Zephir build will automatically install extnesion to php lib folder.</p>
<p><code>upon starting php-fpm 5.6, i got the notice message "undefined symbol: phppdogetdbhce in Unknown on line 0", but when looking through phpinfo, the module was loaded</code></p>
<p>You need to load pdo BEFORE phalcon in this case.</p>
<p><code>when starting php-fpm 7.1 i get the message "undefined symbol: zendstdcallusercall in Unknown on line 0"</code></p>
<p>Here you have error beacause you copied phalcon from php 5.6 to php 7.1</p>
<p>If you want have both php versions at once then i would recommend just using phpbrew <a href="https://github.com/phpbrew/phpbrew">https://github.com/phpbrew/phpbrew</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35717" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35717" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f942d9fd11c8cbf891aad5f0e31b767d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/7531/newcom" class="user-moderator-N"><span itemprop="name">newcom</span></a>        </span>
        <br>

        <span class="karma">1.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35741" href="#C35741">
                <time itemprop="dateCreated" datetime="2016-06-17T16:51:13-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok, so I got this working.</p>
<p>Thanks a lot Wojciech, PHPBrew is exactly what i needed.</p>
<p>This is what i did:</p>
<ul>
<li>removed all versions of php</li>
<li>re-installed php 5.6</li>
<li>installed phpbrew</li>
<li>install php 5.6 and 7.0 using phpbrew</li>
<li>switched to the php 5.6 instance within phpbrew using 'phpbrew switch php-5.6.22'</li>
<li>went to the cphalcon folder and ran the command './install'. This created the phalcon.so file and copied it to the folder for the 5.6 instance</li>
<li>then switched to the php 7.0 instance within phpbrew using 'phpbrew switch php-7.0.7'</li>
<li>in the cphalcon directory ran 'git checkout 2.1.x'</li>
<li>then i ran command 'zephir fullclean' and then 'zephir install'</li>
<li>This created the phalcon.so file and copied it to the folder for the 7.0 instance</li>
<li>for both 5.6 and 7.0, I added 'extension=phalcon.so' to the php.ini file</li>
<li>restarted php-fpm for both 5.6 and 7.0</li>
<li>and voila</li>
</ul>
<p>i installed phalcon-devtools after and created a project called 'myphalcon1', but when i browsed to the site in my browser got the error 'Mod-rewrite not enabled'.  I used the below in the nginx file to fix:</p>
<pre><code>location @phalcon {
    rewrite ^/myphalcon1/public(.+)$ /myphalcon1/public/index.php?_url=$1 last;
}

location /myphalcon1/ {
    index index.php;
    if ($uri !~ ^/myphalcon1/public) {
        rewrite ^/myphalcon1(.*)$ /myphalcon1/public$1;
    }
    try_files $uri $uri/ @phalcon;
}</code></pre>
<p>maybe some light can be shed on the NGINX part by the pros here</p>
<p>Thanks all for the help</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35741" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35741" data-cf-modified-db29dc5e6341d6a3b3cf1743-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11855" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>