---
layout: default
title: '&quot;Lean&quot; find results for better performance - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">&quot;Lean&quot; find results for better performance</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/4207/Swift-R" class="user-moderator-N"><span itemprop="name">Miguel Nunes</span></a></span>
            <time itemprop="dateCreated" datetime="2016-08-30T08:56:16-07:00">Aug '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-08-30T08:56:16-07:00">Aug '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Aug '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>430</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/c941fb704d32764b3b6bc1a9dbfd6ccb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/4207/Swift-R" class="user-moderator-N"><span itemprop="name">Miguel Nunes</span></a></span>
                <span class="karma">10.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C13287" href="#C13287">
        <time class="action-date">Aug '16</time>
    </a>
</div>
<div class="post-content"><div><p>Mongoose API has a method to remove those save, getters and setters from <code>find()</code> results called <code>lean()</code>. That improves the performance of <code>find()</code> when using large data. Does Phalcon have an equivalent method? Or a better way to retrieve a huge amount of rows from the database?</p>
<p>This is their doc: <a href="http://mongoosejs.com/docs/api.html#query_Query-lean">http://mongoosejs.com/docs/api.html#query_Query-lean</a></p>
<p>Edit: It seems this forum replaces the link and it doesn't anchor to the correct topic. Just search for &quot;lean(&quot; and it will get there.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-c9ec3267266cbf3695d04577-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-c9ec3267266cbf3695d04577-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C39451" href="#C39451">
                <time itemprop="dateCreated" datetime="2016-08-30T09:18:02-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><code>toArray()</code> ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39451" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39451" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c941fb704d32764b3b6bc1a9dbfd6ccb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4207/Swift-R" class="user-moderator-N"><span itemprop="name">Miguel Nunes</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="39455" data-toggle="modal" data-target="#historyModal">
                edited <span>Aug '16</span>
              </span><br/><a name="C39455" href="#C39455">
                <time itemprop="dateCreated" datetime="2016-08-30T09:45:38-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Doesn't that still build the full object and then convert it to a data array?</p>
<p>Edit: I'll start making some benchmarks now...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39455" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39455" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C39457" href="#C39457">
                <time itemprop="dateCreated" datetime="2016-08-30T09:48:17-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It's possible. In ORM you can select columns which you want - then it's building partial class(Row). But don't know about ODM.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39457" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39457" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c941fb704d32764b3b6bc1a9dbfd6ccb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4207/Swift-R" class="user-moderator-N"><span itemprop="name">Miguel Nunes</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C39461" href="#C39461">
                <time itemprop="dateCreated" datetime="2016-08-30T10:06:51-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Just tested, using <code>Gadb::find()-&gt;toArray()</code> doesn't stop creating the object with save, getters and setters, etc... Execution went from 0.10 to 0.15 microseconds on a 31280 row database. Funny that I tried using <code>$this-&gt;db-&gt;fetchAll("SELECT * FROM gadb")</code> and that took 0.17. How can this be slower?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39461" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39461" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="39463" data-toggle="modal" data-target="#historyModal">
                edited <span>Aug '16</span>
              </span><br/><a name="C39463" href="#C39463">
                <time itemprop="dateCreated" datetime="2016-08-30T10:08:30-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Oh then you mean just mysql ? Then try selecting columns which you only need, not all. I don't know how can be slowe, maybe just in one case it took 0.17. Phalcon will always return objects obviously - this is how ORM works.</p>
<p>Also toArray() methods is faster than iterating over each object. It you will iterate over them, do something for displaying or anything - it will be much slower than working on result from toArray method.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39463" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39463" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c941fb704d32764b3b6bc1a9dbfd6ccb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4207/Swift-R" class="user-moderator-N"><span itemprop="name">Miguel Nunes</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C39465" href="#C39465">
                <time itemprop="dateCreated" datetime="2016-08-30T10:19:46-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This is for an API. The idea is to get all airports from that database and send it as a JSON response. There will be no other interaction with the result, just a conversion to JSON. And that's the reason I wanted a method to skip the creation of those extra methods and return a plain object instead of the Phalcon object, just like mongoose.</p>
<p>And no, it wasn't only one case where it took 0.17. I'm really confused.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39465" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39465" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C39467" href="#C39467">
                <time itemprop="dateCreated" datetime="2016-08-30T10:33:02-07:00" class="action-date">Aug '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Then you need to use toArray() anyway. Gadb::find() will return resultset. toArray() is exactly what you need to do. Any further performance gains can be done by selecting columns which you only need(you really need to return all of columns ? i doubt it) or using cache(eveny mysql built-in result cache if you not using it yet, on any insert/update it just invalidate all keys.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="39467" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="39467" data-cf-modified-c9ec3267266cbf3695d04577-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="13287" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>