---
layout: default
title: 'Model UPDATE on save() when must be INSERT - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Model UPDATE on save() when must be INSERT</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/27/aigars-m" class="user-moderator-N"><span itemprop="name">aigars-m</span></a></span>
            <time itemprop="dateCreated" datetime="2013-05-19T12:39:20-07:00">May '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-05-19T12:39:20-07:00">May '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '13</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>2351</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">3</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/ae0d1ab11d1f3e97be6183ce71c9404e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/27/aigars-m" class="user-moderator-N"><span itemprop="name">aigars-m</span></a></span>
                <span class="karma">16.1k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C341" href="#C341">
        <time class="action-date">May '13</time>
    </a>
</div>
<div class="post-content"><div><p>There is big problem with models in Phalcon 1.1. I have similar code like this:</p>
<pre><code class="language-php">class User extends \Phalcon\Mvc\Model
{
    public $id;    
    public $email;
    function myCustomUserCreator(){
        $newUser = new User();
        $newUser-&gt;email= 'test'; 
            if($newUser-&gt;save()==false){                
                return false;
            } else {                 
                return $newUser-&gt;id;
            }
    }
}
print User::myCustomUserCreator();</code></pre>
<p>This code always execute UPDATE and on execution returns new values from mysql auto increment (1,2,3,4 etc.)
This is very strange, because I wrote &quot;new User()&quot;, what means that I have to INSERT new record in table with save().
Can somebody explain why it works so or it is some phalcon bug? In other frameworks (Yii, Zend) this works without problems.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">3</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C1416" href="#C1416">
                <time itemprop="dateCreated" datetime="2013-05-19T20:53:34-07:00" class="action-date">May '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This is your code: <a href="https://gist.github.com/phalcon/5610308">https://gist.github.com/phalcon/5610308</a></p>
<p>I'm running it here: <a href="https://test.phalcon.io/orm-1.php">https://test.phalcon.io/orm-1.php</a></p>
<p>As you can see, there are only INSERTs returning the numeric id generated by the database</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="1416" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="1416" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ae0d1ab11d1f3e97be6183ce71c9404e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/27/aigars-m" class="user-moderator-N"><span itemprop="name">aigars-m</span></a>        </span>
        <br>

        <span class="karma">16.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C1418" href="#C1418">
                <time itemprop="dateCreated" datetime="2013-05-19T21:08:54-07:00" class="action-date">May '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>try to change  Phalcon\Db\Adapter\Pdo\Sqlite as Connection,
to
Phalcon\Db\Adapter\Pdo\Mysql as Connection</p>
<p>I tried this code locally and it also try to update.
If I write myCustomUserCreator function code outside User class, for example in controller action method then everything is fine.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="1418" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="1418" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C1419" href="#C1419">
                <time itemprop="dateCreated" datetime="2013-05-19T21:26:51-07:00" class="action-date">May '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Code: <a href="https://gist.github.com/phalcon/5610396">https://gist.github.com/phalcon/5610396</a></p>
<p>Running: <a href="https://test.phalcon.io/orm-2.php">https://test.phalcon.io/orm-2.php</a></p>
<p>SELECT IF(COUNT(<em>)&gt;0, 1 , 0) FROM <code>INFORMATION_SCHEMA</code>.<code>TABLES</code> WHERE <code>TABLE_NAME</code>= 'user' AND <code>TABLE_SCHEMA</code>='test'
SELECT IF(COUNT(</em>)&gt;0, 1 , 0) FROM <code>INFORMATION_SCHEMA</code>.<code>TABLES</code> WHERE <code>TABLE_NAME</code>='user'
DESCRIBE <code>user</code>
INSERT INTO <code>user</code> (<code>email</code>) VALUES (?)
5</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="1419" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="1419" data-cf-modified-c914a20a80f0c76ae2651e4b-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="341" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>