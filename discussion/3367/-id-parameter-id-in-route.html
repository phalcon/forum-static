---
layout: default
title: 'Параметр id в роутере / Parameter ID in route - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/13/routing">Routing</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Параметр id в роутере / Parameter ID in route</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a></span>
            <time itemprop="dateCreated" datetime="2014-09-05T03:06:12-07:00">Sep '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-09-05T03:06:12-07:00">Sep '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Sep '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>645</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a></span>
                <span class="karma">10.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C3367" href="#C3367">
        <time class="action-date">Sep '14</time>
    </a>
</div>
<div class="post-content"><div><p>Подскажите, по какой причине не работает такой роут</p>
<pre><code class="language-php">$router-&gt;add('/admin/:controller/:action/:id', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);</code></pre>
<p>но работает вот такой:</p>
<pre><code class="language-php">$router-&gt;add('/admin/:controller/:action/{id:[0-9]+}', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);</code></pre>
<hr />
<p>Tell me, why this route is not working:</p>
<pre><code class="language-php">$router-&gt;add('/admin/:controller/:action/:id', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);</code></pre>
<p>But this is working fine:</p>
<pre><code class="language-php">$router-&gt;add('/admin/:controller/:action/{id:[0-9]+}', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11060" href="#C11060">
                <time itemprop="dateCreated" datetime="2014-09-05T03:37:31-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Нет, все хуже. По второму роуту маршрут определяется, но параметр - нет. Вот роут:</p>
<pre><code class="language-php">$router-&gt;add('/admin/:controller/:action/{id:[0-9]+}', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);</code></pre>
<p>Вот код для проверки:</p>
<pre><code class="language-php">$router-&gt;handle('/admin/user/edit/6');
            if ($router-&gt;wasMatched()) {
                echo 'Модуль (Module): ', $router-&gt;getModuleName(), '&lt;br/&gt;';
                echo 'Контроллер (Controller): ', $router-&gt;getControllerName(), '&lt;br&gt;';
                echo 'Действие (Action): ', $router-&gt;getActionName(), '&lt;br&gt;';
                echo '&lt;br/&gt;Matches:&lt;br/&gt;';
                var_export($router-&gt;getMatches());
                echo '&lt;br/&gt;&lt;br/&gt;Params:&lt;br/&gt;';
                var_export($router-&gt;getParams());
            } else {
                echo 'Not found&lt;br&gt;';
            };
            die;</code></pre>
<p>Вот результат:</p>
<pre><code class="language-php">Модуль (Module): backend
Контроллер (Controller): user
Действие (Action): edit

Matches:
array ( 0 =&gt; '/admin/user/edit/6', 1 =&gt; 'user', 2 =&gt; 'edit', 3 =&gt; '6', )

Params:
array ( 'id' =&gt; 'user', )</code></pre>
<p>Т.е., в matches все правильно, а вот в params попадает уже мусор. Что не так?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11060" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11060" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ca583aafbe57c402a106b0aaa70da0a2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/951/Sweet-Bob" class="user-moderator-N"><span itemprop="name">Sweet-Bob</span></a>        </span>
        <br>

        <span class="karma">10.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11063" href="#C11063">
                <time itemprop="dateCreated" datetime="2014-09-05T04:33:34-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><ol>
<li>В документации есть момент, что маршрут разбирается определенным образом: действие/контроллер/параметр. </li>
<li>Как я понял вещи {id: [preg]} используются для конвертации (есть функция convert, для преобразования параметра), при этом неявно создается переменная $id, с которой можно работать далее.</li>
<li>Ты должен использовать ( ), по аналогии с регулярными выражениями (как я понял), для того чтобы использовать 1,2,3. Например ({id: [preg}).</li>
</ol></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11063" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11063" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11066" href="#C11066">
                <time itemprop="dateCreated" datetime="2014-09-05T04:56:29-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>По поводу 3-го пункта - не помогает, проверял.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11066" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11066" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ca583aafbe57c402a106b0aaa70da0a2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/951/Sweet-Bob" class="user-moderator-N"><span itemprop="name">Sweet-Bob</span></a>        </span>
        <br>

        <span class="karma">10.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11067" href="#C11067">
                <time itemprop="dateCreated" datetime="2014-09-05T04:58:50-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Может у тебя есть другие маршруты? Существует порядок (нижний главный)</p>
<pre><code>$router-&gt;add('/admin/:controller/:action/{id:[0-9]+}', [
    'module'      =&gt; 'backend',
    'controller'  =&gt; 1,
    'action'      =&gt; 2,
    'id'          =&gt; 3,
]);

$router-&gt;add('/admin/:controller/:action, [
    'module'      =&gt; 'backend',
    'controller'  =&gt; 1,
    'action'      =&gt; 2,
]);</code></pre>
<p>Отработает последний.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11067" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11067" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11068" href="#C11068">
                <time itemprop="dateCreated" datetime="2014-09-05T05:09:46-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Да, существуют. Но работает, вроде как, именно тот, что нужно (последний в роутах):</p>
<pre><code class="language-php">&lt;?php

/**
 * @var $router \Phalcon\Mvc\Router
 */

/**
 * Not found route
 */
$router-&gt;notFound([
    'module'        =&gt; 'frontend',
    'controller'    =&gt; 'error',
    'action'        =&gt; 'notFound',
]);

/**
 * Frontend routes
 */

$router-&gt;add('/', [
    'module'        =&gt; 'frontend',
    'controller'    =&gt; 'main',
    'action'        =&gt; 'index',
]);

$router-&gt;add('/:controller', [
    'module'        =&gt; 'frontend',
    'controller'    =&gt; 1,
    'action'        =&gt; 'index',
]);

$router-&gt;add('/:controller/:action', [
    'module'        =&gt; 'frontend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
]);

$router-&gt;add('/(login|logout|register|reminder|profile|email|token)', [
    'module'        =&gt; 'frontend',
    'controller'    =&gt; 'user',
    'action'        =&gt; 1,
])-&gt;setName('user');

/**
 * API routes
 */
$router-&gt;add('/api/{version:([0-9]+(\.[0-9]+)?)}/:controller', [
    'module'        =&gt; 'api',
    'controller'    =&gt; 3,
    'action'        =&gt; 'index',
    'version'       =&gt; 1,
]);

/**
 * Backend routes
 */
$router-&gt;add('/admin', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 'main',
    'action'        =&gt; 'index',
]);

$router-&gt;add('/admin/:controller', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 'index',
]);

$router-&gt;add('/admin/:controller/:action', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
]);

$router-&gt;add('/admin/:controller/:action/{id:[0-9]+}', [
    'module'        =&gt; 'backend',
    'controller'    =&gt; 1,
    'action'        =&gt; 2,
    'id'            =&gt; 3,
]);
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11068" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11068" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ca583aafbe57c402a106b0aaa70da0a2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/951/Sweet-Bob" class="user-moderator-N"><span itemprop="name">Sweet-Bob</span></a>        </span>
        <br>

        <span class="karma">10.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11069" href="#C11069">
                <time itemprop="dateCreated" datetime="2014-09-05T05:33:06-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Мне кажется, что маршруты не отрабатывают как надо. Попробуй исправить:</p>
<pre><code>$router-&gt;add('/admin/:controller/:action/:params', [
    'module'      =&gt; 'backend',
    'controller'  =&gt; 1,
    'action'      =&gt; 2,
    'params'  =&gt; 3,
]);</code></pre>
<p>Этот маршрут должен точно отработать.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11069" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11069" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11071" href="#C11071">
                <time itemprop="dateCreated" datetime="2014-09-05T05:40:35-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Да, этот работает. Но как заставить работать именованый параметр?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11071" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11071" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ca583aafbe57c402a106b0aaa70da0a2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/951/Sweet-Bob" class="user-moderator-N"><span itemprop="name">Sweet-Bob</span></a>        </span>
        <br>

        <span class="karma">10.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="11072" data-toggle="modal" data-target="#historyModal">
                edited <span>Sep '14</span>
              </span><br/><a name="C11072" href="#C11072">
                <time itemprop="dateCreated" datetime="2014-09-05T05:45:09-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code>$router-&gt;add('/admin/:controller/:action/([a-zA-Z0-9_-]+)', [
    'module'      =&gt; 'backend',
    'controller'  =&gt; 1,
    'action'      =&gt; 2,
    'id'  =&gt; 3,
]);</code></pre>
<p>Так тоже должно работать</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11072" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11072" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11073" href="#C11073">
                <time itemprop="dateCreated" datetime="2014-09-05T05:49:03-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Во блин... Работает. Надо переписать нафиг роутер, не удобный он (.
Спасибо огромное.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11073" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11073" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ca583aafbe57c402a106b0aaa70da0a2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/951/Sweet-Bob" class="user-moderator-N"><span itemprop="name">Sweet-Bob</span></a>        </span>
        <br>

        <span class="karma">10.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C11075" href="#C11075">
                <time itemprop="dateCreated" datetime="2014-09-05T05:52:56-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Рад был помочь</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="11075" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="11075" data-cf-modified-0aaa1fd73f1ac4ad06de7c5d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="3367" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>