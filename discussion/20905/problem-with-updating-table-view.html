---
layout: default
title: 'Problem with updating table view - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/29/database">Database</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Problem with updating table view</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a></span>
            <time itemprop="dateCreated" datetime="2020-10-14T06:56:07-07:00">Oct '20</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2020-10-14T06:56:07-07:00">Oct '20</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">6</span>
                </td>
                <td>
                    <label>Views</label><br>134</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a></span>
                <span class="karma">284</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C20905" href="#C20905">
        <time class="action-date">Oct '20</time>
    </a>
</div>
<div class="post-content"><div><p>Hello, </p>
<p>I have problem with updating (update())my table view. </p>
<p>$object = Model::findFirst(&quot;id = 19159&quot;);</p>
<p>$object-&gt;name = &quot;test&quot;;</p>
<p>$object-&gt;update(); </p>
<p>I using database logger and when I use update on table view it always try to INSERT and after get error:</p>
<p>&quot;SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry  for key 'PRIMARY'&quot;</p>
<p>When I use update() on normal classic table not view it works perfect. </p>
<p>It works only when I use database execute</p>
<p>$this-&gt;db-&gt;execute(&quot;UPDATE ...);</p>
<p>It is possible to call update  on table view?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-b6937d4196596744aa082e93-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-b6937d4196596744aa082e93-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64497" href="#C64497">
                <time itemprop="dateCreated" datetime="2020-10-14T07:52:00-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This looks like it should work.  Can you paste what the <code>INSERT</code> statement looks like?  Could you also paste what the <code>SELECT</code> statement looks like?  That might give us a clue.</p>
<p>To post your queries, please use code blocks.  See how: <a href="https://forum.phalcon.io/help/markdown">https://forum.phalcon.io/help/markdown</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64497" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64497" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="64499" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '20</span>
              </span><br/><a name="C64499" href="#C64499">
                <time itemprop="dateCreated" datetime="2020-10-14T09:16:54-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This is my code </p>
<pre><code class="language-php">&lt;?php

$object = SmEventModel::findFirst("EventNr = 19159");
$object-&gt;EventName = "test";
$object-&gt;update();</code></pre>
<p>I paste the INSERT and SELECT. </p>
<p>When I used update() it always try to INSERT.</p>
<hr />
<p>[2020-10-14T18:01:19+02:00][info] SELECT <code>sm_event</code>.<code>BranchNr</code>, <code>sm_event</code>.<code>EventNr</code>, <code>sm_event</code>.<code>EventName</code>, <code>sm_event</code>.<code>EventDescription</code>, <code>sm_event</code>.<code>Eventcolor</code>, <code>sm_event</code>.<code>Eventfromdate</code>, <code>sm_event</code>.<code>Eventtodate</code>, <code>sm_event</code>.<code>CalendarNr</code>, <code>sm_event</code>.<code>ParentEventNr</code>, <code>sm_event</code>.<code>UserNr</code>, <code>sm_event</code>.<code>framecolnr</code>, <code>sm_event</code>.<code>backcolnr</code>, <code>sm_event</code>.<code>frametypenr</code>, <code>sm_event</code>.<code>timestamp</code>, <code>sm_event</code>.<code>status</code>, <code>sm_event</code>.<code>foreignlink</code>, <code>sm_event</code>.<code>foreignlinktype</code>, <code>sm_event</code>.<code>exclusive</code>, <code>sm_event</code>.<code>blocked</code>, <code>sm_event</code>.<code>templateId</code> FROM <code>sm_event</code> WHERE <code>sm_event</code>.<code>EventNr</code> = 19159 LIMIT :APL0</p>
<hr />
<p>[2020-10-14T18:01:19+02:00][info] INSERT INTO <code>sm_event</code> (<code>BranchNr</code>, <code>EventNr</code>, <code>EventName</code>, <code>EventDescription</code>, <code>Eventcolor</code>, <code>Eventfromdate</code>, <code>Eventtodate</code>, <code>CalendarNr</code>, <code>ParentEventNr</code>, <code>UserNr</code>, <code>framecolnr</code>, <code>backcolnr</code>, <code>frametypenr</code>, <code>timestamp</code>, <code>status</code>, <code>foreignlink</code>, <code>foreignlinktype</code>, <code>exclusive</code>, <code>blocked</code>, <code>templateId</code>) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)</p>
<hr />
<p>This is my table view</p>
<pre><code class="language-php">&lt;?php

public function initialize()
    {
        $this-&gt;setSource("sm_event");
        $this-&gt;hasMany('EventNr', 'App\Models\SmEventitems', 'EventNr', ['alias' =&gt; 'smEventitems']);
    }</code></pre>
<hr />
<p>I want to update and he always try insert and its the reason why I get the error</p>
<p>&quot;SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '19159' for key 'PRIMARY'&quot;</p>
<hr /></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64499" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64499" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="64501" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '20</span>
              </span><br/><a name="C64501" href="#C64501">
                <time itemprop="dateCreated" datetime="2020-10-14T09:34:43-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Is <code>EventNr</code> the primary key?  Is it specified in the database as being the primary key column of the table?</p>
<p>Can you paste the result of calling <code>desc sm_event</code>?  Pasting it like code, but using &quot;sql&quot; instead of &quot;php&quot; will keep the formatting.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64501" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64501" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64503" href="#C64503">
                <time itemprop="dateCreated" datetime="2020-10-14T09:41:02-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes <ins>EventNr </ins> is primary key of the main table. He want to insert the same column to the table not updated It happens only on the table view..</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64503" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64503" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64505" href="#C64505">
                <time itemprop="dateCreated" datetime="2020-10-14T09:48:25-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I'm aware - I'm asking for the table definition to try to figure out why Phalcon is INSERT-ing instead of UPDATE-ing.  That <em>may</em> be due to how the table is defined.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64505" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64505" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64507" href="#C64507">
                <time itemprop="dateCreated" datetime="2020-10-14T10:49:13-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><hr />
<p>DESCRIBE sm_event</p>
<p>BranchNr    int(11) NO      1   </p>
<p>EventNr int(11) NO      0   </p>
<p>EventName   varchar(255)    NO   NULL</p>
<p>EventDescription    longtext    YES      NULL</p>
<p>Eventcolor  varchar(15) NO      3300ff      </p>
<p>Eventfromdate   timestamp   NO      current_timestamp()     </p>
<p>Eventtodate timestamp   NO      current_timestamp() </p>
<p>CalendarNr  int(11) NO      1       </p>
<p>ParentEventNr   int(11) NO      0   </p>
<p>UserNr  int(11) NO      0       </p>
<p>framecolnr  int(11) NO      0   </p>
<p>backcolnr   int(11) NO      0       </p>
<p>frametypenr int(11) NO      0       </p>
<p>timestamp   datetime    NO        NULL</p>
<p>status  int(11) NO      -1      </p>
<p>foreignlink varchar(32) YES     NULL</p>
<p>foreignlinktype int(11) NO      0       </p>
<p>exclusive   tinyint(4)  NO      0       </p>
<p>blocked tinyint(4)  NO      0       </p>
<p>templateId  int(11) YES      NULL</p>
<hr />
<p>Create view</p>
<pre><code class="language-php">&lt;?php

public function up()
    {
        $definition = array('sql' =&gt; 'select `event`.`filialnr` AS `BranchNr`,
                `event`.`nlfdevent` AS `EventNr`,
                `event`.`seventbez` AS `EventName`,
                `event`.`seventbeschreibung` AS `EventDescription`,
                `event`.`scolor` AS `Eventcolor`,
                `event`.`dtvon` AS `Eventfromdate`,
                `event`.`dtbis` AS `Eventtodate`,
                `event`.`calendid` AS `CalendarNr`,
                `event`.`parnlfdevent` AS `ParentEventNr`,
                `event`.`usernr` AS `UserNr`,
                `event`.`framecolnr` AS `framecolnr`,
                `event`.`backcolnr` AS `backcolnr`,
                `event`.`frametypenr` AS `frametypenr`,
                `event`.`timestamp` AS `timestamp`,
                `event`.`status` AS `status`,
                `event`.`foreignlink` AS `foreignlink`,
                `event`.`foreignlinktype` AS `foreignlinktype`,
                `event`.`exklusiv` AS `exclusive`,
                `event`.`blockiert` AS `blocked`,
                `event`.`templateId` AS `templateId` 
                from `event`');

        self::$connection-&gt;dropView("sm_event");
        self::$connection-&gt;createView("sm_event", $definition);
    }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64507" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64507" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64509" href="#C64509">
                <time itemprop="dateCreated" datetime="2020-10-14T10:52:42-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That doesn't look like <code>EventNr</code> is defined as the primary key, though your output looks entirely different from what I get when I describe a table.  Are you using MySQL/MariaDB?  Your output should look something like:</p>
<pre><code>+-------------------+-------------------------------+------+-----+---------+----------------+
| Field             | Type                          | Null | Key | Default | Extra          |
+-------------------+-------------------------------+------+-----+---------+----------------+
| id                | int(10) unsigned              | NO   | PRI | NULL    | auto_increment |
| prev_upload_id    | int(10) unsigned              | YES  | MUL | 0       |                |
| new_upload_id     | int(10) unsigned              | NO   | MUL | 0       |                |
| prev_applicant_id | int(10) unsigned              | YES  | MUL | 0       |                |
| new_applicant_id  | int(10) unsigned              | NO   | MUL | 0       |                |
| status            | enum('new','done','progress') | NO   |     | new     |                |
| field             | varchar(255)                  | NO   |     | 0       |                |
| prev_value        | varchar(255)                  | YES  |     | 0       |                |
| new_value         | varchar(255)                  | YES  |     | 0       |                |
+-------------------+-------------------------------+------+-----+---------+----------------+</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64509" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64509" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64515" href="#C64515">
                <time itemprop="dateCreated" datetime="2020-10-14T23:23:57-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">
DESCRIBE event
+-------------------+-------------------------------+------+-----+----------------------+----------------+
| Field             | Type                          | Null | Key | Default              | Extra          |
+-------------------+-------------------------------+------+-----+----------------------+----------------+
| filialnr          | int(11)                       | NO   | MUL | 1                    |                |
| nlfdevent         | int(11)                       | NO   | PRI | 0                    | auto_increment |
| seventbez         | varchar(255)                  | NO   |     | NULL                 |                |
| seventbeschreibung| longtext                      | YES  |     | NULL                 |                |
| scolor            | varchar(15)                   | NO   |     | 3300ff               |                |
| dtvon             | timestamp                     | NO   | MUL | current_timestamp()  |                |
| dtbis             | timestamp                     | NO   | MUL | current_timestamp()  |                |
| calendid          | int(11)                       | NO   |     | 1                    |                |
| parnlfdevent      | int(11)                       | NO   |     | 0                    |                |
| usernr            | int(11)                       | NO   |     | 0                    |                |
| framecolnr        | int(11)                       | NO   |     | 0                    |                |
| backcolnr         | int(11)                       | NO   |     | 0                    |                |
| frametypenr       | int(11)                       | NO   |     | 0                    |                |
| timestamp         | datetime                      | NO   |     | NULL                 |                |
| status            | int(11)                       | NO   |     | -1                   |                |
| foreignlink       | varchar(32)                   | YES  |     | NULL                 |                |
| foreignlinktype   | int(11)                       | NO   |     | 0                    |                |
| exklusiv          | tinyint(4)                    | NO   |     | 0                    |                |
| blockiert         | tinyint(4)                    | NO   |     | 0                    |                |
| templateId        | int(11)                       | YES  |     | NULL                 |                |
+-------------------+-------------------------------+------+-----+---------+-----------------------------+

DESCRIBE sm_event it is view of the event table

+-------------------+-------------------------------+------+-----+----------------------+----------------+
| Field             | Type                          | Null | Key | Default              | Extra          |
+-------------------+-------------------------------+------+-----+----------------------+----------------+
| BranchNr          | int(11)                       | NO   |     | 1                    |                |
| EventNr           | int(11)                       | NO   |     | 0                    |                |
| EventName         | varchar(255)                  | NO   |     | NULL                 |                |
| EventDescription  | longtext                      | YES  |     | NULL                 |                |
| Eventcolor        | varchar(15)                   | NO   |     | 3300ff               |                |
| Eventfromdate     | timestamp                     | NO   |     | current_timestamp()  |                |
| Eventtodate       | timestamp                     | NO   |     | current_timestamp()  |                |
| CalendarNr        | int(11)                       | NO   |     | 1                    |                |
| ParentEventNr     | int(11)                       | NO   |     | 0                    |                |
| UserNr            | int(11)                       | NO   |     | 0                    |                |
| framecolnr        | int(11)                       | NO   |     | 0                    |                |  
| backcolnr         | int(11)                       | NO   |     | 0                    |                |
| frametypenr       | int(11)                       | NO   |     | 0                    |                |
| timestamp         | datetime                      | NO   |     | NULL                 |                |
| status            | int(11)                       | NO   |     | -1                   |                |
| foreignlink       | varchar(32)                   | YES  |     | NULL                 |                |
| foreignlinktype   | int(11)                       | NO   |     | 0                    |                |
| exclusive         | tinyint(4)                    | NO   |     | 0                    |                |
| blocked           | tinyint(4)                    | NO   |     | 0                    |                |
| templateId        | int(11)                       | YES  |     | NULL                 |                |
+-------------------+-------------------------------+------+-----+---------+-----------------------------+  </code></pre>
<hr />
<p>When I used updated() on event table its work perfect he try to UPDATE but when I used updated() on table view he try to INSERT.</p>
<hr />
<hr />
<p>I think that you cannot create a primary key on a view but if your view is based on a table with a primary key then the primary key will be reflected in the view also.</p>
<hr />
<p>Thank you very much for your time.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64515" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64515" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64519" href="#C64519">
                <time itemprop="dateCreated" datetime="2020-10-15T07:52:57-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok, so here we see that <code>EventNr</code> is not set as the primary key of the table - I believe that's what's causing your problem.  When Phalcon tries to <code>update()</code>, it first looks for a record with a matching primary key.  If one is not found, it does an insert because there's nothing to update.  If you set <code>EventNr</code> as the primary key (which assumes there will only be one row per <code>EventNr</code>), then Phalcon will be able to update the row.</p>
<p>However, your original error: &quot;SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry for key 'PRIMARY'&quot; can't be caused by trying to insert into <code>sm_event</code> because, like I said, has no primary key.  It must be a different query causing the error.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64519" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64519" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64521" href="#C64521">
                <time itemprop="dateCreated" datetime="2020-10-15T08:03:52-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok thank you. </p>
<p>I have another question.  How to set primary key in table view because its not base table. I using MySQL/MariaDB. Thank you.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64521" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64521" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64525" href="#C64525">
                <time itemprop="dateCreated" datetime="2020-10-15T08:22:36-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think if you set it in the table, it should be carried through to the view.  I'm not sure though. Personally I've never used views - I've never seen the need for them.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64525" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64525" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="64527" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '20</span>
              </span><br/><a name="C64527" href="#C64527">
                <time itemprop="dateCreated" datetime="2020-10-15T08:33:37-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">
DESCRIBE event
+-------------------+-------------------------------+------+-----+----------------------+----------------+
| Field             | Type                          | Null | Key | Default              | Extra          |
+-------------------+-------------------------------+------+-----+----------------------+----------------+
| filialnr          | int(11)                       | NO   | MUL | 1                    |                |
| nlfdevent         | int(11)                       | NO   | PRI | 0                    | auto_increment |
| seventbez         | varchar(255)                  | NO   |     | NULL                 |                |
| seventbeschreibung| longtext                      | YES  |     | NULL                 |                |
| scolor            | varchar(15)                   | NO   |     | 3300ff               |                |
| dtvon             | timestamp                     | NO   | MUL | current_timestamp()  |                |
| dtbis             | timestamp                     | NO   | MUL | current_timestamp()  |                |
| calendid          | int(11)                       | NO   |     | 1                    |                |
| parnlfdevent      | int(11)                       | NO   |     | 0                    |                |
| usernr            | int(11)                       | NO   |     | 0                    |                |
| framecolnr        | int(11)                       | NO   |     | 0                    |                |
| backcolnr         | int(11)                       | NO   |     | 0                    |                |
| frametypenr       | int(11)                       | NO   |     | 0                    |                |
| timestamp         | datetime                      | NO   |     | NULL                 |                |
| status            | int(11)                       | NO   |     | -1                   |                |
| foreignlink       | varchar(32)                   | YES  |     | NULL                 |                |
| foreignlinktype   | int(11)                       | NO   |     | 0                    |                |
| exklusiv          | tinyint(4)                    | NO   |     | 0                    |                |
| blockiert         | tinyint(4)                    | NO   |     | 0                    |                |
| templateId        | int(11)                       | YES  |     | NULL                 |                |
+-------------------+-------------------------------+------+-----+---------+-----------------------------+</code></pre>
<p>This is my base table and the primary key is set! </p>
<p>I create the view normal way. You cannot create a primary key on a view but if your view is based on a table with a primary key then the primary key will be reflected in the view also. </p>
<p>I think that  in phalcon framework cannot update the table view or I mistake?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64527" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64527" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64529" href="#C64529">
                <time itemprop="dateCreated" datetime="2020-10-15T08:38:01-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I'm guessing you can't update a view.  From what I've seen, a view is basically just the result of a SELECT statement - it doesn't actually hold the data.  If you want to update, do it on the table itself.</p>
<p>In case there's any confusion, you don't <em>need</em> to use a table view with Phalcon - it and it's ORM work just fine working directly on the tables.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64529" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64529" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/747a6c9eb35417f6524684369c1b95f2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14275/JOPA159" class="user-moderator-N"><span itemprop="name">JOPA159</span></a>        </span>
        <br>

        <span class="karma">284</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64531" href="#C64531">
                <time itemprop="dateCreated" datetime="2020-10-15T08:55:16-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>When the view is 1:1 to base table and when you update the view the automatically update the base table or when you insert the data to the view aumaticaly insert to the base table. You can try it. Update view is normal mysql command.</p>
<p>I need work with table view because when you see the colums are diferent and  for the language and project I need work with table view. </p>
<p>I must find some solution maybe I use mapping the column or use the db execute.</p>
<p>Thank you for your time.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64531" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64531" data-cf-modified-b6937d4196596744aa082e93-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="20905" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>