---
layout: default
title: 'Best Way to limit requests for each user - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/26/http-environment">HTTP Environment</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Best Way to limit requests for each user</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/13197/yassinrais" class="user-moderator-N"><span itemprop="name">Yassine Rais</span></a></span>
            <time itemprop="dateCreated" datetime="2020-01-15T08:58:15-07:00">Jan '20</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2020-01-15T08:58:15-07:00">Jan '20</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>191</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/fae834afb5439c6aff90a9b9cdc31971?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/13197/yassinrais" class="user-moderator-N"><span itemprop="name">Yassine Rais</span></a></span>
                <span class="karma">3.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C20271" href="#C20271">
        <time class="action-date">Jan '20</time>
    </a>
</div>
<div class="post-content"><div><p><strong>Hello community! </strong>
I just want to know the best method that can limit the request (for an api)
I mean, for example </p>
<p><em>user1: will have max 5req/seconds
user2: will have max 50req/seconds
user3: will have max 500req/seconds</em>
...</p>
<p><strong><em>user:: use an api key</em></strong></p>
<p>and also  to know
why I posted this because if I use database record, I think that will increase more the performance of server </p>
<p>I not sure :) </p>
<p>but I want to know </p>
<p>tkanhs! </p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-a05c40c2c8a1dda9509df985-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-a05c40c2c8a1dda9509df985-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C61833" href="#C61833">
                <time itemprop="dateCreated" datetime="2020-01-15T10:17:05-07:00" class="action-date">Jan '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You're going to have to record it somewhere.  Something like memcached or redis would be faster than a database.</p>
<p>Also, you don't need to record every request - just the time of the last request.  If someone is limited to 5 requests per second, that's 200 milliseconds per request.  So on each request, check if the previous request happened more recently than 200 milliseconds ago.  If it did, reject the request.  Otherwise, honour the request and record the current time in milliseconds.  </p>
<p><code>microtime()</code> will probably be useful here.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="61833" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="61833" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fae834afb5439c6aff90a9b9cdc31971?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/13197/yassinrais" class="user-moderator-N"><span itemprop="name">Yassine Rais</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C61873" href="#C61873">
                <time itemprop="dateCreated" datetime="2020-01-17T16:34:51-07:00" class="action-date">Jan '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>interesting idea<br />
working with redis </p>
<p>first time i will use it :D </p>
<p>thanks a lot !</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="61873" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="61873" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/7614aa2c79f9daed914d34226a16b521?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/13271/TommyWhitehead90" class="user-moderator-N"><span itemprop="name">Tommy C Whitehead</span></a>        </span>
        <br>

        <span class="karma">72</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C61909" href="#C61909">
                <time itemprop="dateCreated" datetime="2020-01-20T03:29:53-07:00" class="action-date">Jan '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>thank you for sharing this info!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="61909" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="61909" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Åšlawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C61927" href="#C61927">
                <time itemprop="dateCreated" datetime="2020-01-21T11:20:52-07:00" class="action-date">Jan '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Keep in mind that you should do this atomic way. Avoid methods such as set.</p>
<p>In memcache you can do it using add method which will add a key only if it not exists and increment/decrement methods - this way you never set a value yourself</p>
<p>I guess the same should be possible with redis.</p>
<p>With database it wouldn't be so easy.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="61927" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="61927" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fae834afb5439c6aff90a9b9cdc31971?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/13197/yassinrais" class="user-moderator-N"><span itemprop="name">Yassine Rais</span></a>        </span>
        <br>

        <span class="karma">3.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C61929" href="#C61929">
                <time itemprop="dateCreated" datetime="2020-01-21T13:41:32-07:00" class="action-date">Jan '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Okey thanks you !</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="61929" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="61929" data-cf-modified-a05c40c2c8a1dda9509df985-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="20271" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>