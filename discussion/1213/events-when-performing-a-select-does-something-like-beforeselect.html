---
layout: default
title: 'Events when performing a SELECT. Does something like &quot;beforeSelect&quot; exist? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Events when performing a SELECT. Does something like &quot;beforeSelect&quot; exist?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/87/noobiwan" class="user-moderator-N"><span itemprop="name">Lewiz</span></a></span>
            <time itemprop="dateCreated" datetime="2013-11-19T15:06:40-07:00">Nov '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-11-19T15:06:40-07:00">Nov '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Nov '13</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>695</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/f995126f75088cac3803b91febd711fb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/87/noobiwan" class="user-moderator-N"><span itemprop="name">Lewiz</span></a></span>
                <span class="karma">32.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1213" href="#C1213">
        <time class="action-date">Nov '13</time>
    </a>
</div>
<div class="post-content"><div><p>Hey guys, I was wondering if Models have something similar to beforeSave that would allow me to modify a select query? Something that would be called &quot;beforeSelect&quot; if it existed.</p>
<p>Why I'd need that? I'm working on a multi-user application and I want to diminish the risks of an user seeing other users data because of a mistake in code. So in every query I need to set the user_id. I'm looking for a way to do that automatically for every query! So I would intercept the query and inject the right user_id.</p>
<p>Do you have suggestions to accomplish that?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-926600dec0fb975146783233-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-926600dec0fb975146783233-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/120a80790b934719bfe4c9488a0b61b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/727/naNuke" class="user-moderator-N"><span itemprop="name">naNuke</span></a>        </span>
        <br>

        <span class="karma">2.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4348" href="#C4348">
                <time itemprop="dateCreated" datetime="2013-11-19T23:27:14-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Can't you select the user by simply doing findFirst(id)? I don't get how other users would be able to get data of someone else, but if you really need that then you can create new model, set the id and then find? which essentialy does the same as findFirst(id).</p>
<p>Having method beforeSelect in the model would just give you always the same user btw since it would be set before every single select of user?.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4348" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4348" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f995126f75088cac3803b91febd711fb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/87/noobiwan" class="user-moderator-N"><span itemprop="name">Lewiz</span></a>        </span>
        <br>

        <span class="karma">32.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4350" href="#C4350">
                <time itemprop="dateCreated" datetime="2013-11-19T23:42:52-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I want to minimize the chance of coding errors. For example:</p>
<pre><code class="language-sql">Select * from clients where id = 23 and user_id = 2;</code></pre>
<p>If I create a function that does that I'm good to go, but I'm using models and it's easy to just do Clients::findFirst(23) and forget to set the user_id. It happend to me a couple times. So I'm stupid and I was wondering if I could automatically set it for all the queries using events.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4350" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4350" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f995126f75088cac3803b91febd711fb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/87/noobiwan" class="user-moderator-N"><span itemprop="name">Lewiz</span></a>        </span>
        <br>

        <span class="karma">32.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4351" href="#C4351">
                <time itemprop="dateCreated" datetime="2013-11-19T23:45:10-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The user_id would be the id of the user currently logged in. So it wouldn't be hard coded like you imagined.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4351" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4351" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/120a80790b934719bfe4c9488a0b61b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/727/naNuke" class="user-moderator-N"><span itemprop="name">naNuke</span></a>        </span>
        <br>

        <span class="karma">2.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="4354" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C4354" href="#C4354">
                <time itemprop="dateCreated" datetime="2013-11-20T10:28:28-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sorry, to me it just seems like you are approaching the user login system a bit wrong but thats not the point, if you want query that does what you said above then read properly this section: <a href="http://docs.phalcon.io/en/latest/reference/models.html#finding-records">http://docs.phalcon.io/en/latest/reference/models.html#finding-records</a></p>
<pre><code class="language-php">$robots = Clients::find(array(
    "conditions" =&gt; "id = ?1 AND user_id = ?2",
    "bind" =&gt; array(
        1 =&gt; $id,
        2 =&gt; $user_id
    )
));</code></pre>
<p>alternatively you can use phql to do query like that:
<a href="http://docs.phalcon.io/en/latest/reference/phql.html#conditions">http://docs.phalcon.io/en/latest/reference/phql.html#conditions</a></p>
<pre><code class="language-php">$phql = "SELECT * FROM Clients WHERE Clients.id = 23 AND Clients.user_id = 2";
$clients = $manager-&gt;executeQuery($phql);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4354" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4354" data-cf-modified-926600dec0fb975146783233-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1213" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>