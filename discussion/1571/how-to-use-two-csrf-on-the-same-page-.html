---
layout: default
title: 'how to use two csrf on the same page? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">how to use two csrf on the same page?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/607/geass" class="user-moderator-N"><span itemprop="name">geass</span></a></span>
            <time itemprop="dateCreated" datetime="2014-02-09T04:53:53-07:00">Feb '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-02-09T04:53:53-07:00">Feb '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>934</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/10f6ce98d0abb484ea803be3a29ef9ef?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/607/geass" class="user-moderator-N"><span itemprop="name">geass</span></a></span>
                <span class="karma">39.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1571" href="#C1571">
        <time class="action-date">Feb '14</time>
    </a>
</div>
<div class="post-content"><div><p>hi all,</p>
<p>i have two form on same page (login and signup ), via forms i created two csrf object but when only loginform is working , its working but when two , csrf is invalid i got.</p>
<p>how can i solve it ? </p>
<p>LoginForm.php</p>
<pre><code class="language-php">// CSRF
        $csrf = new Hidden('csrf');

        $csrf-&gt;addValidator(new Identical(array(
            'value' =&gt; $this-&gt;security-&gt;getSessionToken(),
            'message' =&gt; 'CSRF Doğrulaması Hatalı'
        )));

        $this-&gt;add($csrf);</code></pre>
<p>Signupform.php</p>
<pre><code class="language-php">$csrf = new Hidden('csrfa');

        $csrf-&gt;addValidator(new Identical(array(
            'value' =&gt; $this-&gt;security-&gt;getSessionToken(),
            'message' =&gt; 'CSRF validation failed'
        )));

        $this-&gt;add($csrf);</code></pre>
<p>on main.phtml</p>
<p>on login form: &lt;?php echo $login_form-&gt;render('csrf',array('value' =&gt; $this-&gt;security-&gt;getToken()));?&gt;
on signup form : &lt;?php echo $signup_form-&gt;render('csrfa',array('value' =&gt; $this-&gt;security-&gt;getToken()));?&gt;</p>
<p>how can i solve it ?
Thanks for all </p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-b361dcb74dcda110e2ac7895-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-b361dcb74dcda110e2ac7895-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5492" href="#C5492">
                <time itemprop="dateCreated" datetime="2014-02-11T15:30:47-07:00" class="action-date">Feb '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Why do you need two CSRF in the same page? It will increase the token processing twice.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5492" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5492" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/10f6ce98d0abb484ea803be3a29ef9ef?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/607/geass" class="user-moderator-N"><span itemprop="name">geass</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5496" href="#C5496">
                <time itemprop="dateCreated" datetime="2014-02-11T16:25:33-07:00" class="action-date">Feb '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>How can i do that what im trying to do ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5496" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5496" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="5500" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C5500" href="#C5500">
                <time itemprop="dateCreated" datetime="2014-02-11T23:11:25-07:00" class="action-date">Feb '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Once generate, many use in forms:</p>
<pre><code class="language-php">$sessionToken =  $this-&gt;security-&gt;getSessionToken();
$token =  $this-&gt;security-&gt;getToken();

$form1-&gt;sessionToken = $sessionToken;
$form1-&gt;token = $token;
$form2-&gt;sessionToken = $sessionToken;
$form2-&gt;token = $token;</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5500" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5500" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2f67ec1aafe93e6591b1e836f6990705?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2784/PersyJack" class="user-moderator-N"><span itemprop="name">PersyJack</span></a>        </span>
        <br>

        <span class="karma">2.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13875" href="#C13875">
                <time itemprop="dateCreated" datetime="2014-12-03T17:30:11-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/geass">@geass</a> can you put your code or explain how you were able display both login and sign up on the same page? i'm trying to do the same, i'm trying to chane Vokuro to show both forms on the index page but i couldn't do it. i asked that question but haven't received a reply yet. i'd appreciate if you could help me out.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13875" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13875" data-cf-modified-b361dcb74dcda110e2ac7895-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1571" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>