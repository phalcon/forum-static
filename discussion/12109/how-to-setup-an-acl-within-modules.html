---
layout: default
title: 'How to setup an ACL within modules - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/17/acl">Acl</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">How to setup an ACL within modules</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/7541/ndabAP" class="user-moderator-N"><span itemprop="name">ndabAP</span></a></span>
            <time itemprop="dateCreated" datetime="2016-07-16T02:21:40-07:00">Jul '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-07-16T02:21:40-07:00">Jul '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>778</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/a31d2644cf31f785e3d4ec89b4f8c96b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/7541/ndabAP" class="user-moderator-N"><span itemprop="name">ndabAP</span></a></span>
                <span class="karma">14.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C12109" href="#C12109">
        <time class="action-date">Jul '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hi, </p>
<p>I am not able to setup a existing ACL list to secure my backend. Do I have to put it into the bootstrap or the Module.php? And do I have to define the module in my resource list like this:</p>
<pre><code>         $privateResources = array(
            'backend' =&gt; array(
                'administration' =&gt; array(
                    'index',
                )
            ),
            'frontend' =&gt; array(
            )
        );</code></pre>
<p>Thanks!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-9b53d39939b6da755b7fdd39-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-9b53d39939b6da755b7fdd39-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="36803" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '16</span>
              </span><br/><a name="C36803" href="#C36803">
                <time itemprop="dateCreated" datetime="2016-07-16T07:54:17-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What you mean ? Into bootstrap, but currently phalcon don't have anything for securing controllers and/or actions if you mean this. There is waiting PR for 2.1.x with firewall based on acl/annotations but it will be postpone to 2.2.x/3.0.x. But you can add some code dispatcher event beforeExecuteRoute to check it yourself if user has acess or not.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36803" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36803" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a31d2644cf31f785e3d4ec89b4f8c96b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/7541/ndabAP" class="user-moderator-N"><span itemprop="name">ndabAP</span></a>        </span>
        <br>

        <span class="karma">14.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="36807" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '16</span>
              </span><br/><a name="C36807" href="#C36807">
                <time itemprop="dateCreated" datetime="2016-07-16T08:12:40-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi,<a href="https://forum.phalcon.io/user/0/jurigag"> @jurigag</a>. With securing I just meant securing from login ;) (<a href="https://docs.phalcon.io/en/latest/reference/acl.html">https://docs.phalcon.io/en/latest/reference/acl.html</a>)</p>
<p>I just switched to a module system where I separate the backend from the frontend. Before that, I already used a working security plugin to secure the logged in area. But now I don't know how to transfer it to the module system. For example, do I have to setup two different plugins for backend and frontend or can I combine it to one?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36807" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36807" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36811" href="#C36811">
                <time itemprop="dateCreated" datetime="2016-07-16T08:36:44-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't know. Just check/edit security plugin and that's it. By default phalcon don't have any security mechanism to secure logging or something. Just do whatever you want mean :)</p>
<p>For example in dispatch listener i have code like this:</p>
<pre><code class="language-php">        $moduleName = $dispatcher-&gt;getModuleName();
        $controllerName = lcfirst($dispatcher-&gt;getControllerName());
        $resourceName = "$moduleName:$controllerName";
        if (!$this-&gt;securityService-&gt;checkAcl($resourceName, $action)) {
            // TODO : change this to forbidden exception when it will be implemented in phalcon
            // throw new ForbiddenException("Nie posiadasz wystarczających uprawnień do danej akcji.");
            $response = new Response();
            $response-&gt;setStatusCode(403);
            $response-&gt;setJsonContent(['error' =&gt; 'Nie posiadasz wystarczających uprawnień do danej akcji.']);
            $dispatcher-&gt;setReturnedValue($response);
            return false;
        }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36811" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36811" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a31d2644cf31f785e3d4ec89b4f8c96b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/7541/ndabAP" class="user-moderator-N"><span itemprop="name">ndabAP</span></a>        </span>
        <br>

        <span class="karma">14.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36813" href="#C36813">
                <time itemprop="dateCreated" datetime="2016-07-16T08:48:57-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>But where to put the code?</p>
<p>I have the modules:</p>
<pre><code>class Module implements ModuleDefinitionInterface {

        public function registerServices(DiInterface $di) {
          $di-&gt;set('dispatcher', function () use ($di) {
          $eventsManager = new EventsManager;
          $eventsManager-&gt;attach('dispatch:beforeDispatch', new SecurityPlugin);
          $dispatcher = new Dispatcher;
          $dispatcher-&gt;setEventsManager($eventsManager);
          return $dispatcher;
        });
        }   
}</code></pre>
<p>And I have the bootstrap (index.php):</p>
<pre><code>    try {
  require '../vendor/autoload.php';

  $di = new FactoryDefault();

      $di-&gt;set('dispatcher', function () use ($di) {
          $eventsManager = new EventsManager;
          $eventsManager-&gt;attach('dispatch:beforeDispatch', new SecurityPlugin);
          $dispatcher = new Dispatcher;
          $dispatcher-&gt;setEventsManager($eventsManager);
          return $dispatcher;
        });

  $application = new Application($di);

  $application-&gt;registerModules([
      'frontend' =&gt; [
          'className' =&gt; 'Run\Frontend\Module',
          'path' =&gt; '../app/frontend/Module.php'
      ],
      'backend' =&gt; [
          'className' =&gt; 'Run\Backend\Module',
          'path' =&gt; '../app/backend/Module.php'
      ]
  ]);

  require '../app/services/filters.php';

  echo $application-&gt;handle()-&gt;getContent();
      } catch (\Exception $e) {
    echo "Exception: ", $e-&gt;getMessage();
    }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36813" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36813" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36815" href="#C36815">
                <time itemprop="dateCreated" datetime="2016-07-16T09:10:02-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>To securityPlugin obviously :) Just edit it to working with multi-modules and that's it.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36815" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36815" data-cf-modified-9b53d39939b6da755b7fdd39-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="12109" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>