---
layout: default
title: 'Inner join user following - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Inner join user following</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-30T04:56:01-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-30T04:56:01-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>319</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
                <span class="karma">40.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7881" href="#C7881">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>Hey, i'm sorry if i create to many posts - I just need help with getting started with Phalco, and it's many functions :-)</p>
<p>What i'm trying to do is, that i would like to display all my users, and if user is following an user, it will display the text &quot;You are following&quot;</p>
<p>I'm trying to do this, but i dont think it's the right way to do it.. :</p>
<pre><code>    $this-&gt;view-&gt;users = $this-&gt;modelsManager-&gt;createBuilder()
    -&gt;from('Users')
    -&gt;innerjoin('userfollows')
    -&gt;orderBy('Users.id')
    -&gt;limit(9)
    -&gt;getQuery()
    -&gt;execute();

    foreach ($this-&gt;users as $test) {
        if($test-&gt;following = $test-&gt;id){ // User id
            echo 'You are following'
        }
    }</code></pre>
<p>Hope you understand :-)</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-2be301eccf73e74a53109469-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-2be301eccf73e74a53109469-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a20d655bbeff97e2c393510348ddb7cd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3162/Graphmatic" class="user-moderator-N"><span itemprop="name">graphmatic</span></a>        </span>
        <br>

        <span class="karma">11.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21363" href="#C21363">
                <time itemprop="dateCreated" datetime="2015-07-30T06:44:48-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>looks like you compare the id of the followed user to the user id of the same row, could you shortly represent your two tables structures?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21363" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21363" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21369" href="#C21369">
                <time itemprop="dateCreated" datetime="2015-07-30T07:25:55-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sure</p>
<p>Users:</p>
<p></p>
<p>userfollows:</p>
<p></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21369" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21369" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a20d655bbeff97e2c393510348ddb7cd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3162/Graphmatic" class="user-moderator-N"><span itemprop="name">graphmatic</span></a>        </span>
        <br>

        <span class="karma">11.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21391" href="#C21391">
                <time itemprop="dateCreated" datetime="2015-07-30T09:21:41-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>ok, </p>
<p>I'm not familiar with the modelsManager, but I think it would be easier first to pass some conditions to filter the jointure, so no need to compare,just test result to check if  rows from userfollows have been linked to the user row</p>
<pre><code class="language-php">    $users = $this-&gt;modelsManager-&gt;createBuilder()
    -&gt;from('Users')
    -&gt;join('Userfollows', 'Users.id = Userfollows.follower')
    -&gt;getQuery()
    -&gt;execute();

    foreach ($users as $user) {  //no need to compare, as obviously if a row have been joined, it's cause ids was resp.
        if($user-&gt;userfollows){ // or use isset() or  !empty()
            foreach($user-&gt;userfollows as $followed){  //here I suppose it's one-to-many relation
                echo 'You are following user with ID:' . $followed-&gt;following;
        }
    }
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21391" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21391" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21411" href="#C21411">
                <time itemprop="dateCreated" datetime="2015-07-31T04:06:56-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That dosent give me all users, but only the users you are following, and if $user-&gt;follows dosent work, becuase userfollows dosent exists</p>
<p>What im trying to do is to fetch all users, and if you are following an user, you get the message &quot;you are following this user&quot;..</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21411" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21411" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a20d655bbeff97e2c393510348ddb7cd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3162/Graphmatic" class="user-moderator-N"><span itemprop="name">graphmatic</span></a>        </span>
        <br>

        <span class="karma">11.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="21413" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C21413" href="#C21413">
                <time itemprop="dateCreated" datetime="2015-07-31T05:48:59-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>this snippet should work:</p>
<pre><code class="language-php">
    $users = Users::find();
    foreach ($users as $user) {
        $userFollow = Userfollows::find('follower = $user-&gt;id');
        if($userFollow) { // or try if(!empty($userFollow)
            foreach($userFollow as $f){  //here I suppose it's one-to-many relation
                echo 'You are following user with ID:' . $f-&gt;following;
        }
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21413" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21413" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C21413"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/a20d655bbeff97e2c393510348ddb7cd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        graphmatic                    </a>
                </div><div class="posts-buttons" align="right"><a name="C21423" href="#C21423">
                <time itemprop="dateCreated" datetime="2015-07-31T08:12:19-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You might want to change it to avoid SQL injections:</p>
<pre><code class="language-php">$userFollow = Userfollows::findByFollower($user-&gt;id);</code></pre>
<blockquote>
<p>this snippet should work:</p>
<pre><code class="language-php">
  $users = Users::find();
  foreach ($users as $user) {
      $userFollow = Userfollows::find('follower = $user-&gt;id');
      if($userFollow) { // or try if(!empty($userFollow)
          foreach($userFollow as $f){  //here I suppose it's one-to-many relation
               echo 'You are following user with ID:' . $f-&gt;following;
       }
</code></pre>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21423" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21423" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21425" href="#C21425">
                <time itemprop="dateCreated" datetime="2015-07-31T09:20:44-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It dosent work either.. I think I have to use inner join, but I dont know how..</p>
<p>But thanks for trying to help me out, it really means alot :-)!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21425" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21425" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a20d655bbeff97e2c393510348ddb7cd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3162/Graphmatic" class="user-moderator-N"><span itemprop="name">graphmatic</span></a>        </span>
        <br>

        <span class="karma">11.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21429" href="#C21429">
                <time itemprop="dateCreated" datetime="2015-07-31T10:26:59-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>that should work, the only part I'm unsure may be the way I propose to test the resultset</p>
<p>you also have to import your UserFollow model into the Users one (at top of usersController file add &quot;use Userfollows;&quot;)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21429" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21429" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21433" href="#C21433">
                <time itemprop="dateCreated" datetime="2015-07-31T11:14:42-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I have talk to someone, and he said I have to use leftjoin or rightJoin ?</p>
<p>Yes, i does past out data, but dosent implement the &quot;You are following&quot; in the right id..</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21433" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21433" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21471" href="#C21471">
                <time itemprop="dateCreated" datetime="2015-08-01T15:01:41-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I found the solution, my SQL has to be:</p>
<pre><code>SELECT users.firstname, users.lastname, users.id, userfollows.following as following 
FROM users
LEFT JOIN userfollows ON userfollows.following = users.id</code></pre>
<p>Now im just trying to find a way, to do this with modelsmanager-&gt;createbuilder();</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21471" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21471" data-cf-modified-2be301eccf73e74a53109469-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7881" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>