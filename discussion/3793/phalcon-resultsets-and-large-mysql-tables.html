---
layout: default
title: 'Phalcon Resultsets and large MySQL tables - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/4/offtopic">Offtopic</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon Resultsets and large MySQL tables</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a></span>
            <time itemprop="dateCreated" datetime="2014-10-26T22:30:15-07:00">Oct '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-10-26T22:30:15-07:00">Oct '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">25</span>
                </td>
                <td>
                    <label>Views</label><br>4481</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">1</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a></span>
                <span class="karma">4.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C3793" href="#C3793">
        <time class="action-date">Oct '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hi there!
We tried to execute the <code>Model::find()</code> method on a mysql dataset with over a million entries and got an memory overflow before iterating over the <code>Resultset</code>. The overflow does not happen, when querying the same table with <code>mysql_query()</code> or <code>$phalconDb-&gt;query()</code>.</p>
<p>After setting <code>PDO::MYSQL_ATTR_USE_BUFFERED_QUERY = false</code>, we didn't get an overflow, but the <code>Resultset</code> was empty. </p>
<pre><code>$phalconDb = new \Phalcon\Db\Adapter\Pdo\Mysql(...);
$result = $phalconDb-&gt;query("SELECT * FROM schinkens");
while($schinken = $result-&gt;fetch()) 
    print_r($schinken);</code></pre>
<p>Any ideas what the problem is? What do we need to consider when handling huge tables like this?</p>
<p>Thanks for your help!<br />
Lukas</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-4b54024eca3133b291a04d62-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-4b54024eca3133b291a04d62-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12571" href="#C12571">
                <time itemprop="dateCreated" datetime="2014-10-26T22:31:44-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What is a memory overflow?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12571" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12571" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12573" href="#C12573">
                <time itemprop="dateCreated" datetime="2014-10-26T22:41:45-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The memory is exhausted. The limit is set to 512MB.</p>
<pre><code>Fatal error: Allowed memory size of 536870912 bytes exhausted (tried to allocate 24 bytes) in C:\path\to\file.php on line 55</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12573" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12573" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12574" href="#C12574">
                <time itemprop="dateCreated" datetime="2014-10-26T22:45:25-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>OK, but there's no such thing as a memory overflow in CS</p>
<p>Phalcon ORM only keeps one record in memory, it's detailed in the docs: </p>
<blockquote>
<p>While findFirst() returns directly an instance of the called class (when there is data to be returned), the find() method returns a Phalcon\Mvc\Model\Resultset\Simple. This is an object that encapsulates all the functionality a resultset has like traversing, seeking specific records, counting, etc.
These objects are more powerful than standard arrays. One of the greatest features of the Phalcon\Mvc\Model\Resultset is that at any time there is only one record in memory. This greatly helps in memory management especially when working with large amounts of data.</p>
</blockquote>
<p><a href="http://docs.phalcon.io/en/latest/reference/models.html#model-resultsets">http://docs.phalcon.io/en/latest/reference/models.html#model-resultsets</a></p>
<p>Maybe the record is being referenced somewhere in the app causing the GC cannot remove it from memory?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12574" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12574" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="12577" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C12577" href="#C12577">
                <time itemprop="dateCreated" datetime="2014-10-26T23:05:02-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That is the reason why we chose Phalcon. But the issue happens before the resultset is returned from phalcon.
The table has 10 columns. 1,700,00 entries and the size is 262 MiB.</p>
<pre><code>$visitors = Visitors::find();
echo $visitors-&gt;count() // this line is never reached.</code></pre>
<p>The same issue appears if we use the queryBuilder using the modelsManager.</p>
<p>If we do the exact same thing using the (deprecated but simple) <code>mysql_query</code>, everything works fine, and the result is fetched within 3 sec.</p>
<pre><code>$result = mysql_query("SELECT * FROM visitors", $link);
while($row = mysql_fetch_assoc($result)) ... // this works as expected and no fatal errors are thrown.</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12577" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12577" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12578" href="#C12578">
                <time itemprop="dateCreated" datetime="2014-10-26T23:09:28-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>But <code>$visitors = Visitors::find();</code>  does not return the whole resultset in memory it just creates a cursor pointing to the first record</p>
<ul>
<li>Check if the resultset is big: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75</a></li>
<li>Fetchs records one at time: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107</a></li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12578" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12578" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12579" href="#C12579">
                <time itemprop="dateCreated" datetime="2014-10-26T23:19:26-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes, I know it points/should point to just one. </p>
<p>Have you some experience with that amount of data? Can you tell us, if there might be some issues we could look into?</p>
<p>We could also reproduce it using with plain PDO. After using the <code>$pdo-&gt;setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, false);</code> it worked, also when added the attribute in the options when initializing the phalcon mysql adapter.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12579" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12579" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12580" href="#C12580">
                <time itemprop="dateCreated" datetime="2014-10-26T23:23:06-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yeah, the ORM is designed to handle such amounts of data and even more and we have had experience with bigger data than that.</p>
<ul>
<li>Are you using some kind of cache?</li>
<li>XDebug?</li>
<li>Can you post the relevant code of your app somewhere?</li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12580" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12580" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12581" href="#C12581">
                <time itemprop="dateCreated" datetime="2014-10-26T23:35:58-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Cache and XDebug are disabled.
Let me sleep over that and if I can't fix it tomorrow I will come back to you with a complete test script :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12581" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12581" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a535a378afa1bd9dd4846b87d7bc7227?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1031/theluk" class="user-moderator-N"><span itemprop="name">theluk</span></a>        </span>
        <br>

        <span class="karma">548</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="12624" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C12624" href="#C12624">
                <time itemprop="dateCreated" datetime="2014-10-28T05:57:10-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi,</p>
<p>I´m experiencing the same problem. The Phalcon Mysql Adapter uses PDO. </p>
<p>From this link <a href="http://php.net/manual/de/mysqlinfo.concepts.buffering.php">http://php.net/manual/de/mysqlinfo.concepts.buffering.php</a></p>
<blockquote>
<p>Queries are using the buffered mode by default. This means that query results are immediately transferred from the MySQL Server to PHP and is then kept in the memory of the PHP process. This allows additional operations <strong>like counting the number of rows</strong>, and moving (seeking) the current result pointer. It also allows issuing further queries on the same connection while working on the result set. The <strong>downside of the buffered mode</strong> is that larger result sets might require <strong>quite a lot memory</strong>. The memory will be kept occupied till all references to the result set are unset or the result set was explicitly freed, which will automatically happen during request end the latest. The terminology &quot;store result&quot; is also used for buffered mode, as the whole result set is stored at once.</p>
</blockquote>
<p>This means for me, that there is a high chance that this is the reason why our memory limit is reached. Therefor we used the <code>PDO::MYSQL_ATTR_USE_BUFFERED_QUERY = false</code>. But the problem with that is, that Phalcon then is not working correctly anymore. It then says that the <code>$result-&gt;count()</code> is 0. </p>
<p>We tried now a test case with just 100 results. If <code>PDO::MYSQL_ATTR_USE_BUFFERED_QUERY = false</code> in the constructor of the mysql adapter, <code>count()</code> results in 0... That sounds like a bug to me. Or do you have some workarounds?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12624" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12624" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a535a378afa1bd9dd4846b87d7bc7227?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1031/theluk" class="user-moderator-N"><span itemprop="name">theluk</span></a>        </span>
        <br>

        <span class="karma">548</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="12625" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C12625" href="#C12625">
                <time itemprop="dateCreated" datetime="2014-10-28T06:36:43-07:00" class="action-date">Oct '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Tried on</p>
<ul>
<li>Windows 7, PHP 5.5.11, Phalcon 1.2.6 &amp; Phalcon 1.3.3</li>
<li>Linux, PHP 5.5.18 Phalcon 1.2.6</li>
</ul>
<p>A super simple test case where the memory limit is reached (Before actually fetching anything).</p>
<p>We created a robots table with a range of column from a-j and filled it with 1.000.000 entries the size was 800mb.</p>
<p>The first code is (Buffered Table ind PDO is true, memory limit reached):</p>
<pre><code class="language-php">    use Phalcon\DI;
    use Phalcon\Db\Adapter\Pdo\Sqlite as Connection;
    use Phalcon\Mvc\Model\Manager as ModelsManager;
    use Phalcon\Mvc\Model\Metadata\Memory as MetaData;
    use Phalcon\Mvc\Model;

    $di = new DI();

    //Setup a connection
    $di-&gt;set('db', function(){
        return new \Phalcon\Db\Adapter\Pdo\Mysql(array(
            "host" =&gt; "localhost",
            "username" =&gt; "root",
            "password" =&gt; "secret",
            "dbname" =&gt; "test"
        ));
    });

    //Set a models manager
    $di-&gt;set('modelsManager', new ModelsManager());

    //Use the memory meta-data adapter or other
    $di-&gt;set('modelsMetadata', new MetaData());

    //Create a model
    class Robots extends Model {}

    //Use the model
    $robots = Robots::find(); // memory limit is reached somewhere in here.</code></pre>
<p>During <code>Robots::find()</code> the memory of 512mb is reached.</p>
<p>Another try (Buffered Query False -&gt; count = 0):</p>
<pre><code class="language-php">    use Phalcon\DI;
    use Phalcon\Db\Adapter\Pdo\Sqlite as Connection;
    use Phalcon\Mvc\Model\Manager as ModelsManager;
    use Phalcon\Mvc\Model\Metadata\Memory as MetaData;
    use Phalcon\Mvc\Model;

    $di = new DI();

    //Setup a connection
    $di-&gt;set('db', function(){
        return new \Phalcon\Db\Adapter\Pdo\Mysql(array(
            "host" =&gt; "localhost",
            "username" =&gt; "root",
            "password" =&gt; "secret",
            "dbname" =&gt; "test",
            "options" =&gt; array(
                // Added
                \PDO::MYSQL_ATTR_USE_BUFFERED_QUERY =&gt; false
            )
        ));
    });

    //Set a models manager
    $di-&gt;set('modelsManager', new ModelsManager());

    //Use the memory meta-data adapter or other
    $di-&gt;set('modelsMetadata', new MetaData());

    //Create a model
    class Robots extends Model {}

    //Use the model
    $robots = Robots::find(); // this now does not reach the memory limit

    print_r($robots-&gt;count()); // gives 0</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12625" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12625" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/aa1de9c11cf4d3f1f089ddb4d62f676d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2534/lfalke" class="user-moderator-N"><span itemprop="name">Lukas Falke</span></a>        </span>
        <br>

        <span class="karma">4.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12765" href="#C12765">
                <time itemprop="dateCreated" datetime="2014-11-04T04:00:11-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi, did you had time to look into this yet? We are still having this issue...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12765" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12765" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bc355fa2c779ddc4f383c2009b903069?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2502/niggo372" class="user-moderator-N"><span itemprop="name">niggo372</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12871" href="#C12871">
                <time itemprop="dateCreated" datetime="2014-11-06T08:43:50-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Anything new here? Having the same problem.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12871" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12871" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6e9c131d69313b8a3ff940e47cc2c265?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1980/Rewt0r" class="user-moderator-N"><span itemprop="name">Michael Jephcote</span></a>        </span>
        <br>

        <span class="karma">13.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="12886" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C12886" href="#C12886">
                <time itemprop="dateCreated" datetime="2014-11-06T18:06:48-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Just confirmed this on a database with ~1.7million rows.</p>
<pre><code>Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 24 bytes)
7   0.4107  1045864 Postcodes::find( )  ..\Product.php:599
8   0.4107  1046448 find ( )    ..\Postcodes.php:206
9   0.4107  1048392 execute ( ) ..\Postcodes.php:206
10  0.4108  1053784 _executeSelect ( )  ..\Postcodes.php:0
11  0.4173  1067456 query ( )   ..\Postcodes.php:0
12  0.4173  1067728 query ( )   ..\Postcodes.php:0</code></pre>
<p>Knowing that my memory_limit is set to 128M I decided to limit my find query until the error didn't appear and I was able to get to a value of 38,839.</p>
<pre><code class="language-php">    var_dump(count(Postcodes::find(array(
        'limit' =&gt; 38839
    ))));</code></pre>
<pre><code class="language-php">int 38839</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12886" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12886" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6e9c131d69313b8a3ff940e47cc2c265?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1980/Rewt0r" class="user-moderator-N"><span itemprop="name">Michael Jephcote</span></a>        </span>
        <br>

        <span class="karma">13.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12929" href="#C12929">
                <time itemprop="dateCreated" datetime="2014-11-08T11:22:02-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/1/phalcon">@phalcon</a> it seems that those lines you reference to in the code don't seem to be applying. At least not on version 1.3.3 anyway.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12929" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12929" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a535a378afa1bd9dd4846b87d7bc7227?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1031/theluk" class="user-moderator-N"><span itemprop="name">theluk</span></a>        </span>
        <br>

        <span class="karma">548</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12986" href="#C12986">
                <time itemprop="dateCreated" datetime="2014-11-10T07:49:03-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hey<a href="https://forum.phalcon.io/user/1/phalcon"> @phalcon</a> will you ever look into this or do we have to change the framework?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12986" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12986" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="12987" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C12987" href="#C12987">
                <time itemprop="dateCreated" datetime="2014-11-10T07:59:11-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>As I stated before, the framework is using a cursor that only puts one record at time in memory to work with big resultsets of data.</p>
<p>The resultset switch to cursor mode when count() shows that the resultset has more than 32 rows:</p>
<p>In 1.3.4:</p>
<ul>
<li><a href="https://github.com/phalcon/cphalcon/blob/1.3.4/ext/mvc/model/resultset/simple.c#L141">https://github.com/phalcon/cphalcon/blob/1.3.4/ext/mvc/model/resultset/simple.c#L141</a></li>
</ul>
<p>In 2.0.0:</p>
<ul>
<li>Check if the resultset is big: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75</a></li>
<li>Fetchs records one at time: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107</a></li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12987" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12987" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bc355fa2c779ddc4f383c2009b903069?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2502/niggo372" class="user-moderator-N"><span itemprop="name">niggo372</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C12987"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Phalcon                    </a>
                </div><div class="posts-buttons" align="right"><a name="C12988" href="#C12988">
                <time itemprop="dateCreated" datetime="2014-11-10T08:03:12-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thats all fine in theory, but it obviously doesn't work, hence the error messages.</p>
<blockquote>
<p>As I stated before, the framework is using a cursor that only puts one record at time in memory to work with big resultsets of data.</p>
<p>The resultset switch to cursor mode when count() shows that the resultset has more than 32 rows:</p>
<p>In 1.3.4:</p>
<ul>
<li><a href="https://github.com/phalcon/cphalcon/blob/1.3.4/ext/mvc/model/resultset/simple.c#L141">https://github.com/phalcon/cphalcon/blob/1.3.4/ext/mvc/model/resultset/simple.c#L141</a></li>
</ul>
<p>In 2.0.0:</p>
<ul>
<li>Check if the resultset is big: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L75</a></li>
<li>Fetchs records one at time: <a href="https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107">https://github.com/phalcon/cphalcon/blob/2.0.0/phalcon/mvc/model/resultset/simple.zep#L103-L107</a></li>
</ul>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12988" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12988" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a535a378afa1bd9dd4846b87d7bc7227?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1031/theluk" class="user-moderator-N"><span itemprop="name">theluk</span></a>        </span>
        <br>

        <span class="karma">548</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C12989" href="#C12989">
                <time itemprop="dateCreated" datetime="2014-11-10T08:11:14-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/1/phalcon">@phalcon</a> yes as you stated before, it seems you does not read the problem. Again: The problem is in executing the query, not during fetching. Your stated lines of code, are never reached, as the problem happens during query execution. As in the example of<a href="https://forum.phalcon.io/user/0/Rewt0r"> @Rewt0r</a> you can clearly see, that there it has nothing to do with rows.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="12989" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="12989" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8044d412c6af2aba09e1f9b15122a18f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1102/vikilaboy" class="user-moderator-N"><span itemprop="name">El Niño</span></a>        </span>
        <br>

        <span class="karma">231</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13006" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13006" href="#C13006">
                <time itemprop="dateCreated" datetime="2014-11-10T17:38:50-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hey guys,</p>
<p>I tested
$customers = Customer::find();
print_r($customers-&gt;count()); exit;
on a table with 5804011 rows and 1.4 GiB of data
The model for this table was generated by console - phalcon model ... </p>
<ul>
<li>PHP 5.5.15-1~dotdeb.1 (cli) (built: Jul 24 2014 16:44:04)</li>
<li>mysql  Ver 14.14 Distrib 5.5.38, for debian-linux-gnu (x86_64) using readline 6.2</li>
<li>Linux Debian 7.0</li>
<li>Phalcon 1.3.3</li>
<li>memory_limit = 512M</li>
</ul>
<p>Everything worked fine :)</p>
<p>CREATE TABLE <code>customer</code> (
<code>country</code> char(2) NOT NULL,
<code>id</code> int(10) unsigned NOT NULL AUTO_INCREMENT,
<code>customer_id</code> int(11) unsigned DEFAULT NULL,
<code>locale</code> varchar(5) NOT NULL,
<code>email</code> varchar(128) NOT NULL,
<code>first_name</code> varchar(64) DEFAULT NULL,
<code>last_name</code> varchar(64) DEFAULT NULL,
<code>gender</code> tinyint(3) unsigned DEFAULT NULL,
<code>date_of_birth</code> datetime DEFAULT NULL,
<code>birthday_date</code> datetime DEFAULT NULL,
<code>password_encryption_type</code> char(10) DEFAULT NULL,
<code>password_hash</code> varchar(64) DEFAULT NULL,
<code>registration_uri</code> varchar(255) DEFAULT NULL,
<code>registration_ip</code> varchar(16) DEFAULT NULL,
<code>confirmation_hash</code> varchar(255) DEFAULT NULL,
<code>confirmation_ip</code> varchar(16) DEFAULT NULL,
<code>activation_date</code> datetime DEFAULT NULL,
<code>last_login</code> datetime DEFAULT NULL,
<code>login_count</code> int(11) DEFAULT NULL,
<code>corporate_code</code> varchar(32) DEFAULT NULL,
<code>referrer_id</code> int(10) unsigned DEFAULT '0',
<code>affiliate_id</code> int(10) unsigned DEFAULT NULL,
<code>tradedoubler_uid</code> varchar(32) DEFAULT NULL,
<code>default_billing_address_id</code> int(10) unsigned DEFAULT NULL,
<code>default_shipping_address_id</code> int(10) unsigned DEFAULT NULL,
<code>newsletter_subscription_type</code> tinyint(3) unsigned DEFAULT NULL,
<code>email_change_address</code> varchar(128) DEFAULT NULL,
<code>email_change_ip</code> varchar(16) DEFAULT NULL,
<code>email_change_date</code> datetime DEFAULT NULL,
<code>email_change_confirmation_date</code> datetime DEFAULT NULL,
<code>complaints</code> smallint(5) unsigned DEFAULT '0',
<code>bounces</code> smallint(5) unsigned DEFAULT '0',
<code>soft_bounces</code> smallint(5) unsigned DEFAULT '0',
<code>hard_bounces</code> smallint(5) unsigned DEFAULT '0',
<code>block_bounces</code> smallint(5) unsigned DEFAULT '0',
<code>is_half_registered</code> tinyint(3) unsigned DEFAULT NULL,
<code>has_uncanceled_orders</code> tinyint(3) unsigned DEFAULT NULL,
<code>is_created_in_admin</code> tinyint(3) unsigned DEFAULT '0',
<code>is_active</code> tinyint(3) unsigned NOT NULL DEFAULT '1',
<code>created_at</code> datetime DEFAULT NULL,
<code>modified_at</code> datetime DEFAULT NULL,
<code>first_purchase</code> datetime DEFAULT NULL,
<code>last_purchase</code> datetime DEFAULT NULL,
<code>is_buyer</code> tinyint(1) DEFAULT '0',
<code>is_deleted</code> tinyint(3) unsigned NOT NULL DEFAULT '0',
<code>has_accepted</code> tinyint(4) NOT NULL DEFAULT '0' COMMENT '1 = cookies policy',
<code>manual_fidelity_score</code> smallint(5) unsigned DEFAULT NULL,
<code>system_fidelity_score</code> smallint(5) unsigned DEFAULT NULL,
PRIMARY KEY (<code>id</code>),
UNIQUE KEY <code>i_email_country</code> (<code>email</code>,<code>country</code>),
UNIQUE KEY <code>i_country_customer_id</code> (<code>country</code>,<code>customer_id</code>),
KEY <code>i_created_at</code> (<code>created_at</code>),
KEY <code>i_referrer_id</code> (<code>referrer_id</code>),
KEY <code>i_customer_id</code> (<code>customer_id</code>),
KEY <code>i_email_change_address</code> (<code>email_change_address</code>),
KEY <code>i_is_active</code> (<code>is_active</code>),
KEY <code>i_is_deleted</code> (<code>is_deleted</code>),
KEY <code>is_buyer</code> (<code>is_buyer</code>),
KEY <code>first_purchase</code> (<code>first_purchase</code>),
KEY <code>last_purchase</code> (<code>last_purchase</code>),
KEY <code>i_modified_at</code> (<code>modified_at</code>)
) ENGINE=InnoDB AUTO_INCREMENT=6718314 DEFAULT CHARSET=utf8;</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13006" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13006" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13008" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13008" href="#C13008">
                <time itemprop="dateCreated" datetime="2014-11-10T20:58:20-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I was checking the issue with PDO/Db and I see the following:</p>
<p>Scenario 1 (PDO + <code>MYSQL_ATTR_USE_BUFFERED_QUERY</code>:false):</p>
<pre><code class="language-php">$instance = new PDO('mysql:host=localhost;dbname=assets;charset=utf8', 'root', 'secret');
$instance-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$instance-&gt;setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, false);

echo memory_get_usage(), PHP_EOL;

$x = $instance-&gt;prepare('SELECT * FROM audit');
$p = $x-&gt;execute();

echo memory_get_usage(), PHP_EOL;

$x-&gt;rowCount();

echo memory_get_usage(), PHP_EOL;</code></pre>
<p>Results in:</p>
<pre><code>234832
242296
242296</code></pre>
<p>Scenario 1 (PDO + <code>MYSQL_ATTR_USE_BUFFERED_QUERY</code>:true):</p>
<pre><code class="language-php">$instance = new PDO('mysql:host=localhost;dbname=assets;charset=utf8', 'root', 'secret');
$instance-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$instance-&gt;setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true);

echo memory_get_usage(), PHP_EOL;

$x = $instance-&gt;prepare('SELECT * FROM audit');
$p = $x-&gt;execute();

echo memory_get_usage(), PHP_EOL;

$x-&gt;rowCount();

echo memory_get_usage(), PHP_EOL;</code></pre>
<p>Results in:</p>
<pre><code>234832
73682784
73682784</code></pre>
<p>Scenario 3 (PDO + <code>MYSQL_ATTR_USE_BUFFERED_QUERY</code>:default):</p>
<pre><code class="language-php">&lt;?php

$db = new \Phalcon\Db\Adapter\Pdo\MySQL(array(
        'username' =&gt; 'root',
        'password' =&gt; 'secret',
        'dbname' =&gt; 'assets',
));

$r = $db-&gt;query('SELECT * FROM audit');
echo memory_get_usage(), PHP_EOL;

$r-&gt;getInternalResult()-&gt;rowCount();

echo memory_get_usage(), PHP_EOL;</code></pre>
<p>Shows:</p>
<pre><code>73685824
73685872</code></pre>
<p>Scenario 4 (PDO + <code>MYSQL_ATTR_USE_BUFFERED_QUERY</code>:false):</p>
<pre><code class="language-php">$db = new \Phalcon\Db\Adapter\Pdo\MySQL(array(
        'username' =&gt; 'root',
        'password' =&gt; 'assets',
        'dbname' =&gt; 'secret',
        'options' =&gt; array(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY =&gt; false)
));

$r = $db-&gt;query('SELECT * FROM audit');
echo memory_get_usage(), PHP_EOL;

$r-&gt;getInternalResult()-&gt;rowCount();

echo memory_get_usage(), PHP_EOL;

exit;</code></pre>
<p>Results:</p>
<pre><code>246160
246208</code></pre>
<p>It seems the driver only fetches all the data when querying if MYSQL_ATTR_USE_BUFFERED_QUERY is not false.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13008" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13008" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6e9c131d69313b8a3ff940e47cc2c265?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1980/Rewt0r" class="user-moderator-N"><span itemprop="name">Michael Jephcote</span></a>        </span>
        <br>

        <span class="karma">13.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13010" href="#C13010">
                <time itemprop="dateCreated" datetime="2014-11-11T04:01:47-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>So changing this field in the connect parameters will fix the bug with Model::find()?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13010" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13010" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e6bec18643e50e26bdfd3e4306db80f6?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2596/voidburn" class="user-moderator-N"><span itemprop="name">Luca Vignaroli</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13016" href="#C13016">
                <time itemprop="dateCreated" datetime="2014-11-11T04:40:19-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It looks like it won't make it crash &amp; burn, but you don't get a row count either with the buffering disabled?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13016" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13016" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fcae2565ce4d1ed7240231932dec115a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/659/oleg578" class="user-moderator-N"><span itemprop="name">Oleg</span></a>        </span>
        <br>

        <span class="karma">8.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13017" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13017" href="#C13017">
                <time itemprop="dateCreated" datetime="2014-11-11T07:13:57-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This is behavior of PDO.</p>
<p>this code has same result</p>
<pre><code class="language-php">&lt;?php

ini_set('memory_limit', '-1');

$conn = new PDO('mysql:dbname=polaris;host=127.0.0.1', 'root', 'corner',array(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY=&gt;false));

echo $conn-&gt;getAttribute(constant('PDO::MYSQL_ATTR_USE_BUFFERED_QUERY')) . "\n";

echo $conn-&gt;getAttribute(constant('PDO::ATTR_DRIVER_NAME')) . "\n";

$sql = 'SELECT * from parts;';

echo memory_get_peak_usage(true), PHP_EOL; 
$res = $conn-&gt;query($sql);

echo memory_get_peak_usage(true), PHP_EOL;
var_dump($res-&gt;rowCount());</code></pre>
<p>I think, the only way to solve this problem - refusal of the PDO in favor MySQLi</p>
<p>Sorry, It will not work too...</p>
<pre><code>The behaviour of mysqli_num_rows() depends on whether buffered or unbuffered result sets are being used. For unbuffered result sets, mysqli_num_rows() will not return the correct number of rows until all the rows in the result have been retrieved.</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13017" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13017" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fcae2565ce4d1ed7240231932dec115a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/659/oleg578" class="user-moderator-N"><span itemprop="name">Oleg</span></a>        </span>
        <br>

        <span class="karma">8.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13024" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13024" href="#C13024">
                <time itemprop="dateCreated" datetime="2014-11-11T13:06:21-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Nonetheless...
This code use mysqli directly without PDO</p>
<pre><code class="language-php">echo "Memory limit : ", ini_get('memory_limit'), PHP_EOL;

$mysqli = new mysqli("localhost", "root", "corner", "polaris");

echo "Memory use before query : ", memory_get_peak_usage(true)/1024, "K", PHP_EOL;

$res = $mysqli-&gt;query("SELECT * from parts");

echo "Memory use after query : ", memory_get_peak_usage(true)/1024, "K", PHP_EOL;

echo "Number of rows : ", $res-&gt;num_rows, PHP_EOL;

$res-&gt;data_seek(1234);

$record = $res-&gt;fetch_object();

var_dump($record);</code></pre>
<p>Result : </p>
<pre><code>Memory limit : 512M
Memory use before query : 256K
Memory use after query : 178432K
Number of rows : 3249787
object(stdClass)#3 (6) {
  ["id"]=&gt;
  string(4) "1235"
  ["assembly_id"]=&gt;
  string(2) "41"
  ["tag"]=&gt;
  string(2) "29"
  ["sku"]=&gt;
  string(7) "5220588"
  ["name"]=&gt;
  string(18) "PLATE,REAR MOUNT  "
  ["qty"]=&gt;
  string(1) "1"
}</code></pre>
<p>And PDO code </p>
<pre><code class="language-php">ini_set('memory_limit', '-1');

$conn = new PDO('mysql:dbname=polaris;host=127.0.0.1', 'root', 'corner',array(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY=&gt;true));

echo $conn-&gt;getAttribute(constant('PDO::MYSQL_ATTR_USE_BUFFERED_QUERY')) . "\n";

echo $conn-&gt;getAttribute(constant('PDO::ATTR_DRIVER_NAME')) . "\n";

$sql = 'SELECT * from parts;';

echo "Memory use before query : ", memory_get_peak_usage(true)/1024, "K", PHP_EOL; 
$res = $conn-&gt;query($sql);

echo "Memory use after query : ", memory_get_peak_usage(true)/1024, "K", PHP_EOL;
var_dump($res-&gt;rowCount());
</code></pre>
<p>Result :</p>
<pre><code>1
mysql
Memory use before query : 256K
Memory use after query : 1092864K
int(3249787)</code></pre>
<p><a href="http://jpauli.github.io/2014/07/21/php-and-mysql-communication-mysqlnd.html#mysqli">http://jpauli.github.io/2014/07/21/php-and-mysql-communication-mysqlnd.html#mysqli</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13024" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13024" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bc355fa2c779ddc4f383c2009b903069?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2502/niggo372" class="user-moderator-N"><span itemprop="name">niggo372</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13422" href="#C13422">
                <time itemprop="dateCreated" datetime="2014-11-19T12:16:50-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sooooo...? Do we just have to cross this &quot;only one entry in memory&quot; thing from the feature list? Or will there be support for unbuffered queries (not relying on the result size) in Phalcon?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13422" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13422" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13423" href="#C13423">
                <time itemprop="dateCreated" datetime="2014-11-19T12:27:25-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>There's no bug in Model::find() or in Phalcon. Support for unbuffered queries depends on the initialization flags for PDO, if you see my previous comment, PDO itself (without Phalcon ORM/Db) fetches the whole resultset depending on whether buffered or unbuffered queries is enabled.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13423" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13423" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bc355fa2c779ddc4f383c2009b903069?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2502/niggo372" class="user-moderator-N"><span itemprop="name">niggo372</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13454" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13454" href="#C13454">
                <time itemprop="dateCreated" datetime="2014-11-20T08:38:09-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The Problem with it is that it just doesn't work as advertised. The documenation clearly states:</p>
<blockquote>
<p>These objects are more powerful than standard arrays. One of the greatest features of the Phalcon\Mvc\Model\Resultset is that at any time there is only one record in memory. This greatly helps in memory management especially when working with large amounts of data.</p>
</blockquote>
<p>With buffered queries, thats just not true as you said yourself. The PDO fetches all records and so they are all in memory.</p>
<p>But Phalcon doesn't work with unbuffered queries either as you can see in this example (robots is a db table with ~800MB worth of entries):</p>
<pre><code class="language-php">use Phalcon\DI;
use Phalcon\Db\Adapter\Pdo\Sqlite as Connection;
use Phalcon\Mvc\Model;

$di = new DI\FactoryDefault();

//Setup a connection
$di-&gt;set('db', function(){
    return new Phalcon\Db\Adapter\Pdo\Mysql(array(
        "host" =&gt; "localhost",
        "username" =&gt; "root",
        "password" =&gt; "secret",
        "dbname" =&gt; "test",
        "options" =&gt; array(\PDO::MYSQL_ATTR_USE_BUFFERED_QUERY =&gt; false)
    ));
 });

//Create a model
class Robots extends Model {}

//Use the model
$robots = Robots::find();

echo ($robots-&gt;valid() ? 'true' : 'false') . PHP_EOL;
echo count($robots) . PHP_EOL;
var_dump($robots-&gt;toArray());

$first = $robots-&gt;getFirst();
var_dump($first ? $first-&gt;toArray() : null);</code></pre>
<p>The output is:</p>
<pre><code>false
0
array(0) {
}
NULL</code></pre>
<p>Thats clearly not the desired behavior and it would be awesome if Phalcon could recognized an unbuffered query and act accordingly.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13454" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13454" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6726e9eb019ed4cce5acd4a8554e66bb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2245/verma-neeraj-in" class="user-moderator-N"><span itemprop="name">Neeraj Verma</span></a>        </span>
        <br>

        <span class="karma">153</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19355" href="#C19355">
                <time itemprop="dateCreated" datetime="2015-06-11T04:36:56-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't know why its behaving so strangely. But in my case if I rewind the pointer after fetching the result. This error never occur. Although before executing rewind() and after executing it. The pointer key is at 0. So its something like this:</p>
<pre><code>$data = Data::find();
$data-&gt;rewind();
while($data-&gt;valid()){
    // do whatever you want
    $data-&gt;next();
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19355" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19355" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/defc36d1814f7adf85220ae432a1d189?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4815/bacheson" class="user-moderator-N"><span itemprop="name">Blake Acheson</span></a>        </span>
        <br>

        <span class="karma">86</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C22647" href="#C22647">
                <time itemprop="dateCreated" datetime="2015-08-31T19:18:34-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It's actually not possible to write a long-running process with Phalcon due to this situation. Every query allocates 1mb (default buffer size) of memory. When processing jobs in a loop, memory usage increases at 1mb increments until all memory is exhausted. </p>
<p>Disabling the buffer using \PDO::MYSQL_ATTR_USE_BUFFERED_QUERY breaks all -&gt;count() operations within the ORM. </p>
<p>It would be amazing if somehow count() could fall back to some other method that doesn't require the buffer.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="22647" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="22647" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f76c9ac84311cc86816bb2d09659d033?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/969/zz" class="user-moderator-N"><span itemprop="name">ZZ</span></a>        </span>
        <br>

        <span class="karma">977</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="44227" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '16</span>
              </span><br/><a name="C44227" href="#C44227">
                <time itemprop="dateCreated" datetime="2016-12-22T02:57:34-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think I have the same problem on version 3.  can't fix.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="44227" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="44227" data-cf-modified-4b54024eca3133b291a04d62-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="3793" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>