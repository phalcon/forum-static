---
layout: default
title: 'possible bug with \Mvc\Model&#039;s &quot;useDynamicUpdate&quot; (v2.0.4) - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">possible bug with \Mvc\Model&#039;s &quot;useDynamicUpdate&quot; (v2.0.4)</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-09T20:18:13-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-09T20:18:13-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>463</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a></span>
                <span class="karma">2.5k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7525" href="#C7525">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>After updating to 2.0.4 I get the following error (per every attribute in the model) when selecting a model from the database:</p>
<blockquote>
<p>Notice: Cannot use a scalar value as an array in phalcon/mvc/model.zep on line 3600</p>
</blockquote>
<p>This only happens when I set <em>useDynamicUpdate = true</em>. Is this a bug?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-e9f912c03adb7be54b4452b4-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-e9f912c03adb7be54b4452b4-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fb35f447c5edce740bc88e405d5eb3af?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/742/cspeak" class="user-moderator-N"><span itemprop="name">Steven</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20517" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20517" href="#C20517">
                <time itemprop="dateCreated" datetime="2015-07-10T16:49:18-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>After looking at the code in GitHub, line 3600 is within the &quot;public function setSnapshotData&quot; function. That is why you're seeing the issue only when you have <code>useDynamicUpdate = true</code></p>
<p><a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/mvc/model.zep#L3562">https://github.com/phalcon/cphalcon/blob/master/phalcon/mvc/model.zep#L3562</a></p>
<p>However, that doesn't mean that &quot;useDynamicUpdate&quot; function is necessarily the issue. </p>
<p>Can you post up your PHP code for the model that is having the issue?</p>
<p>I briefly skimmed the Zephir docs to better understand what the <code>setSnapshotData()</code> function was doing at the time of the error. If for some reason there is an issue with your model, hopefully it'll be enough to help you track it down.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20517" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20517" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a>        </span>
        <br>

        <span class="karma">2.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20521" href="#C20521">
                <time itemprop="dateCreated" datetime="2015-07-11T02:36:56-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I reduced the model to</p>
<blockquote>
<pre><code>class User extends \Phalcon\Mvc\Model
{
    public function initialize()
    {
        $this-&gt;useDynamicUpdate(true);
    }
}</code></pre>
</blockquote>
<p>and the controller is </p>
<blockquote>
<pre><code>$user = \User::findFirst(1);</code></pre>
</blockquote>
<p>and am still getting the error. By the way I'm on Windows 8 localhost (xampp - php 5.6.8).</p>
<p>As an aside, does dynamic update require snapshots to be on? I set <em>keepSnapshots=true</em> but it didn't help.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20521" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20521" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fb35f447c5edce740bc88e405d5eb3af?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/742/cspeak" class="user-moderator-N"><span itemprop="name">Steven</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20539" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20539" href="#C20539">
                <time itemprop="dateCreated" datetime="2015-07-11T22:30:54-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Assuming that your User model has a field called &quot;user_id&quot; as the primary key, what happens if you try the following:</p>
<pre><code class="language-php">
$user = \User::findFirstByUserId(1); // If you are searching on "id" instad of "user_id" replace with findFirstById(1)

if(!$user){
exit("User does not exist");
}</code></pre>
<p>The first time I used <code>User::findFirst($pk_value);</code> I had an issue with it so I always call the specific field using <code>Model::findFirstByFieldName($pk_value)</code> and it has solved numerous issues I ran into.</p>
<p>Also, do you define your column map in the model?  <a href="https://docs.phalcon.io/en/latest/reference/models.html#independent-column-mapping">https://docs.phalcon.io/en/latest/reference/models.html#independent-column-mapping</a></p>
<p>If you don't use independent column mapping, I would recommend doing so. And if you don't already, you should look into Phalcon's DevTools as well. Invaluable tool for getting things up and running quickly and accurately</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20539" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20539" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a>        </span>
        <br>

        <span class="karma">2.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20551" href="#C20551">
                <time itemprop="dateCreated" datetime="2015-07-12T19:10:06-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I tried that but to no avail. Also, thanks for the other advice.</p>
<p>The code I posted above is perfectly fine but started acting up after the last version update. Is there a bug in 2.0.4 or did something change that I should know about?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20551" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20551" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fb35f447c5edce740bc88e405d5eb3af?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/742/cspeak" class="user-moderator-N"><span itemprop="name">Steven</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C20551"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        peter galkaev                    </a>
                </div><div class="posts-buttons" align="right"><a name="C20555" href="#C20555">
                <time itemprop="dateCreated" datetime="2015-07-12T22:15:19-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Are you able to post the actual code you use? The code does look valid but it is just a small part of your overall codeset I'm sure. I'm just trying to get enough info to help debug either in the app or the framework itself. It would be great to see enough to hopefully reproduce the issue on my side</p>
<blockquote>
<p>I tried that but to no avail. Also, thanks for the other advice.</p>
<p>The code I posted above is perfectly fine but started acting up after the last version update. Is there a bug in 2.0.4 or did something change that I should know about?</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20555" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20555" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a>        </span>
        <br>

        <span class="karma">2.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20557" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20557" href="#C20557">
                <time itemprop="dateCreated" datetime="2015-07-12T23:31:43-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>By the way do you have error reporting enabled?</p>
<pre><code class="language-php">error_reporting(E_ALL);
ini_set('display_errors', 1);</code></pre>
<p>I'm pretty sure the reason for this issue is because the <em>setSnapshotData</em> function is missing the below code </p>
<pre><code>let attribute = [];</code></pre>
<p>OR they should put a variable in the snapshot array instead of <em>attribute[0]</em></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20557" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20557" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a86c986969dad5a3f840a06fd2e1ada?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4331/galki" class="user-moderator-N"><span itemprop="name">peter galkaev</span></a>        </span>
        <br>

        <span class="karma">2.5k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20767" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20767" href="#C20767">
                <time itemprop="dateCreated" datetime="2015-07-16T18:27:02-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This is a bug and is set to be fixed.
<a href="https://github.com/phalcon/cphalcon/issues/10648"><a href="https://github.com/phalcon/cphalcon/issues/10648">https://github.com/phalcon/cphalcon/issues/10648</a></a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20767" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20767" data-cf-modified-e9f912c03adb7be54b4452b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7525" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>