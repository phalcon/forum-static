---
layout: default
title: 'IDS - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/16/security">Security</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">IDS</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/3870/alimo2" class="user-moderator-N"><span itemprop="name">alimo2</span></a></span>
            <time itemprop="dateCreated" datetime="2015-09-13T23:09:56-07:00">Sep '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-09-13T23:09:56-07:00">Sep '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Sep '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">1</span>
                </td>
                <td>
                    <label>Views</label><br>361</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">1</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/38ff9c265ae081ddf507a64ebf690243?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/3870/alimo2" class="user-moderator-N"><span itemprop="name">alimo2</span></a></span>
                <span class="karma">5.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C8507" href="#C8507">
        <time class="action-date">Sep '15</time>
    </a>
</div>
<div class="post-content"><div><p>Hey Community,</p>
<p>I'm looking  solution for Intrusion detecting (IDS) in Phalcon app. I did it in <code>application:beforeHandleRequest</code> event &amp; check all superglobal variabl such as $_REQUEST, $_POST, $_GET, $_COOKIES for any bad codes or scripts, but i don't know if it  is standard or not. please help me if there is an advanced solution for this.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-1e680fc142752cd7a1f61aee-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-1e680fc142752cd7a1f61aee-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d949595d3b8407de247b85bc7c024d46?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3850/ch3k1" class="user-moderator-N"><span itemprop="name">Aleksandre Vardanidze</span></a>        </span>
        <br>

        <span class="karma">13.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="23333" data-toggle="modal" data-target="#historyModal">
                edited <span>Sep '15</span>
              </span><br/><a name="C23333" href="#C23333">
                <time itemprop="dateCreated" datetime="2015-09-14T23:33:59-07:00" class="action-date">Sep '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>hi, do u know about snort? </p>
</blockquote>
<p><a href="https://www.snort.org/"><a href="https://www.snort.org/">https://www.snort.org/</a></a></p>
<p><a href="https://dl.packetstormsecurity.net/papers/IDS/snort-firstline.pdf"><a href="https://dl.packetstormsecurity.net/papers/IDS/snort-firstline.pdf">https://dl.packetstormsecurity.net/papers/IDS/snort-firstline.pdf</a></a></p>
<pre><code class="language-php">public function hackAction() {

    $ipAddress = $this-&gt;request-&gt;getClientAddress();
    $userAgent = $this-&gt;request-&gt;getUserAgent();
    $data = date('Y-m-d G:i:s');

    $query_command = $_SERVER['QUERY_STRING'];
    $keyword = 
    array('chr(', 'chr=', 'chr%20', '%20chr', 'wget%20', '%20wget', 'wget(', 
         'cmd=', '%20cmd', 'cmd%20', 'rush=', '%20rush', 'rush%20', 'union%20', 
         '%20union', 'union(', 'union=', 'echr(', '%20echr', 'echr%20', 'echr=', 
         'esystem(', 'esystem%20', 'cp%20', '%20cp', 'cp(', 'mdir%20', '%20mdir', 
         'mdir(', 'mcd%20', 'mrd%20', 'rm%20', '%20mcd', '%20mrd', '%20rm', 'mcd(', 
         'mrd(', 'rm(', 'mcd=', 'mrd=', 'mv%20', 'rmdir%20', 'mv(', 'rmdir(', 'chmod(', 
         'chmod%20', '%20chmod', 'chmod(', 'chmod=', 'chown%20', 'chgrp%20', 'chown(', 
         'chgrp(', 'locate%20', 'grep%20', 'locate(', 'grep(', 'diff%20', 'kill%20', 
         'kill(', 'killall', 'passwd%20', '%20passwd', 'passwd(', 'telnet%20', 
         'vi(', 'vi%20', 'insert%20into', 'select%20', 'nigga(', '%20nigga', 'nigga%20', 
         'fopen', 'fwrite', '%20like', 'like%20', '$_request', '$_get', '$request', '$get', 
         '.system', 'HTTP_PHP', '&amp;aim', '%20getenv', 'getenv%20', 'new_password', '&amp;icq', 
         '/etc/password', '/etc/shadow', '/etc/groups', '/etc/gshadow', 'HTTP_USER_AGENT', 
         'HTTP_HOST', '/bin/ps', 'wget%20', 'uname\x20-a', '/usr/bin/id', '/bin/echo', 
         '/bin/kill', '/bin/', '/chgrp', '/chown', '/usr/bin', 'g\+\+', 'bin/python', 
         'bin/tclsh', 'bin/nasm', 'perl%20', 'traceroute%20', 'ping%20', '.pl', 
         '/usr/X11R6/bin/xterm', 'lsof%20', '/bin/mail', '.conf', 'motd%20', 'HTTP/1.', 
         '.inc.php', 'config.php', 'cgi-', '.eml', 'file\://', 'window.open', '&lt;SCRIPT&gt;', 
         'javascript\://', 'img src', 'img%20src', '.jsp', 'ftp.exe', 'xp_enumdsn', 
         'xp_availablemedia', 'xp_filelist', 'xp_cmdshell', 'nc.exe', '.htpasswd', 
         'servlet', '/etc/passwd', 'wwwacl', '~root', '~ftp', '.js', '.jsp', 'admin_', 
         '.history', 'bash_history', '.bash_history', '~nobody', 'server-info', 'server-status', 
         'reboot%20', 'halt%20', 'powerdown%20', '/home/ftp', '/home/www', 'secure_site, ok', 
         'chunked', 'org.apache', '/servlet/con', '&lt;script', '/robot.txt', '/perl', 'mod_gzip_status', 
         'db_mysql.inc', '.inc', 'select%20from', 'select from', 'drop%20', '.system', 'getenv', 
         'http_', '_php', 'php_', 'passwd', 'phpinfo()', '&lt;?php', '?&gt;', 'sql=', 'p=-', 'c$', 
         'union', 'select', 'null', 'NULL', 'NU', 'xss', '+', '-', '*', '../../', '/*', 'promit', 
         'alert', 'GET', 'POST', '../', 'ping', 'PING', './', 'SELECT');

    $checking = str_replace($keyword, '*', $query_command);

    if ($query_command != $checking) {

         $logs = new Hack();
         $logs-&gt;ipAddress = $ipAddress;
         $logs-&gt;userAgent = $userAgent;
         $logs-&gt;data = $data;
         $logs-&gt;query = $query_command;
         $logs-&gt;save();
    }

    if ($query_command != $checking) {

        //do some
    }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="23333" data-cf-modified-1e680fc142752cd7a1f61aee-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="23333" data-cf-modified-1e680fc142752cd7a1f61aee-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/38ff9c265ae081ddf507a64ebf690243?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3870/alimo2" class="user-moderator-N"><span itemprop="name">alimo2</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C23381" href="#C23381">
                <time itemprop="dateCreated" datetime="2015-09-15T19:58:13-07:00" class="action-date">Sep '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>yes, i know snort, php-ids and others. but my question is where is best place in phalcon to put IDS code to refine all intrusions?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="23381" data-cf-modified-1e680fc142752cd7a1f61aee-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="23381" data-cf-modified-1e680fc142752cd7a1f61aee-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="8507" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>