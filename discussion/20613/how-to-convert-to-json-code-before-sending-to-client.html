---
layout: default
title: 'How to convert to json code before sending to client? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/22/micro">Micro</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">How to convert to json code before sending to client?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a></span>
            <time itemprop="dateCreated" datetime="2020-05-05T07:57:31-07:00">May '20</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2020-05-05T07:57:31-07:00">May '20</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">6</span>
                </td>
                <td>
                    <label>Views</label><br>198</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a></span>
                <span class="karma">31.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C20613" href="#C20613">
        <time class="action-date">May '20</time>
    </a>
</div>
<div class="post-content"><div><p>Recently I'm work on with the official example <a href="https://github.com/phalcon/rest-api"><a href="https://github.com/phalcon/rest-api">https://github.com/phalcon/rest-api</a></a>.</p>
<p>A field of my database is stored with <code>serialized</code> data:</p>
<pre><code class="language-php">a:3:{s:3:"uid";i:7;s:4:"name";s:6:"mervin";s:6:"status";s:5:"login";}</code></pre>
<p>If under pure PHP, I can use <code>unserialized()</code> and <code>json_encode()</code> functions to convert to the json string.</p>
<p>But how to  convert  this field to json string in  the<code>rest-api</code>example?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-0e6203c00c32c63961883f8f-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-0e6203c00c32c63961883f8f-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C63069" href="#C63069">
                <time itemprop="dateCreated" datetime="2020-05-05T09:22:48-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You get the data from your database. Unserialize it and it will become an array. You then set that array as the payload in your response from your controller. The API will handle the rest (converting it to JSON)</p>
<pre><code class="language-php">$data = unserialize($dbValue);

$this-&gt;response-&gt;setPayloadSuccess($data);</code></pre>
<p><a href="https://github.com/phalcon/rest-api/blob/master/library/Http/Response.php#L147">https://github.com/phalcon/rest-api/blob/master/library/Http/Response.php#L147</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63069" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63069" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a>        </span>
        <br>

        <span class="karma">31.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63075" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63075" href="#C63075">
                <time itemprop="dateCreated" datetime="2020-05-05T17:52:28-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for the answer. The problem is there is no code can modify a specified field, below is the controller:</p>
<pre><code class="language-php">&lt;?php
declare(strict_types=1);

class GetController extends BaseController
{
    /** @var string */
    protected $model       = Companies::class;

    /** @var array */
    protected $includes    = [
        Relationships::INDIVIDUALS,
        Relationships::PRODUCTS,
    ];

    /** @var string */
    protected $resource    = Relationships::COMPANIES;

    /** @var array&lt;string|boolean&gt; */
    protected $sortFields  = [
        'id'      =&gt; true,
        'name'    =&gt; true,
        'address' =&gt; true,
        'city'    =&gt; true,
        'phone'   =&gt; true,
    ];

    /** @var string */
    protected $transformer = CompaniesTransformer::class;
}</code></pre>
<p>and the BaseController:
<a href="https://github.com/phalcon/rest-api/blob/master/api/controllers/BaseController.php">https://github.com/phalcon/rest-api/blob/master/api/controllers/BaseController.php</a></p>
<p>Could you please show me a more complete code of the GetController?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63075" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63075" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63077" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63077" href="#C63077">
                <time itemprop="dateCreated" datetime="2020-05-06T07:15:13-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I thought that you had a new controller. </p>
<p>To use the same controllers as the API but with different fields - in your case the serialized one - you will need to check the transformer classes. Those are the ones that pick the data up from the collection (that came from the database) and transform them to whatever the API needs. </p>
<p><a href="https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52">https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52</a></p>
<p>This is the base transfromer action. You can create a new transformer class for your usage, you can add a simple conditional there, or extend the current transformer class, override <code>transform</code> to do what you need. Something like this:</p>
<pre><code class="language-php">    public function transform(AbstractModel $model)
    {
        $modelFields     = array_keys($model-&gt;getModelFilters());
        $requestedFields = $this-&gt;fields[$this-&gt;resource] ?? $modelFields;
        $fields          = array_intersect($modelFields, $requestedFields);
        $data            = [];
        foreach ($fields as $field) {
            $data[$field] = $model-&gt;get($field);

            // This is the serialized field
            if ("my-field" === $field) {
                $data[$field] = json_encode(unserialize($data[$field]));
            }
        }

        return $data;
    }</code></pre>
<p>You will of course need to refactor this to suit your needs, add more checks so that <code>json_encode</code> and <code>unserialize</code> do not fail based on data etc.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63077" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63077" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1320/tztztztz" class="user-moderator-N"><span itemprop="name">Tomasz Zadora</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63089" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63089" href="#C63089">
                <time itemprop="dateCreated" datetime="2020-05-07T04:05:53-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can use afterFetch() function in the Model Class and there convert your data: unserialize, decode form JSON etc.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63089" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63089" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a>        </span>
        <br>

        <span class="karma">31.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C63077"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nikolaos Dimopoulos                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63095" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63095" href="#C63095">
                <time itemprop="dateCreated" datetime="2020-05-07T06:50:11-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks!</p>
<p>I've created a new transformer class:</p>
<pre><code class="language-php">class ProblemsTransformer extends BaseTransformer
{
    ...

    public function transform(AbstractModel $model)
    {
        $data = parent::transform($model);

        foreach ($data as $field =&gt; $value)
        {
            if ("sample_input" == $field)
            {
                $data[$field] = str_replace("&amp;#34;", "\"", $data[$field]);
                $data[$field] = json_encode(unserialize($data[$field]));
            }
        }

        return $data;
    }
}</code></pre>
<p>And it seems works well, I can get the proper data, but I'm not sure it is the correct way to override the <code>transform</code> method.</p>
<blockquote>
<p>I thought that you had a new controller. </p>
<p>To use the same controllers as the API but with different fields - in your case the serialized one - you will need to check the transformer classes. Those are the ones that pick the data up from the collection (that came from the database) and transform them to whatever the API needs. </p>
<p><a href="https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52">https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52</a></p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63095" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63095" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a>        </span>
        <br>

        <span class="karma">31.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C63089"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Tomasz Zadora                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63097" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63097" href="#C63097">
                <time itemprop="dateCreated" datetime="2020-05-07T07:00:15-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Actually there are no any explicit declaration of the data members in the Model, like the code below.</p>
<p>I think I cant't use <code>getter</code> or <code>setter</code> to change the data members. How to deal with <code>afterFetch()</code>?</p>
<pre><code class="language-php">
class Companies extends AbstractModel
{
    /**
     * Initialize relationships and model properties
     */
    public function initialize()
    {
        $this-&gt;setSource('co_companies');

        $this-&gt;hasMany(
            'id',
            Individuals::class,
            'companyId',
            [
                'alias'    =&gt; Relationships::INDIVIDUALS,
                'reusable' =&gt; true,
            ]
        );

        parent::initialize();
    }

    /**
     * Model filters
     *
     * @return array&lt;string,string&gt;
     */
    public function getModelFilters(): array
    {
        return [
            'id'      =&gt; Filter::FILTER_ABSINT,
            'name'    =&gt; Filter::FILTER_STRING,
            'address' =&gt; Filter::FILTER_STRING,
            'city'    =&gt; Filter::FILTER_STRING,
            'phone'   =&gt; Filter::FILTER_STRING,
        ];
    }

}</code></pre>
<blockquote>
<p>You can use afterFetch() function in the Model Class and there convert your data: unserialize, decode form JSON etc.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63097" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63097" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C63095"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        xaero                    </a>
                </div><div class="posts-buttons" align="right"><a name="C63099" href="#C63099">
                <time itemprop="dateCreated" datetime="2020-05-07T07:00:25-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>If the data comes from your Companies table, extend the <code>CompaniesTransformer</code>and you can override the <code>transform</code> as you do there.</p>
<p>The reason that we extend the <code>CompaniesTransformer</code> is because that transformer has some data already set up (relationships etc.) that you will probably need.</p>
<p>But yeah this is the way to do it.</p>
<blockquote>
<p>Thanks!</p>
<p>I've created a new transformer class:</p>
<pre><code class="language-php">class ProblemsTransformer extends BaseTransformer
{
   ...

   public function transform(AbstractModel $model)
   {
       $data = parent::transform($model);

       foreach ($data as $field =&gt; $value)
       {
           if ("sample_input" == $field)
           {
               $data[$field] = str_replace("&amp;#34;", "\"", $data[$field]);
               $data[$field] = json_encode(unserialize($data[$field]));
           }
       }

       return $data;
   }
}</code></pre>
<p>And it seems works well, I can get the proper data, but I'm not sure it is the correct way to override the <code>transform</code> method.</p>
<blockquote>
<p>I thought that you had a new controller. </p>
<p>To use the same controllers as the API but with different fields - in your case the serialized one - you will need to check the transformer classes. Those are the ones that pick the data up from the collection (that came from the database) and transform them to whatever the API needs. </p>
<p><a href="https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52">https://github.com/phalcon/rest-api/blob/master/library/Transformers/BaseTransformer.php#L52</a></p>
</blockquote>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63099" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63099" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C63097"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        xaero                    </a>
                </div><div class="posts-buttons" align="right"><a name="C63101" href="#C63101">
                <time itemprop="dateCreated" datetime="2020-05-07T07:22:19-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>There are a couple of things you will need to do if you want to work with the model and take advantage of <code>afterFetch</code>. </p>
<p>The code uses the <code>get</code> and <code>set</code> methods in the model, which are created to silently sanitize values based on the <code>getModelFilters</code></p>
<p>You can stop using that if you want and use the <code>$model-&gt;$fieldname</code> directly. Also in the <code>afterFetch</code> you can use the field directlyto perform the transformation, just as you have done in your transformer class. Note though, that you will also need to change you transformer class to no longer use the <code>get</code> method of the model and sanitize things on your own.</p>
<p>Going down this route will definitely be a lenghier trip than creating a new transformer.</p>
<p>I should create a small video tutorial for the rest api....</p>
<blockquote>
<p>Actually there are no any explicit declaration of the data members in the Model, like the code below.</p>
<p>I think I cant't use <code>getter</code> or <code>setter</code> to change the data members. How to deal with <code>afterFetch()</code>?</p>
<pre><code class="language-php">
class Companies extends AbstractModel
{
   /**
    * Initialize relationships and model properties
    */
   public function initialize()
   {
       $this-&gt;setSource('co_companies');

       $this-&gt;hasMany(
           'id',
           Individuals::class,
           'companyId',
           [
               'alias'    =&gt; Relationships::INDIVIDUALS,
               'reusable' =&gt; true,
           ]
       );

       parent::initialize();
   }

   /**
    * Model filters
    *
    * @return array&lt;string,string&gt;
    */
   public function getModelFilters(): array
   {
       return [
           'id'      =&gt; Filter::FILTER_ABSINT,
           'name'    =&gt; Filter::FILTER_STRING,
           'address' =&gt; Filter::FILTER_STRING,
           'city'    =&gt; Filter::FILTER_STRING,
           'phone'   =&gt; Filter::FILTER_STRING,
       ];
   }

}</code></pre>
<blockquote>
<p>You can use afterFetch() function in the Model Class and there convert your data: unserialize, decode form JSON etc.</p>
</blockquote>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63101" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63101" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1320/tztztztz" class="user-moderator-N"><span itemprop="name">Tomasz Zadora</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="63107" data-toggle="modal" data-target="#historyModal">
                edited <span>May '20</span>
              </span><br/><a name="C63107" href="#C63107">
                <time itemprop="dateCreated" datetime="2020-05-07T14:15:49-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Well im unfamiliar with the rest-api example, I thought Your model extends \Phalcon\Mvc\Model class, in that case, if your data to unserialize is in &quot;serialized_data&quot; column, You would do in Your model Class:</p>
<pre><code>public function afterFetch()  {
    if (!empty($this-&gt;serialized_data)) {
        $this-&gt;serialized_data = \unserialize( $this-&gt;serialized_data );
    }
}</code></pre>
<p>and stright after getting model from ORM you have object in &quot;serialized_data&quot; variable insted of string to unserialize. Althought I prefer to keep data in json, convert to stdClass by json_decode in afterFetch method, and then convert from stdClass to target class. It's much safer in situation when Your serialized object class definition has changed.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63107" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63107" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f3183e109ec4c5c93d7deab887f7b8e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3021/xaero7" class="user-moderator-N"><span itemprop="name">xaero</span></a>        </span>
        <br>

        <span class="karma">31.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C63101"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nikolaos Dimopoulos                    </a>
                </div><div class="posts-buttons" align="right"><a name="C63111" href="#C63111">
                <time itemprop="dateCreated" datetime="2020-05-07T18:12:59-07:00" class="action-date">May '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks a lot for helping me out, Mr.Big ~  :D
video tutorial will be  wonderful，but I  think more functional examples will be usefull, for example the pagination.
The <code>rest-api</code> project is cute and magic for me~ Thanks for the project!</p>
<blockquote>
<p>There are a couple of things you will need to do if you want to work with the model and take advantage of <code>afterFetch</code>. </p>
<p>The code uses the <code>get</code> and <code>set</code> methods in the model, which are created to silently sanitize values based on the <code>getModelFilters</code></p>
<p>You can stop using that if you want and use the <code>$model-&gt;$fieldname</code> directly. Also in the <code>afterFetch</code> you can use the field directlyto perform the transformation, just as you have done in your transformer class. Note though, that you will also need to change you transformer class to no longer use the <code>get</code> method of the model and sanitize things on your own.</p>
<p>Going down this route will definitely be a lenghier trip than creating a new transformer.</p>
<p>I should create a small video tutorial for the rest api....</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63111" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63111" data-cf-modified-0e6203c00c32c63961883f8f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="20613" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>