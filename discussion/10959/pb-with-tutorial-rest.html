---
layout: default
title: 'Pb with tutorial REST - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Pb with tutorial REST</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a></span>
            <time itemprop="dateCreated" datetime="2016-03-29T22:27:42-07:00">Mar '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-03-29T22:27:42-07:00">Mar '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Mar '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>554</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/467ac459046d75497a3d3d65b14491b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a></span>
                <span class="karma">3.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C10959" href="#C10959">
        <time class="action-date">Mar '16</time>
    </a>
</div>
<div class="post-content"><div><p>I followed this tutorial
<a href="https://docs.phalcon.io/en/latest/reference/tutorial-rest.html">https://docs.phalcon.io/en/latest/reference/tutorial-rest.html</a>,</p>
<p>I copy paste exactly the same code.
I succeed to get the list of robots
I have installed Xamp PHP 5.6</p>
<p>But in i try to add a robot using curl i have the followgin error message:
curl.exe -i -X POST -d '{&quot;name&quot;:&quot;C-3PO&quot;,&quot;type&quot;:&quot;droid&quot;,&quot;year&quot;:1977}' <a href="http://localhost/sample/api/robots">http://localhost/sample/api/robots</a>
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;118&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;119&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;120&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Fatal error&lt;/b&gt;:  Class 'Response' not found in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;124&lt;/b&gt;&lt;br /&gt;</p>
<p>And when I try to update an existing robot, i have the followgin  error message:
curl.exe  -i -X PUT -d '{&quot;name&quot;:&quot;ASIMO&quot;,&quot;type&quot;:&quot;humanoid&quot;,&quot;year&quot;:2000}'    <a href="http://localhost/sample/api/robots/2">http://localhost/sample/api/robots/2</a>
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;173&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;174&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;175&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Fatal error&lt;/b&gt;:  Class 'Response' not found in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;179&lt;/b&gt;&lt;br /&gt;</p>
<p>Can you help me please?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C31713" href="#C31713">
                <time itemprop="dateCreated" datetime="2016-03-29T23:28:54-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>give us what's in <code>D:\Sources\xampp\htdocs\mailman\index.php</code> lines: 118,119,120,124,173,174,175,179</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31713" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31713" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/467ac459046d75497a3d3d65b14491b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a>        </span>
        <br>

        <span class="karma">3.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31723" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31723" href="#C31723">
                <time itemprop="dateCreated" datetime="2016-03-30T00:08:33-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The lines given errors:</p>
<pre><code>$status = $app-&gt;modelsManager-&gt;executeQuery($phql, array(
    'name' =&gt; $robot-&gt;name,
    'type' =&gt; $robot-&gt;type,
    'year' =&gt; $robot-&gt;year
));

// Create a response
$response = new Response();</code></pre>
<p>The complete function Add:</p>
<pre><code>// Adds a new robot
$app-&gt;post('/api/robots', function() use ($app) {

$robot = $app-&gt;request-&gt;getJsonRawBody();

$phql = "INSERT INTO Robots (name, type, year) VALUES (:name:, :type:, :year:)";

$status = $app-&gt;modelsManager-&gt;executeQuery($phql, array(
    'name' =&gt; $robot-&gt;name,
    'type' =&gt; $robot-&gt;type,
    'year' =&gt; $robot-&gt;year
));

// Create a response
$response = new Response();

// Check if the insertion was successful
if ($status-&gt;success() == true) {

    // Change the HTTP status
    $response-&gt;setStatusCode(201, "Created");

    $robot-&gt;id = $status-&gt;getModel()-&gt;id;

    $response-&gt;setJsonContent(
        array(
            'status' =&gt; 'OK',
            'data'   =&gt; $robot
        )
    );

} else {

    // Change the HTTP status
    $response-&gt;setStatusCode(409, "Conflict");

    // Send errors to the client
    $errors = array();
    foreach ($status-&gt;getMessages() as $message) {
        $errors[] = $message-&gt;getMessage();
    }

    $response-&gt;setJsonContent(
        array(
            'status'   =&gt; 'ERROR',
            'messages' =&gt; $errors
        )
    );
}

return $response;
});</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31723" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31723" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31743" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31743" href="#C31743">
                <time itemprop="dateCreated" datetime="2016-03-30T01:10:36-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>did you register the service ?</p>
<pre><code>
 $di-&gt;set('modelsManager', function() {
      return new ModelsManager();
 });
</code></pre>
<p><a href="https://docs.phalcon.io/en/latest/api/Phalcon_Mvc_Model_Manager.html">https://docs.phalcon.io/en/latest/api/Phalcon_Mvc_Model_Manager.html</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31743" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31743" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/467ac459046d75497a3d3d65b14491b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a>        </span>
        <br>

        <span class="karma">3.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31803" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31803" href="#C31803">
                <time itemprop="dateCreated" datetime="2016-03-30T21:24:15-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I didnt register the service, it seems already included.</p>
<p>When i call the get list of robots, it works:</p>
<pre><code>// Searches for robots with $name in their name
$app-&gt;get('/api/robots/search/{name}', function ($name) use ($app) {
  $phql = " SELECT *
        FROM Robots
        WHERE name LIKE :name:
        ORDER BY name";
  $robots = $app-&gt;modelsManager-&gt;executeQuery(
  $phql,
  array(
      'name' =&gt; '%' . $name . '%'
  )
  );

  $data = array();
  foreach ($robots as $robot) {
  $data[] = array(
      'id'   =&gt; $robot-&gt;id,
      'name' =&gt; $robot-&gt;name
  );
  }

  echo json_encode($data);
});</code></pre>
<p>So the problem not come from this part.</p>
<p>I succedeed to remove an error adding </p>
<pre><code>use Phalcon\Http\Response;</code></pre>
<p>now the error is:</p>
<pre><code>&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;161&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;162&lt;/b&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;b&gt;Notice&lt;/b&gt;:  Trying to get property of non-object in &lt;b&gt;D:\Sources\xampp\htdocs\mailman\index.php&lt;/b&gt; on line &lt;b&gt;163&lt;/b&gt;&lt;br /&gt;
{"status":"ERROR","messages":["name is required","type is required","year is required"]}</code></pre>
<p>line 156 to 164</p>
<pre><code>$robot = $app-&gt;request-&gt;getJsonRawBody();
//return print_r($app-&gt;request-&gt;getJsonRawBody());
$phql = "INSERT INTO Robots (name, type, year) VALUES (:name:, :type:, :year:)";

$status = $app-&gt;modelsManager-&gt;executeQuery($phql, array(
    'name' =&gt; $robot-&gt;name,
    'type' =&gt; $robot-&gt;type,
    'year' =&gt; $robot-&gt;year
));</code></pre>
<p>when i do this:</p>
<pre><code>return print_r($app-&gt;request-&gt;getJsonRawBody());</code></pre>
<p>the result is empty.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31803" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31803" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31805" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31805" href="#C31805">
                <time itemprop="dateCreated" datetime="2016-03-30T23:08:03-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>some expert has to join here, but i think you need to send proper object to this, my guess is you need to call this with params like :</p>
<pre><code>{ "name": "robot name" , "type" : "metal" , year : "2222" }</code></pre>
<p>or even maybe wrapped in </p>
<pre><code>{ robot: { "name": "robot name" , "type" : "metal" , year : "2222" } }</code></pre>
<p>but i dont know someone else has to help you if i am wrong here</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31805" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31805" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/467ac459046d75497a3d3d65b14491b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a>        </span>
        <br>

        <span class="karma">3.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31809" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31809" href="#C31809">
                <time itemprop="dateCreated" datetime="2016-03-31T00:10:41-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thank you for responding :)</p>
<p>I found something interesting there:</p>
<pre><code>https://forum.phalcon.io/discussion/4162/handling-request-with-applicationjson-contenttype-header</code></pre>
<p>The problem comes from the Content Type, and when i do this:</p>
<pre><code>$app-&gt;request-&gt;getRawBody()</code></pre>
<p>Instead of this:</p>
<pre><code>$app-&gt;request-&gt;getJsonRawBody()</code></pre>
<p>I can get my result, so the problem is on the curl call:</p>
<pre><code>curl.exe -i -X POST -d '{"name":"C-3PO","type":"droid","year":1977}'    http://localhost/test/api/robots</code></pre>
<p>I will try to find a way to modify the Content Type, the tutorial need to be updated, do you know who to contact in this kind of situation?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31809" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31809" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/467ac459046d75497a3d3d65b14491b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6637/CedricArnouldEM6" class="user-moderator-N"><span itemprop="name">CedricArnouldEM6</span></a>        </span>
        <br>

        <span class="karma">3.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="31811" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '16</span>
              </span><br/><a name="C31811" href="#C31811">
                <time itemprop="dateCreated" datetime="2016-03-31T00:20:34-07:00" class="action-date">Mar '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Even with :</p>
<pre><code>curl.exe -i -X POST -d '[{"name":"C-3PO","type":"droid","year":1977}]' -H "Content-Type: application/json"   http://localhost/test/api/robots</code></pre>
<p>Or</p>
<pre><code>curl.exe -i -X POST -d '{"name":"C-3PO","type":"droid","year":1977}' -H "Content-Type: application/json"   http://localhost/test/api/robots</code></pre>
<p>I continue to have the same problem </p>
<pre><code>$app-&gt;request-&gt;getJsonRawBody()</code></pre>
<p>Is still empty.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="31811" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="31811" data-cf-modified-7774a60f2f94ca1fc904ed53-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="10959" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>