---
layout: default
title: 'HMVC pattern - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">HMVC pattern</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a></span>
            <time itemprop="dateCreated" datetime="2013-01-24T04:17:09-07:00">Jan '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-01-24T04:17:09-07:00">Jan '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">10</span>
                </td>
                <td>
                    <label>Views</label><br>5336</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">9</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a></span>
                <span class="karma">40.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C6" href="#C6">
        <time class="action-date">Jan '13</time>
    </a>
</div>
<div class="post-content"><div><p>I would like to start discussion about HMVC pattern implementation possibility.</p>
<p>maybe this way?
<a href="https://paste.laravel.com/4MF">https://paste.laravel.com/4MF</a></p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-63f526087c110e580711ee74-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-63f526087c110e580711ee74-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">9</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/177525cf68cabf12fac5fc4c3603ecba?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/114/roman-kulish" class="user-moderator-N"><span itemprop="name">roman-kulish</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C510" href="#C510">
                <time itemprop="dateCreated" datetime="2013-03-10T19:16:55-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What's the reason for HMVC? Just checking, because the concept of &quot;reusable sub-controllers&quot; can be implemented via models in middleware tier.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="510" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="510" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C518" href="#C518">
                <time itemprop="dateCreated" datetime="2013-03-11T04:36:55-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Roman what do you mean? Any success and any example?
I just though about it and maybe it is better to stick with that phalcon offers. In the end there are classes such as \Phalcon\Mvc\User\Plugin, \Phalcon\Mvc\User\Module, \Phalcon\Mvc\User\Component
I think that it will be the base for future extensions.
After some time I did everything in Controller using plugin Class, so in View there are results what is done in Controller.</p>
<p>But please write about your solution, maybe it is very good idea worth to go?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="518" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="518" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/177525cf68cabf12fac5fc4c3603ecba?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/114/roman-kulish" class="user-moderator-N"><span itemprop="name">roman-kulish</span></a>        </span>
        <br>

        <span class="karma">5.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C525" href="#C525">
                <time itemprop="dateCreated" datetime="2013-03-12T01:09:18-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I literally meant it asking what the reason was to have HMVC in Phalcon :)</p>
<p>There is a single Model-View-Controller triad in typical MVC application which does all the work. </p>
<p>HMVC being an extension to MVC has one MVC triad at the top of the pyramid (if we imaging it as a pyramid). This triad handles main request. There are also several triads (sub-controllers in the current flow) underneath it. Main controller is able to execute sub-request to any of them and then it deals with data they return, if any. Sub-controller can be public or private: doesn't have index action or controller actions cannot be accessed in the main request. All public sub-controllers' actions CAN BE accessed in the contrast. So you can have a same controller processing requests from a visitor (as standalone component) and sub-requests from other controllers.</p>
<p>It adds great flexibility, but it should be used wisely. HMVC requires good application architecture otherwise it becomes overcomplicated, leads to unexpected failures etc. There are some architectural and usability problems in HMVC: e.g., calling protected sub-controller from public controller, handling sub-controller failures from the main controller, creating sub-controllers and delegating them some responsibilities in a proper way; complex core and requests system, need to handle main and sub-requests separately and so on. Beside this, at the end HMVC does exactly the same things as typical MVC. It just has slightly more complicated structure and different code organization.</p>
<p>In MVC all logic goes into a model. Such models all together are called middleware. They connect controller and any underlying libraries, all they simply contain some logic. </p>
<p>Just to notice: MVC model IS NOT Phalcon\Mvc\Model. Sounds like a paradox, but the latter should have been called Phalcon\Orm\Model or similar. To give you a clue, imaging a service which is built on MVC and performs data encryption. Service does not use a database. So what is a Model in this case? It's the entity which actually contains the logic to encrypt/decrypt data.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="525" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="525" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C794" href="#C794">
                <time itemprop="dateCreated" datetime="2013-04-08T15:00:31-07:00" class="action-date">Apr '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I added an initial HMVC bootstrap to the MVC examples: <a href="https://github.com/phalcon/mvc/tree/master/hmvc">https://github.com/phalcon/mvc/tree/master/hmvc</a></p>
<p>Its bootstrap registers itself as a service, the application provides a method request that allows to make HVMC requests:</p>
<pre><code class="language-php">&lt;?php

use Phalcon\Mvc\Controller;

class IndexController extends Controller
{

    public function indexAction()
    {
        var_dump($this-&gt;app-&gt;request(array(
            'controller' =&gt; 'say',
            'action' =&gt; 'hello'
        )));
    }

}</code></pre>
<p>This calls the say/hello action inside index/index, SayController::helloAction looks like this:</p>
<pre><code class="language-php">&lt;?php

use Phalcon\Mvc\Controller,
    Phalcon\Http\Response;

class SayController extends Controller
{

    public function helloAction()
    {
        return new Response('hello there');
    }

}</code></pre>
<p>It simply returns a new response that is printed in the other side of the request IndexController::indexAction, I'm pretty sure it needs some more work to support the full HTTP foundation, views, etc.</p>
<p>The HVMC request method is this: <a href="https://github.com/phalcon/mvc/blob/master/hmvc/public/index.php#L49">https://github.com/phalcon/mvc/blob/master/hmvc/public/index.php#L49</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="794" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="794" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C798" href="#C798">
                <time itemprop="dateCreated" datetime="2013-04-09T01:16:17-07:00" class="action-date">Apr '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sorry for quick response, i am in a hurry but want to say my excitement about this post.</p>
<p>It is very exciting. Thank you.
Now we have possibility to write and test tiny parts of application using url without write helper classes :)
I think that it is first step to plugin database,</p>
<p>for example in router :</p>
<pre><code class="language-php">$router-&gt;add('/mySliders', array(
        'controller' =&gt; 'slider',
        'action' =&gt; 'version1'
    ));</code></pre>
<p>and we can test <a href="https://example.com/mySliders">https://example.com/mySliders</a> in browser what is happening in output</p>
<p>after test we can use it In application like this</p>
<pre><code class="language-php">use Phalcon\Mvc\Controller;

class IndexController extends Controller
{

  public function indexAction()
  {

        $this-&gt;view-&gt;setVar('slider',
            $this-&gt;app-&gt;request(
                'controller' =&gt; 'slider',
                'action' =&gt; 'version1',
                'flag' =&gt; 'embeded' // to display without html wraping
            )
        );
  }

}
</code></pre>
<p>How this solution impact on performance of framework?</p>
<p>I am about to finishing first project in phalcon not using hmvc, but next project i would like to use it in lots of places.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="798" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="798" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C807" href="#C807">
                <time itemprop="dateCreated" datetime="2013-04-09T15:09:11-07:00" class="action-date">Apr '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think this implementation is very fast, since it doesn't implement the routing and view layers, by now, it's only capable of produce raw responses, so it's optimized to return json, xml, or one level of html, but it could be easily improved to support more things.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="807" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="807" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/812b859522c2040b766310bb83502946?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/701/erickne" class="user-moderator-N"><span itemprop="name">Erick Engelhardt</span></a>        </span>
        <br>

        <span class="karma">15.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C8507" href="#C8507">
                <time itemprop="dateCreated" datetime="2014-06-10T07:59:03-07:00" class="action-date">Jun '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I hope it's not so old. Does this request brings all the say/hello.volt content? Is there a way to get it?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="8507" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="8507" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/8b5082225d0ab9d4dc4528d9cb5a2df7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1805/helman" class="user-moderator-N"><span itemprop="name">helman</span></a>        </span>
        <br>

        <span class="karma">65</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="8615" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '14</span>
              </span><br/><a name="C8615" href="#C8615">
                <time itemprop="dateCreated" datetime="2014-06-13T07:39:41-07:00" class="action-date">Jun '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi Phalcon,</p>
<p>I got a problem rendering nested view, here is what I'm trying to do
I changed your 'request' function into an Elements module</p>
<pre><code class="language-php">namespace Modules\Main\Libraries;

/**
 * Elements
 *
 * Helps to build UI elements for the application
 */
class Elements extends \Phalcon\Mvc\User\Component
{

    public function loadModule($path = '', $data = array()) {
        $di = clone $this-&gt;getDI();
        $dispatcher = $di-&gt;get('dispatcher');

        $paths = explode('/', $path);
        $data = is_array($data) ? $data : array($data);

        // get controller name
        if (isset($paths[0])) {
            $controller = $paths[0];
        }

        // get action name
        if (isset($paths[1])) {
            $action = $paths[1];
        }

        // get params
        if (isset($paths[2])) {
            array_splice($paths, 0, 2);
            $params = array_merge($paths, $data);
        } else {
            $params = $data;
        }

        if (!empty($controller)) {
            $dispatcher-&gt;setControllerName($controller);
        } else {
            $dispatcher-&gt;setControllerName('index');
        }

        if (!empty($action)) {
            $dispatcher-&gt;setActionName($action);
        } else {
            $dispatcher-&gt;setActionName('index');
        }

        if (!empty($params)) {
            if(is_array($params)) {
                $dispatcher-&gt;setParams($params);
            } else {
                $dispatcher-&gt;setParams((array) $params);
            }
        } else {
            $dispatcher-&gt;setParams(array());
        }

        $dispatcher-&gt;dispatch();

        $response = $dispatcher-&gt;getReturnedValue();
        if ($response instanceof ResponseInterface) {
            return $response-&gt;getContent();
        }

        return $response;
    }
}</code></pre>
<p>and I have 2 controllers:</p>
<pre><code class="language-php">namespace Modules\Main\Controllers;

class IndexController extends ControllerBase
{

    public function indexAction()
    {
        $secondContent = $this-&gt;elements-&gt;loadModule('test/hello/json');

        $this-&gt;view-&gt;setVar('secondContent', $secondContent);
    }

}</code></pre>
<p>and</p>
<pre><code class="language-php">namespace Modules\Main\Controllers;

use \Phalcon\Http\Response;

class TestController extends ControllerBase
{

    public function indexAction()
    {

    }

    public function helloAction($format='html', $param = 'empty')
    {
        $this-&gt;view-&gt;setVar('content', 'Hello this is test value "'.$param.'"');

        $content = $this-&gt;view-&gt;getContent();

        return (string)$content;

        // return 'Hello this is test value "'.$param.'"';
    }

}</code></pre>
<p>my DI</p>
<pre><code class="language-php">        $di['elements'] = function() {
            return new \Modules\Main\Libraries\Elements();
        };</code></pre>
<p>Views files
IndexController::Index</p>
<pre><code class="language-php">&lt;h1&gt;Congratulations!&lt;/h1&gt;

&lt;p&gt;You're now flying with Phalcon. Great things are about to happen!&lt;/p&gt;
&lt;p&gt;Second content: {% raw %}{{{% endraw %} secondContent{% raw %}}}{% endraw %}&lt;/p&gt;
&lt;p&gt;HMVC: {% raw %}{{{% endraw %} elements.loadModule('test/hello/json', 'test') {% raw %}}}{% endraw %}&lt;/p&gt;</code></pre>
<p>and HelloController::test</p>
<pre><code class="language-php">This is :: {% raw %}{{{% endraw %} content {% raw %}}}{% endraw %}</code></pre>
<p>expecting to get
<a href="https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXNkZaU3hNcVJGWDQ/edit?usp=drivesdk">https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXNkZaU3hNcVJGWDQ/edit?usp=drivesdk</a></p>
<p>but it only rendering the HelloController:
<a href="https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXbFI5ZFROQk5Ocm8/edit?usp=drivesdk">https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXbFI5ZFROQk5Ocm8/edit?usp=drivesdk</a></p>
<p>if I change IndexController::indexAction to</p>
<pre><code class="language-php">    public function indexAction()
    {
        $secondContent = '';

        $this-&gt;view-&gt;setVar('secondContent', $secondContent);
    }</code></pre>
<p>and  TestController::helloAction to</p>
<pre><code class="language-php">    public function helloAction($format='html', $param = 'empty')
    {
        $this-&gt;view-&gt;setVar('content', 'Hello this is test value "'.$param.'"');

        $content = $this-&gt;view-&gt;getContent();

        //return (string) $content;

        return 'Hello this is test value "'.$param.'"';
    }</code></pre>
<p>the result that i get is:
<a href="https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXeDgzSzhXeTdxLW8/edit?usp=drivesdk">https://docs.google.com/a/heldes.com/file/d/0B2CEqyPg0RjXeDgzSzhXeTdxLW8/edit?usp=drivesdk</a></p>
<p>Any solution to solve this ?</p>
<p>Thanks,
Helman</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="8615" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="8615" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/2e6f5a06c4575941d2e5c867b4a42725?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/5821/elburgl69" class="user-moderator-N"><span itemprop="name">Leo van Elburg</span></a>        </span>
        <br>

        <span class="karma">133</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="28285" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '15</span>
              </span><br/><a name="C28285" href="#C28285">
                <time itemprop="dateCreated" datetime="2015-12-26T03:15:49-07:00" class="action-date">Dec '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Introcing a Widget object, that mimics the behaviour of the Phalcon/Mvc/Application class can be a solution.</p>
<p>Such a class good look like:</p>
<pre><code class="language-php">    class Widget extends Plugin{

        public function handle($uri, $viewLevel = View::LEVEL_ACTION_VIEW) {
            // create a new router, top not mess up the actual route being processed, for which this
            // widget is called.
            $router = new \Phalcon\Mvc\Router();
            $router-&gt;handle($uri);

            // clone the dispatcher, to no mess up processing of the actual route being processed.

            $dispatcher = clone $this-&gt;di-&gt;getDispatcher();       
            $dispatcher-&gt;setModuleName($router-&gt;getModuleName());
            $dispatcher-&gt;setNamespaceName($router-&gt;getNamespaceName());
            $dispatcher-&gt;setControllerName($router-&gt;getControllerName());
            $dispatcher-&gt;setActionName($router-&gt;getActionName());
            $dispatcher-&gt;setParams($router-&gt;getParams());

            $view = $this-&gt;di-&gt;getView();

            //Set the render view level, normally View::LEVEL_ACTION_VIEW but you can opt for other solution.
            $view-&gt;setRenderLevel($viewLevel);
            $view-&gt;start();

            $dispatcher-&gt;dispatch();

            $view-&gt;render($dispatcher-&gt;getControllerName(),
                      $dispatcher-&gt;getActionName(),
                      $dispatcher-&gt;getParams()
            );

            // return the content
            return $view-&gt;getContent();
        }    
    }</code></pre>
<p>Your index controller looks like:</p>
<pre><code class="language-php">    class IndexController extends ControllerBase
    {

        public function indexAction()
        {
            \\ Create the widget..
            $widget = new Widget($this-&gt;di);

            \\ Have it process the route Test/index returnin anly the action level view.
            $response = $widget-&gt;handle('/Test/index');

            \\ Set the returned contet to be included in the view of this route.
            $this-&gt;view-&gt;setVar('Sub', $response);   
        }
    }</code></pre>
<p>The TestContoller looks like:</p>
<pre><code class="language-php">    class TestController extends ControllerBase {

        public function indexAction()
        {
            $this-&gt;view-&gt;setVar('test', 'Developper');
        }
    }</code></pre>
<p>The views could be:
Index/Index:</p>
<pre><code class="language-php">    &lt;div class="page-header"&gt;
        &lt;h1&gt;Congratulations!&lt;/h1&gt;
    &lt;/div&gt;

    &lt;p&gt;You're now flying with Phalcon. Great things are about to happen!&lt;/p&gt;

    &lt;em&gt;This page is located at views/index/index.phtml&lt;/em&gt;

    &lt;p&gt; {% raw %}{{{% endraw %} Sub {% raw %}}}{% endraw %} &lt;/p&gt;</code></pre>
<p>Test/index:</p>
<pre><code class="language-php">    &lt;div class="page-header"&gt;
        &lt;h1&gt;Congratulations!&lt;/h1&gt;

        &lt;p&gt;Inserted by requesting a Controller, {% raw %}{{{% endraw %} test {% raw %}}}{% endraw %}&lt;/p&gt;

    &lt;/div&gt;</code></pre>
<p>Alternatively one could do in the index/index controller:</p>
<pre><code class="language-php">    class IndexController extends ControllerBase
    {

        public function indexAction()
        {
            \\ Create the widget..
            $widget = new Widget($this-&gt;di);

            \\ Set the returned contet to be included in the view of this route.
            $this-&gt;view-&gt;setVar('Sub', $widget);   
        }
    }</code></pre>
<p>and then call it from the view:</p>
<p>Index/Index:</p>
<pre><code class="language-php">    &lt;div class="page-header"&gt;
        &lt;h1&gt;Congratulations!&lt;/h1&gt;
    &lt;/div&gt;

    &lt;p&gt;You're now flying with Phalcon. Great things are about to happen!&lt;/p&gt;

    &lt;em&gt;This page is located at views/index/index.phtml&lt;/em&gt;

    &lt;p&gt; {% raw %}{{{% endraw %} Sub.handle('\test\index') {% raw %}}}{% endraw %} &lt;/p&gt;</code></pre>
<p>Note that this implementation ingnores any pre an post processing events that Phalcon\Mvc\Applciation would call. And cross module calls might not always work. Ideally one should implement Widget in Zephir as a copy of Mvc/Appplication, that uses a copy of the Router and Dispatcher objects on the DI, and limits the view to how it is called. But I can't get Zephir to clone objects...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28285" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28285" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/31474347cb494afc6df6be53910ca673?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2424/yankos" class="user-moderator-N"><span itemprop="name">Kostya Kufta</span></a>        </span>
        <br>

        <span class="karma">3.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28287" href="#C28287">
                <time itemprop="dateCreated" datetime="2015-12-26T06:35:43-07:00" class="action-date">Dec '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>IMHO</p>
<p>I used HMVC in Phalcon and it was not bad but no more. Now i prefer reusable View. According Padraic Brady &quot;Fat Stupid Ugly Controllers&quot;  - View know about Model and can make query - no plain SQL in View! all SQL only in Model as static function, so:</p>
<ol>
<li>i can reuse VIew</li>
<li>i have simple but powerful View cache</li>
<li>for something else i create Widget (it's just for minimize php in View,) but call him in View. Widget i create only for minimize code in view. When php code in View more 50% - time to create Widget :)</li>
<li>Controller only for control - for example validation user data or switch View - (like themes or view mode etc)</li>
<li>it's fast</li>
</ol></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28287" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28287" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/2e6f5a06c4575941d2e5c867b4a42725?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/5821/elburgl69" class="user-moderator-N"><span itemprop="name">Leo van Elburg</span></a>        </span>
        <br>

        <span class="karma">133</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C28335" href="#C28335">
                <time itemprop="dateCreated" datetime="2015-12-27T06:05:12-07:00" class="action-date">Dec '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It is true that a lot can be accomplished with reusable view(s)(parts), accessing static model methods directly. </p>
<p>But there are also many use cases in which using HMVC is preferable. For example when you want to enforcing access in a unified way with ACL, allowing front-end designers or users to determine what is shown on a page-type, etc. </p>
<p>IMHO a framework should offer both methods. Reusing views with partials and view inheritance etc has good coverage in Phalcon. </p>
<p>Let this discussion be the start of a proper implementation of the ability to execute controllers (and their related views) from a main request - controller or view.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="28335" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="28335" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/129316f5dc6e687c036f01384fd7d81c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9459/bretservilon" class="user-moderator-N"><span itemprop="name">Gian Servillon</span></a>        </span>
        <br>

        <span class="karma">3.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="48671" data-toggle="modal" data-target="#historyModal">
                edited <span>Sep '17</span>
              </span><br/><a name="C48671" href="#C48671">
                <time itemprop="dateCreated" datetime="2017-06-09T08:18:17-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hello All! I know this is a post about HMVC. But, I just want to know if you have an updated tutorial or example code (though a tutorial will be very much appreciated) on how to use HMVC in phalcon. Thank you.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48671" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48671" data-cf-modified-63f526087c110e580711ee74-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="6" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>