---
layout: default
title: 'independent routers for each module (multi app) - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/13/routing">Routing</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">independent routers for each module (multi app)</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/3978/rcmonitor" class="user-moderator-N"><span itemprop="name">rcmonitor</span></a></span>
            <time itemprop="dateCreated" datetime="2015-06-04T00:24:09-07:00">Jun '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-06-04T00:24:09-07:00">Jun '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>720</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/bd52b76de009bd54958266e91bbfd012?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/3978/rcmonitor" class="user-moderator-N"><span itemprop="name">rcmonitor</span></a></span>
                <span class="karma">2.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C6977" href="#C6977">
        <time class="action-date">Jun '15</time>
    </a>
</div>
<div class="post-content"><div><p>Is there a way to load a module based on a parameter from a uri
and then parse uri firther with separate router for each module?
I've read through tutorial and as i got it, routes / grouping allows to have only one router and
i did not find any way to make stepped desicions (first define module, than pass uri to that module and continue routing)
Am i missing something?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-1fbc327a9759101472d4e70a-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-1fbc327a9759101472d4e70a-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/939bdaa574685ccdd439b510338373c0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2605/overbid" class="user-moderator-N"><span itemprop="name">Eakkapat Pattarathamrong</span></a>        </span>
        <br>

        <span class="karma">4.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19028" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19028" href="#C19028">
                <time itemprop="dateCreated" datetime="2015-06-04T02:25:29-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Maybe <a href="http://docs.phalcon.io/en/latest/reference/micro.html#using-controllers-as-handlers">http://docs.phalcon.io/en/latest/reference/micro.html#using-controllers-as-handlers</a> or <a href="http://docs.phalcon.io/en/latest/reference/micro.html#generating-urls-for-routes">http://docs.phalcon.io/en/latest/reference/micro.html#generating-urls-for-routes</a> is your answer?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19028" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19028" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bd52b76de009bd54958266e91bbfd012?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3978/rcmonitor" class="user-moderator-N"><span itemprop="name">rcmonitor</span></a>        </span>
        <br>

        <span class="karma">2.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19029" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19029" href="#C19029">
                <time itemprop="dateCreated" datetime="2015-06-04T04:11:56-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>you mean, i should build micro application on top of my multi-mvc app?
I don't want to move routing logic into controllers...
And don't think it somehow related to generating urls...</p>
<p>Maybe, i misstell my task.
What i really want is something like ability to define which module should take care of request before loading a module:</p>
<p>index.php:</p>
<pre><code>
    $config = include __DIR__ . "/../var/config/config.php";
    include __DIR__ . "/../var/config/loader.php";
    include __DIR__ . "/../var/config/services.php";

    $di-&gt;set('router', function(){
        $oRouter = new Router();

        $oRouter-&gt;add('/api/.*', array(
            'module' =&gt; 'Api'
        ));
        $oRouter-&gt;add('/regular/.*', array(
            'module' =&gt; 'Regular'
        ));

        return $oRouter;
    });

    $application = new \Phalcon\Mvc\Application($di);

    $application-&gt;registerModules(array(
        'regular' =&gt; array(
            'className' =&gt; 'Modules\Regular\Module',
            'path' =&gt; '../app/modules/regular/Module.php',
        ),
        'api' =&gt; array(
            'className' =&gt; 'Modules\Api\Module',
            'path' =&gt; '../app/modules/api/Module.php',
        ),
    ));

    echo $application-&gt;handle()-&gt;getContent();
</code></pre>
<p>...comments in code seemed to brake all the markdown, so i get rid of it.</p>
<p>And than somehow add concrete routes in Module.php of corresponding module</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19029" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19029" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/939bdaa574685ccdd439b510338373c0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2605/overbid" class="user-moderator-N"><span itemprop="name">Eakkapat Pattarathamrong</span></a>        </span>
        <br>

        <span class="karma">4.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19034" href="#C19034">
                <time itemprop="dateCreated" datetime="2015-06-04T07:05:30-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think you mean event manager. The code is like</p>
<pre><code class="language-php">    /*
     * Event Manager
     */
    //Create a events manager
    $eventManager = new Phalcon\Events\Manager();
    //Listen all the application events
    $eventManager-&gt;attach('micro:afterExecuteRoute', new HeaderListener());

    /*
     * Handle the request
     */
    $app = new Phalcon\Mvc\Micro();
    // Bind the events manager to the app
    $app-&gt;setEventsManager($eventManager);</code></pre>
<p>and</p>
<pre><code class="language-php">/**
 * Authentication API
 */
class AuthenticationListener
{

    public function beforeExecuteRoute($event, $app)
    {
        if (!PASS) return false;
    }

}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19034" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19034" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e984ca5d22935b577e77fcbb53edb3e2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1653/stefanchiriac" class="user-moderator-N"><span itemprop="name">Stefan Chiriac</span></a>        </span>
        <br>

        <span class="karma">16.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19035" href="#C19035">
                <time itemprop="dateCreated" datetime="2015-06-04T07:08:15-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>A dinamic solution to match module, controller, action, params. Is this what you need?</p>
<pre><code>$router-&gt;add('/:module/:controller/:action/:params', array(
            'module' =&gt; 1,
            'controller' =&gt; 2,
            'action' =&gt; 3,
            'params' =&gt; 4
));</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19035" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19035" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bd52b76de009bd54958266e91bbfd012?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3978/rcmonitor" class="user-moderator-N"><span itemprop="name">rcmonitor</span></a>        </span>
        <br>

        <span class="karma">2.4k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C19035"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e984ca5d22935b577e77fcbb53edb3e2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Stefan Chiriac                    </a>
                </div><div class="posts-buttons" align="right"><a name="C19037" href="#C19037">
                <time itemprop="dateCreated" datetime="2015-06-04T09:10:45-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>A dinamic solution to match module, controller, action, params. Is this what you need?</p>
<p>$router-&gt;add('/:module/:controller/:action/:params', array(
'module' =&gt; 1,
'controller' =&gt; 2,
'action' =&gt; 3,
'params' =&gt; 4
));</p>
</blockquote>
<p>Nope, this is a sample code from tutorial, i've already saw it.
It does not fits me as soon as it is actually not as dynamic as one may suppose.</p>
<p>First, it bounds concrete URI patterns to a concrete set of actions within module.
So, i have to organize each module in the same way... and where is the 'module' thing if they are similar?</p>
<p>Second, i should write all these routes in one place, seemingly, before instantiation of an application.
And it turns out, that my application is aware of what is going on in modules, which is wrong.</p>
<p>Third, coming after the second, module got no control of itself, and there is no possibillity to divide module's logic and keep it separate.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19037" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19037" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bd52b76de009bd54958266e91bbfd012?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3978/rcmonitor" class="user-moderator-N"><span itemprop="name">rcmonitor</span></a>        </span>
        <br>

        <span class="karma">2.4k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C19034"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/939bdaa574685ccdd439b510338373c0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Eakkapat Pattarathamrong                    </a>
                </div><div class="posts-buttons" align="right"><a name="C19038" href="#C19038">
                <time itemprop="dateCreated" datetime="2015-06-04T09:20:25-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>I think you mean event manager. The code is like</p>
<pre><code class="language-php">   /*
    * Event Manager
    */
   //Create a events manager
   $eventManager = new Phalcon\Events\Manager();
   //Listen all the application events
   $eventManager-&gt;attach('micro:afterExecuteRoute', new HeaderListener());

   /*
    * Handle the request
    */
   $app = new Phalcon\Mvc\Micro();
   // Bind the events manager to the app
   $app-&gt;setEventsManager($eventManager);</code></pre>
<p>and</p>
<pre><code class="language-php">/**
* Authentication API
*/
class AuthenticationListener
{

   public function beforeExecuteRoute($event, $app)
   {
      if (!PASS) return false;
   }

}</code></pre>
</blockquote>
<p>I feel like you're telling me about some feature i may make use of.
But i just can't understand how to incorporate your suggestion of micro-mvc into my multi-mvc app..
...d'oh.
Seemes, like i should mount required module on beforeExecuteRoute, and define module routes in it.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19038" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19038" data-cf-modified-1fbc327a9759101472d4e70a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="6977" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>