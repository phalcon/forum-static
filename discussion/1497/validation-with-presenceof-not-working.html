---
layout: default
title: 'Validation with PresenceOf not working - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/18/escaping-filtering">Escaping/Filtering</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Validation with PresenceOf not working</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/816/schogetten" class="user-moderator-N"><span itemprop="name">Marc Trösken</span></a></span>
            <time itemprop="dateCreated" datetime="2014-01-25T08:26:44-07:00">Jan '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-01-25T08:26:44-07:00">Jan '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Mar '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>2079</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/00190e1d6c8cacee1c9d1268d3f05c29?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/816/schogetten" class="user-moderator-N"><span itemprop="name">Marc Trösken</span></a></span>
                <span class="karma">6.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1497" href="#C1497">
        <time class="action-date">Jan '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hi there,</p>
<p>I'm trying to validate some data before writing it into my db ! I post my data with jquery´s post method to my controller.
In the controller I am building a new instance of customer = new Customer &lt;-- the name of my table and class !</p>
<p>In my Customer class I do :</p>
<pre><code class="language-php">use \Phalcon\Mvc\Model\Validator;
...bla bla bla
public function validation()
    {
        $this-&gt;validate(new Validator\PresenceOf([
            'field' =&gt; 'last_name',
            'message' =&gt; 'And here my own message thing'
        ]));
   }</code></pre>
<p>and that is doing nothing ! The default validation is happening, but without my own messages. If i try the same with &quot;Validator\Email&quot; it works fine. What i´m doing wrong  ?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/00190e1d6c8cacee1c9d1268d3f05c29?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/816/schogetten" class="user-moderator-N"><span itemprop="name">Marc Trösken</span></a>        </span>
        <br>

        <span class="karma">6.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5252" href="#C5252">
                <time itemprop="dateCreated" datetime="2014-01-25T08:57:22-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok i figured out that if i set the &quot;field&quot; can be NULL in my table the validation works ?!?! Could anyone explain that to me ?? Or is there a way to manipulate the &quot;original&quot; validation message if the field can not be NULL ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5252" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5252" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fcae2565ce4d1ed7240231932dec115a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/659/oleg578" class="user-moderator-N"><span itemprop="name">Oleg</span></a>        </span>
        <br>

        <span class="karma">8.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5256" href="#C5256">
                <time itemprop="dateCreated" datetime="2014-01-25T11:39:09-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>See about <a href="https://docs.phalcon.io/en/latest/reference/models.html#public-properties-vs-setters-getters">https://docs.phalcon.io/en/latest/reference/models.html#public-properties-vs-setters-getters</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5256" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5256" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1ab4bab2c0d8e599811f011098a11733?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1338/ug19" class="user-moderator-N"><span itemprop="name">ug19</span></a>        </span>
        <br>

        <span class="karma">2.6k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C7170" href="#C7170">
                <time itemprop="dateCreated" datetime="2014-04-13T15:14:51-07:00" class="action-date">Apr '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Sorry for digging up the topic. </p>
<p><a href="https://forum.phalcon.io/user/0/Marc">@Marc</a> Trosekn: </p>
<p>The solution to your problem is to use <strong>initialize()</strong> method in your model with a setup array:</p>
<pre><code class="language-php">class Customers extends \Phalcon\Mvc\Model {

  public function initialize(){

    $this-&gt;setup(
        array('notNullValidations'=&gt;false)
    );

  }

}</code></pre>
<p>This way the Phalcon will NOT perform a standard PresenceOf validation which have these user-unfriendly default message &quot;XXX is required&quot;. Instead Phalcon WILL perform your own PresenceOf validation with your own message. But you need to define it as you do.</p>
<p>Another way to do this is: </p>
<pre><code class="language-php">\Phalcon\Mvc\Model::setup(array(    
    'notNullValidations' =&gt; false
));</code></pre>
<p>The second option will take affect to all models - as I understand it - I've just found the solution, have the same problem and ware digging...</p>
<p>It's described here:</p>
<ul>
<li><a href="https://forum.phalcon.io/discussion/283/created-at-and-validation">https://forum.phalcon.io/discussion/283/created-at-and-validation</a></li>
<li><a href="https://docs.phalcon.io/en/latest/reference/models.html#disabling-enabling-features">https://docs.phalcon.io/en/latest/reference/models.html#disabling-enabling-features</a></li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7170" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7170" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5aaa2387a68da49281663592022a9e4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3495/BeOleg" class="user-moderator-N"><span itemprop="name">Oleg Belousov</span></a>        </span>
        <br>

        <span class="karma">65</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="16662" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '15</span>
              </span><br/><a name="C16662" href="#C16662">
                <time itemprop="dateCreated" datetime="2015-03-18T03:33:23-07:00" class="action-date">Mar '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>We are using the propel ORM along with the phalcon framework and are facing the same issue.
This solution is not relevant to us since we do not have phalcon ORM classes.</p>
<p><em>Some additional info</em></p>
<p>Code:</p>
<pre><code>&lt;?php
namespace Modules\Frontend\Forms\Application;

use Library\Form\BaseForm;
use Phalcon\Forms\Element\Submit;
use Phalcon\Forms\Element\TextArea;
use Phalcon\Validation\Validator\PresenceOf;
use Phalcon\Validation\Validator\StringLength;

class ApplicationMessageForm extends BaseForm
{
    const TARGET_METHOD = 'POST';

    const MESSAGE = 'message';

    /**
     *
     * @return array|void
     */
    public function initialize()
    {
        if($this-&gt;getUserOptions() &amp;&amp; isset($this-&gt;getUserOptions()['target_action'])) {
            $this-&gt;setAction($this-&gt;getDI()-&gt;get('url')-&gt;get($this-&gt;getUserOptions()['target_action']));
        }
        // email field
        $attributes = ['rows' =&gt; 6];
        $messageField = new TextArea(self::MESSAGE, $attributes);
        //$messageField-&gt;setLabel(48'label.' . self::MESSAGE));
        $messageField-&gt;addValidators(
            array(
                new PresenceOf(array("message" =&gt; $this-&gt;t('please.enter.a.message'), "cancelOnFail" =&gt; true)),
                new StringLength(array(
                        'max' =&gt; 50,
                        'min' =&gt; 5,
                        'messageMaximum' =&gt; 'We don\'t like really long names',
                        'messageMinimum' =&gt; 'We want more than just their initials'
                    )
                )
            )
        );

        $messageField-&gt;setFilters(array("trim"));
        $this-&gt;add($messageField);

        // submit field
        $this-&gt;add(
            new Submit(
                "submit", array(
                    "value" =&gt; "Send",
                    "class" =&gt; "btn btn-info pull-right everjobs-btn"
                )
            )
        );
    }

}
</code></pre>
<p><em>SQL data looks as following:</em></p>
<pre><code>+------------------------+---------+--------------------+-----------------------------+---------------------+---------------------+
| id_application_message | fk_user | fk_job_application | text                        | created_at          | updated_at          |
+------------------------+---------+--------------------+-----------------------------+---------------------+---------------------+
|                      1 |   41671 |                  1 | lorem ipusum                | 2015-03-17 10:06:19 | 2015-03-17 10:06:19 |
|                      2 |   41671 |                  2 | dev                         | 2015-03-17 10:52:31 | 2015-03-17 10:52:31 |
|                      3 |   41673 |                  2 | lorem ipusum toler del amon | 2015-03-17 11:37:47 | 2015-03-17 11:37:47 |
|                      4 |   41673 |                  2 |                             | 2015-03-17 20:03:03 | 2015-03-17 20:03:03 |
|                      5 |   41673 |                  2 |                             | 2015-03-17 20:03:07 | 2015-03-17 20:03:07 |
|                      6 |   41673 |                  2 |                             | 2015-03-17 20:30:38 | 2015-03-17 20:30:38 |
|                      7 |   41673 |                  2 |                             | 2015-03-17 21:10:36 | 2015-03-17 21:10:36 |
|                      8 |   41673 |                  2 |                             | 2015-03-17 21:10:37 | 2015-03-17 21:10:37 |
|                      9 |   41673 |                  2 |                             | 2015-03-18 09:36:33 | 2015-03-18 09:36:33 |
|                     10 |   41671 |                  2 | thanks                      | 2015-03-18 09:43:54 | 2015-03-18 09:43:54 |
|                     11 |   41673 |                  2 |                             | 2015-03-18 10:09:56 | 2015-03-18 10:09:56 |
|                     12 |   41673 |                  2 |                             | 2015-03-18 10:40:46 | 2015-03-18 10:40:46 |
|                     13 |   41673 |                  2 | fdsfdsfds                   | 2015-03-18 10:41:08 | 2015-03-18 10:41:08 |
|                     14 |   41673 |                  2 | fdsfds                      | 2015-03-18 10:41:19 | 2015-03-18 10:41:19 |
|                     15 |   41673 |                  2 | fd                          | 2015-03-18 10:55:37 | 2015-03-18 10:55:37 |
|                     16 |   41673 |                  2 |                             | 2015-03-18 11:00:19 | 2015-03-18 11:00:19 |
|                     17 |   41673 |                  2 |                             | 2015-03-18 11:16:50 | 2015-03-18 11:16:50 |
+------------------------+---------+--------------------+-----------------------------+---------------------+---------------------+</code></pre>
<p>e.g empty strings and not NULL</p>
<p>Thanks!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="16662" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="16662" data-cf-modified-7dd4a0523cb3b23fdff88e08-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1497" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>