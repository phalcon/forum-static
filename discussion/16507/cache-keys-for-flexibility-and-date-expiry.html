---
layout: default
title: 'Cache keys for flexibility and date expiry - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/8/cache">Cache</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Cache keys for flexibility and date expiry</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a></span>
            <time itemprop="dateCreated" datetime="2017-07-10T19:10:53-07:00">Jul '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-07-10T19:10:53-07:00">Jul '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">1</span>
                </td>
                <td>
                    <label>Views</label><br>504</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a></span>
                <span class="karma">9.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C16507" href="#C16507">
        <time class="action-date">Jul '17</time>
    </a>
</div>
<div class="post-content"><div><p>Looking to use file cach now and switch to something else later. How do you build a key to handle anything you can use in a file directory and be compativle with other caches?</p>
<p>My data comes from files like /abc/xyz.zip and /a/b/c/xy.z.bzip2. I need to cache some of te archive contents. If I use - to replace /, I would have cache keys like the following.
abc-xyz-content_part_1.txt
abc-xyz-content_part_2.txt
a-b-c-xy-z-content_part_1.txt
a-b-c-xy-z-content_part_2.txt</p>
<p>With something like this, the expanded - based key could overlap with a valid file name from another directory. I might use a double dash, --, for the directory separators. Does this sound reasonable? Would it be incompatible with any of the cache backends?</p>
<p>I see there was an issue raised back in 2013 to make cache handle subdirectories. That will simplify the file backend, so long as it is compatible with other backends.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-1b55dc2077c094dea105289c-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-1b55dc2077c094dea105289c-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="49455" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '17</span>
              </span><br/><a name="C49455" href="#C49455">
                <time itemprop="dateCreated" datetime="2017-07-10T19:49:02-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>One other question. Can cache handle the date checking for the source? When the source is updated, do I have to perform my own date/time check and invalidate the cache?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49455" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49455" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b59fecbff6d1afabf8da316028330df4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2619/emiliodeg" class="user-moderator-N"><span itemprop="name">Emilio Degiovanni</span></a>        </span>
        <br>

        <span class="karma">32.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49477" href="#C49477">
                <time itemprop="dateCreated" datetime="2017-07-11T15:08:11-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi<a href="https://forum.phalcon.io/user/0/peter"> @peter</a> </p>
<p>Q1: if you have a file cache and that not have a lot of files you can use a only one directory. But if you have thousands is better use nested directories to improve performance on accesing .</p>
<p>Q2: no, you have to delete the cache, then when some request need the system create a new cache. For example in a model you can add an behavior to delete the cache on update/delete</p>
<p>Good luck</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49477" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49477" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49479" href="#C49479">
                <time itemprop="dateCreated" datetime="2017-07-11T17:48:59-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>i found a bit about nested directories in the cache documentation. That may be needed in the future. Currently I replace / with --. I prefer something that can be used on memcache and other backends unchanged. Do other cache backends have the equivalent structure?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49479" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49479" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49499" href="#C49499">
                <time itemprop="dateCreated" datetime="2017-07-12T18:53:06-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Using the file backend with the None frontend. Fast. None lets you store images with no interference. The source of the files includes severl formats. They all go in the cache then code decides where the files will be long term.</p>
<p>I tested the default frontend shown in the documentation. That converts everything to serialized string. You store an image then browse the cache directory but cannot look at the image. Doh! The None frontend removes that problem and overhead.</p>
<p>From what I can see, the cache expiry leaves files in the cache. The lifetime supplied to the cache only changes the files retreived by cache-&gt;get. You have to do something else to remove the files. I guess a cron job could sweep the directory clean.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49499" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49499" data-cf-modified-1b55dc2077c094dea105289c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="16507" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>