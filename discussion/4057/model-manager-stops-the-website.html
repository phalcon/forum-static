---
layout: default
title: 'model manager stops the website - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">model manager stops the website</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2274/fjobeir" class="user-moderator-N"><span itemprop="name">Feras Jobeir</span></a></span>
            <time itemprop="dateCreated" datetime="2014-11-23T15:32:09-07:00">Nov '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-11-23T15:32:09-07:00">Nov '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Nov '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>551</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/3458ba0bdf55043431b52e87be3d6d4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2274/fjobeir" class="user-moderator-N"><span itemprop="name">Feras Jobeir</span></a></span>
                <span class="karma">3.9k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C4057" href="#C4057">
        <time class="action-date">Nov '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hello frieds :)</p>
<p>when I call this code, the website does not work and blank page appear:</p>
<p>$settings = array();</p>
<blockquote>
<pre><code>    $manager = $this-&gt;modelsManager;
    $globalSettings = $manager-&gt;executeQuery('SELECT * FROM settings');
    foreach ($globalSettings as $settingsData) {
        $settings[] = array(
            'initial_balance' =&gt; $settingsData-&gt;initial_balance,
            'site_mail' =&gt; $settingsData-&gt;site_mail
        );</code></pre>
<p>}</p>
</blockquote>
<p>what could be a problem?</p>
<p>thank you :)</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b078a71444f6c4c09a3bcab3992c3a34?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2357/viralj" class="user-moderator-N"><span itemprop="name">Viral Joshi</span></a>        </span>
        <br>

        <span class="karma">10.1k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13548" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13548" href="#C13548">
                <time itemprop="dateCreated" datetime="2014-11-23T17:50:05-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Do you have error 404 page set up in your web app? I believe that it is showing you that error page. Because I had same problem with my app. You are trying to use this query for PDO option and other stuff. As far I know, this is not <a href="http://docs.phalcon.io/en/latest/reference/phql.html">PHQL</a>. And to access this <strong>modelManager</strong>, you will need few more lines of codes in DI services. I couldn't figure out this problem and I had same question that I asked <a href="http://forum.phalcon.io/discussion/4043/phql-is-showing-error-404-page">here</a>. So, try to read everything there and solution that <em>Phalcon</em> user, (one of the developers) gave me. But still, I suggest you to use your code like below if your these codes are in controller. (and you will need something to select row from table)</p>
<pre><code>// Get and print global setttings to print details
$globalSettings  = Settings::find(array(
    "initial_balance  &lt; '300'"
));
foreach ($globalSettings  as $settingsData) {
    $settings[] = array(
      'initial_balance' =&gt; $settingsData-&gt;initial_balance,
      'site_mail' =&gt; $settingsData-&gt;site_mail
  );
}</code></pre>
<p>So it means, you are trying to find a row where initial balance is lower then 300 and it will fetch all data from that row. Its not perfect way because there might be more then one row in your database so you can do like </p>
<pre><code>  "initial_balance  &lt; '300'",
  "username = 'myName'"</code></pre>
<p>in your PHQL so you will get accutrate result. Try this. If it doesn't work, let me know. ;) Enjoy your codes.</p>
<p>And also add this codes in your services file at located <strong>config/services.php</strong>.</p>
<pre><code>//trying to display error pages
$di-&gt;set('dispatcher', function() {

$eventsManager = new \Phalcon\Events\Manager();

$eventsManager-&gt;attach("dispatch:beforeException", function($event, $dispatcher, $exception) {

        //Handle 404 exceptions
        if ($exception instanceof \Phalcon\Mvc\Dispatcher\Exception) {
            $dispatcher-&gt;forward(array(
                'controller' =&gt; 'error',
                'action' =&gt; 'show404'
            ));
            return false;
        }

        //Handle other exceptions
        $dispatcher-&gt;forward(array(
            'controller' =&gt; 'error',
            'action' =&gt; 'show503'
        ));

        return false;
    });

    $dispatcher = new \Phalcon\Mvc\Dispatcher();

    //Bind the EventsManager to the dispatcher
    $dispatcher-&gt;setEventsManager($eventsManager);

    return $dispatcher;

}, true);</code></pre>
<p>It will help you to show error pages like 404 and 503 etc. Create error class and a method to show 404 error page. ;)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13548" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13548" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/3458ba0bdf55043431b52e87be3d6d4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2274/fjobeir" class="user-moderator-N"><span itemprop="name">Feras Jobeir</span></a>        </span>
        <br>

        <span class="karma">3.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13588" href="#C13588">
                <time itemprop="dateCreated" datetime="2014-11-24T08:40:38-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Just like a magic (y)
Thank you very much Viral Joshi, by the way, my default code works on Windows, but I had to edit it according to your replay in order to work also on Linux</p>
<p>Thank you again :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13588" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13588" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b078a71444f6c4c09a3bcab3992c3a34?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2357/viralj" class="user-moderator-N"><span itemprop="name">Viral Joshi</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13594" href="#C13594">
                <time itemprop="dateCreated" datetime="2014-11-24T10:11:24-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Your welcome Feras Jobeir.... ;) As I said, enjoy your codes... :D :D I do enjoy mine. ( <strong>Somehow, they are working. :P</strong> )</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13594" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13594" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b078a71444f6c4c09a3bcab3992c3a34?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2357/viralj" class="user-moderator-N"><span itemprop="name">Viral Joshi</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13595" href="#C13595">
                <time itemprop="dateCreated" datetime="2014-11-24T10:11:25-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Your welcome Feras Jobeir.... ;) As I said, enjoy your codes... :D :D I do enjoy mine. ( <strong>Somehow, they are working. :P</strong> )</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13595" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13595" data-cf-modified-45fd5fe73dcb96bcab22e6b4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="4057" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>