---
layout: default
title: 'How to integrate of PHPUnit and phalcon framework? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">How to integrate of PHPUnit and phalcon framework?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/139/sharklet" class="user-moderator-N"><span itemprop="name">sharklet</span></a></span>
            <time itemprop="dateCreated" datetime="2013-06-18T21:20:53-07:00">Jun '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-06-18T21:20:53-07:00">Jun '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>1475</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/2dff5faa3f6e2cd71545236676dd369d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/139/sharklet" class="user-moderator-N"><span itemprop="name">sharklet</span></a></span>
                <span class="karma">12.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C456" href="#C456">
        <time class="action-date">Jun '13</time>
    </a>
</div>
<div class="post-content"><div><p>Such as the title.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-07f478f6992c2a2a68862729-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-07f478f6992c2a2a68862729-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C1889" href="#C1889">
                <time itemprop="dateCreated" datetime="2013-06-19T08:16:37-07:00" class="action-date">Jun '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Have a look here:</p>
<p><a href="https://github.com/phalcon/cphalcon/tree/master/php-tests">https://github.com/phalcon/cphalcon/tree/master/php-tests</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="1889" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="1889" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d3270a9fe89f3cfdd763a416c294dd57?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/253/Plaputta" class="user-moderator-N"><span itemprop="name">Plaputta</span></a>        </span>
        <br>

        <span class="karma">6.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2438" href="#C2438">
                <time itemprop="dateCreated" datetime="2013-07-15T08:09:57-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I struggled a bit trying to set up a simple &quot;set uri to /, do the same as the normal application would do and check if the response equal&quot; application, because I just set the $_SERVER['REQUEST_URI'] and not $_SERVER['REQUEST_METHOD'] - may be worth mentioning :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2438" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2438" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/034f62d4d9c606bf48823edfd1ce187b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/864/aledelgo" class="user-moderator-N"><span itemprop="name">Alessandro Del Gobbo</span></a>        </span>
        <br>

        <span class="karma">17.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5162" href="#C5162">
                <time itemprop="dateCreated" datetime="2014-01-18T13:09:45-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Plaputta, could you post some code?
I'm a bit in trouble in testing my MVC phalcon based app...</p>
<p>If in my action i don't return nothing leaving phalcon choosing and rendering the View, how could i test the response in PhpUnit?</p>
<p>I've go the idea of create a new Application in each test method and execute $application-&gt;handle(&quot;controller/action&quot;) to get the response object and make assertion on it... and it works great but it works only once...
I mean that if i have multiple test method that do the same thing, i get unpredictable result as it seems that the <code>php response</code> object get cached for a controller.
Example, if i have a controller with action1 and have 3 test method (test1 test2 and test3)  that try to execute action1, test1 run correctly, but test2 has unexpected results because the response he get from action1 contains the same data returned previously to test1...</p>
<p>Is there any best practice on consistently unit-test Phalcon MVC apps with phpunit (without using selenium)?</p>
<p>Thanks</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5162" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5162" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e1ea6dd91fb1ca75a6d77cf0fae89e5f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/522/nexik" class="user-moderator-N"><span itemprop="name">Tomasz Ślązok</span></a>        </span>
        <br>

        <span class="karma">7.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5180" href="#C5180">
                <time itemprop="dateCreated" datetime="2014-01-18T16:23:02-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I use codeception. UnitTesting is so simple.
You only must prepare autoloader for you code in bootstrap
You can also use Phalcon module to codeception
I personaly use acceptance test with selenium. Very easy to write from codeception.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5180" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5180" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/034f62d4d9c606bf48823edfd1ce187b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/864/aledelgo" class="user-moderator-N"><span itemprop="name">Alessandro Del Gobbo</span></a>        </span>
        <br>

        <span class="karma">17.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5211" href="#C5211">
                <time itemprop="dateCreated" datetime="2014-01-20T01:40:12-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for the advice!
I already promised to give a look to codeception/selenium when i had to make acceptance tests of the frontend part of my app.
Actually i'm using an MVC phalcon app to make Web API so i thought i could use simply unit-test on that Actions.</p>
<p>Reading your post pushed me to give a look to codeception in advance, and its documentation taken me again on the earh as also codeception says that 'functional tests' may cause a lot of trouble with service that require shared services or sessions/cookies/... etc. because all test methods are called in the same context... so there is no real enviroinment reset for each test call.
The most quick solution  maybe to use acceptance tests for Web API too (it's an MVC app afterall)...
The other not too beautiful solution may be to  check in my controllers if it is running in test mode, and if it is, get a special DI container with all services mocked.</p>
<p>I think i'll go with the first. Any other suggestion appreciated.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5211" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5211" data-cf-modified-07f478f6992c2a2a68862729-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="456" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>