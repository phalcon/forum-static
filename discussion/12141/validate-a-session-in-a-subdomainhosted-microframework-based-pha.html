---
layout: default
title: 'Validate a session in a subdomain-hosted microframework based phalcon app - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/28/session">Session</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Validate a session in a subdomain-hosted microframework based phalcon app</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/7453/vandr0iy" class="user-moderator-N"><span itemprop="name">vandr0iy</span></a></span>
            <time itemprop="dateCreated" datetime="2016-07-20T01:16:44-07:00">Jul '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-07-20T01:16:44-07:00">Jul '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>435</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/847fc6cfb5c1abd4d452b39cf9167596?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/7453/vandr0iy" class="user-moderator-N"><span itemprop="name">vandr0iy</span></a></span>
                <span class="karma">1.1k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C12141" href="#C12141">
        <time class="action-date">Jul '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hi, phalconers!</p>
<p>I need some help with the design of my phalcon app. Until now I got working a simple MVC app, and now I'm writing a small microframework, since my app needs to use an internal REST API. </p>
<p>The point is that my microframework-based app needs to be used based on the ACL specivied in the MVC app (which code is largely inspired from vokuro), - some of the API needs to be public, some - private, and there are also a couple to be used only by a certain group of users.</p>
<p>How do I achieve this result? I thought about some kind of an API key based on JWT, or OAuth2.0, - but how do I integrate that in phalcon? Also, I stated that I'm separating my app in 2 concerns - MVC and REST API, but is that really the desired approach? Maybe, I could simply merge them somehow?</p>
<p>tl;dr: some paths need to show a view, some need to return only a JSON, but all need authentication and session control. How should I proceed?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-4b8310cc29d2586882e3e289-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-4b8310cc29d2586882e3e289-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="36939" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '16</span>
              </span><br/><a name="C36939" href="#C36939">
                <time itemprop="dateCreated" datetime="2016-07-20T01:59:58-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can just create rest controllers in MVC which will return just json, no need to create micro aplication and rest api. If you have already done what are you tlaking like ACL etc in mvc application then there is no reason to create same code for micro application.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36939" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36939" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/847fc6cfb5c1abd4d452b39cf9167596?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/7453/vandr0iy" class="user-moderator-N"><span itemprop="name">vandr0iy</span></a>        </span>
        <br>

        <span class="karma">1.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="36945" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '16</span>
              </span><br/><a name="C36945" href="#C36945">
                <time itemprop="dateCreated" datetime="2016-07-20T02:52:50-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Oh... I just saw <a href="https://forum.phalcon.io/discussion/22/the-best-way-for-json-response-">this</a> discussion in the forum. I just tested it, and this code:</p>
<pre><code>class SearchController extends ControllerBase
{
  public function getAction()
  {
    $this-&gt;view-&gt;disable();
    //Create a response instance
    $response = new \Phalcon\Http\Response();
    //Set the content of the response
    $response-&gt;setContent(json_encode([1, 2, 3]));
    //Set content type
    $response-&gt;setContentType('application/json', 'UTF-8');
    //Return the response
    return $response;
  }
}</code></pre>
<p>appears to be exatly what I was searching for. I added the content type part, though, - otherwise it would return the wrong one.
Thank you for your time.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36945" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36945" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="36955" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '16</span>
              </span><br/><a name="C36955" href="#C36955">
                <time itemprop="dateCreated" datetime="2016-07-20T03:38:18-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can just use:</p>
<p><a href="https://forum.phalcon.io/user/7453/vandr0iy">@vandr0iy</a></p>
<pre><code class="language-php">return $this-&gt;response-&gt;setJsonContent([1, 2, 3]);</code></pre>
<p>No reason to do such a nasty things :D Also you only need to disable view to get rid of default rendering, if you will return response object then you don't need to do it.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36955" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36955" data-cf-modified-4b8310cc29d2586882e3e289-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="12141" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>