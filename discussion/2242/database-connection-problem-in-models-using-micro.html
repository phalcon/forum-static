---
layout: default
title: 'Database connection problem in Models using Micro - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/22/micro">Micro</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Database connection problem in Models using Micro</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/1445/CheckMater" class="user-moderator-N"><span itemprop="name">Walter Pulido</span></a></span>
            <time itemprop="dateCreated" datetime="2014-05-06T10:36:35-07:00">May '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-05-06T10:36:35-07:00">May '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>998</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/8c53379b6527781429c9664d9277ed2b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/1445/CheckMater" class="user-moderator-N"><span itemprop="name">Walter Pulido</span></a></span>
                <span class="karma">12.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C2242" href="#C2242">
        <time class="action-date">May '14</time>
    </a>
</div>
<div class="post-content"><div><p>I'm creating a RESTful API in Phalcon PHP, I set the DI and the database information as always using:</p>
<p>This is how I'm configuring the database in the DI.</p>
<pre><code class="language-php">use Phalcon\Db\Adapter\Pdo\Postgresql as DbAdapter;
$di = new FactoryDefault();

$di['db'] = function() use ($config) {
return new DbAdapter(array(
            "host" =&gt; $config-&gt;database-&gt;host,
            "username" =&gt; $config-&gt;database-&gt;username,
            "password" =&gt; $config-&gt;database-&gt;password,
            "dbname" =&gt; $config-&gt;database-&gt;dbname,
            "schema" =&gt; $config-&gt;database-&gt;schema,
        ));
};</code></pre>
<p>Then setting the DI</p>
<pre><code class="language-php">$app-&gt;setDi($di);</code></pre>
<p>And I'm handling the actions like this:</p>
<pre><code class="language-php">//Gets a client information
$app-&gt;get('/client', array(new ClientController, 'getAction'));</code></pre>
<p>The problem is that when ClientController creates a new model object it simply returns an error saying that the table was not found and I think is because it is not loading the database information from the DI, so my question is, how can I set up that information globally, is it not supposed that Phalcon do it?</p>
<p>The database works fine in the main application controller, but I want to order the methods in other different subcontrollers and there is where the database config doesn't work.</p>
<p>I'm doing this as stated in the documentation:</p>
<p><a href="https://docs.phalcon.io/es/latest/reference/micro.html">https://docs.phalcon.io/es/latest/reference/micro.html</a></p>
<p>Thanks.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-362c9128a2a68fc5411872bf-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-362c9128a2a68fc5411872bf-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C7665" href="#C7665">
                <time itemprop="dateCreated" datetime="2014-05-06T12:57:26-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Please let us see how you have registred your db service in the DI</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7665" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7665" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8c53379b6527781429c9664d9277ed2b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1445/CheckMater" class="user-moderator-N"><span itemprop="name">Walter Pulido</span></a>        </span>
        <br>

        <span class="karma">12.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C7667" href="#C7667">
                <time itemprop="dateCreated" datetime="2014-05-06T13:05:03-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I updated the information in the first post, hope you understand.</p>
<p>Thanks.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7667" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7667" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="7671" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C7671" href="#C7671">
                <time itemprop="dateCreated" datetime="2014-05-06T13:35:13-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>db config looks okay,
also you said that db access is working fine with another controller (&lt;=&gt; your config file is correct) , so maybe in your ClientController -&gt; getAction you call a specific model (saying ClientModel wich is different from the one you call in MainController).
Perhaps setting the source in your ClientModel will help (because phalcon complains that it is not finding the table):</p>
<pre><code class="language-php">public function getSource()
    {
        return "the_robots";
    }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7671" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7671" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8c53379b6527781429c9664d9277ed2b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1445/CheckMater" class="user-moderator-N"><span itemprop="name">Walter Pulido</span></a>        </span>
        <br>

        <span class="karma">12.8k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C7732" href="#C7732">
                <time itemprop="dateCreated" datetime="2014-05-08T17:51:30-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I discovered that is getting the DI and the problem now is that the Database adapter is not using the schema I set up when creating the adapter, I opened another discussion here, also I'm having this problem frequently with PostgreSQL.</p>
<p><a href="https://forum.phalcon.io/discussion/2251/database-adapter-not-setting-schemas-using-postgresql">https://forum.phalcon.io/discussion/2251/database-adapter-not-setting-schemas-using-postgresql</a></p>
<p>Greetings!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7732" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7732" data-cf-modified-362c9128a2a68fc5411872bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="2242" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>