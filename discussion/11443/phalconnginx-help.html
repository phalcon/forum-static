---
layout: default
title: 'Phalcon/Nginx help - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/26/http-environment">HTTP Environment</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon/Nginx help</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/6931/ias2" class="user-moderator-N"><span itemprop="name">ias2</span></a></span>
            <time itemprop="dateCreated" datetime="2016-05-06T05:21:40-07:00">May '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-05-06T05:21:40-07:00">May '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>521</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/c142771b9356d18dfb6625f32c336682?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/6931/ias2" class="user-moderator-N"><span itemprop="name">ias2</span></a></span>
                <span class="karma">1.5k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11443" href="#C11443">
        <time class="action-date">May '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hi, i would enable some folders under the nginx webroot tree to using phalcon, leaving the others with the &quot;simple&quot;php support.
For example, under &quot;mynginxserver.intranet&quot;, I have a folders structure like this:</p>
<pre><code>nginx_document_root
|
+---- normal_php_application_1
|       |
|       +---- "some files &amp; folders"
|
+---- phalcon_enabled_application
|       |
|       +---- "phalcon folders structure"
|
+---- normal_php_application_2
        |
        +---- "some files &amp; folders"</code></pre>
<p>so, I can refer to the applications with these urls:</p>
<pre><code>https://mynginxserver.intranet/normal_php_application_1
https://mynginxserver.intranet/phalcon_enabled_application
https://mynginxserver.intranet/normal_php_application_2</code></pre>
<p>With apache, this is quite simple to accomplish, but with ngix I cannot figure how to make the right configuration. This is mainly due to my low nginx configuration skills...
Using the examples given in the phalcon documentation, I can enable ALL folders to use phalcon, but my attemps fails in achieving a behavior like the one described above... can anyone help me with this task? Thanks.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-76c692e3fb520b9ede5efa76-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-76c692e3fb520b9ede5efa76-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33667" href="#C33667">
                <time itemprop="dateCreated" datetime="2016-05-06T05:52:34-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You need to create 2 pools in php-fpm - one which will have phalcon enabled and second which will don't. Nginx is only webserver, it doesn't have anything to do with php.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33667" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33667" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/c142771b9356d18dfb6625f32c336682?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/6931/ias2" class="user-moderator-N"><span itemprop="name">ias2</span></a>        </span>
        <br>

        <span class="karma">1.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33709" href="#C33709">
                <time itemprop="dateCreated" datetime="2016-05-07T04:37:14-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>php-fpm isn't the right piece to move to solve this puzzle. The goal is to force ngix to route the requests through public/index.php only for <strong>phalcon_enabled_application</strong> and serve <strong>normal_php_application_1</strong> and <strong>normal_php_application_2</strong> as usual. To acheive this, nginx must be configured properly. After a number of attempts, configuring the rewrite for the phalcon_enabled_application location with this command:</p>
<pre><code>rewrite ^/phalcon_enabled_application/(.*)$ /phalcon_enabled_application/public/index.php?_url=/$1;</code></pre>
<p>I can obtain the desidered behavior... more or less. With this kind of rewrite, all the request (even images, css files or javascript snippets), goes through public/index.php... any suggestion for solve this?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33709" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33709" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33721" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33721" href="#C33721">
                <time itemprop="dateCreated" datetime="2016-05-07T16:41:14-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Why don't you just map your 3 apps to a different nginx vhost sites? It would be much cleaner.
The other way around would be to define location blocks in nginx, all three in one server config file.</p>
<pre><code>location /normal_php_application_1{
root /usr/share/nginx/normal_php_application_1
#other directives...
}

location /normal_php_application_2{
root /usr/share/nginx/normal_php_application_2
#other directives...
}

location /phalcon_enabled_application{
root /usr/share/nginx/phalcon_enabled_application
#other directives...
}</code></pre>
<p>And for serving static content, you need to tell nginx to handle it:</p>
<pre><code>location / {
    try_files $uri $uri/ /index.php$is_args$query_string;
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33721" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33721" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33729" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33729" href="#C33729">
                <time itemprop="dateCreated" datetime="2016-05-08T02:52:40-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>But there be still access to phalcon all of those locations/roots. You must use php-fpm, also create seperated instances of it(beacause as i checked there is no way to set extensions for pools).</p>
<p>If you want other thing - that in <code>normal_php_application_1</code> and <code>_2</code> you can just access any php file they just should look like above, but if you want in phalcon to use index.php as front controller for all addresses then you need to add in <code>phalcon_enabled_application</code>:</p>
<pre><code>try_files $uri $uri/ /index.php$is_args$query_string;</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33729" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33729" data-cf-modified-76c692e3fb520b9ede5efa76-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11443" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>