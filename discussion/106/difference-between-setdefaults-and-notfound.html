---
layout: default
title: 'Difference between setDefaults and notFound - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/13/routing">Routing</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Difference between setDefaults and notFound</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/92/Agent-J" class="user-moderator-N"><span itemprop="name">Eugene</span></a></span>
            <time itemprop="dateCreated" datetime="2013-03-07T02:18:31-07:00">Mar '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-03-07T02:18:31-07:00">Mar '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Sep '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>4600</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">5</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/1492c8da3d88198c0361def89bd8c94a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/92/Agent-J" class="user-moderator-N"><span itemprop="name">Eugene</span></a></span>
                <span class="karma">29.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C106" href="#C106">
        <time class="action-date">Mar '13</time>
    </a>
</div>
<div class="post-content"><div><p>What is the difference between Phalcon\Mvc\Router::setDefaults() and Phalcon\Mvc\Router::notFound()?
Both of them sets an array of default paths the router will use if route is missing.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-f558900cb908837136701466-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-f558900cb908837136701466-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">5</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a4893b2103244c9dfdb6b83dd334d78?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/66/arantir" class="user-moderator-N"><span itemprop="name">arantir</span></a>        </span>
        <br>

        <span class="karma">32.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="432" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C432" href="#C432">
                <time itemprop="dateCreated" datetime="2013-03-07T02:45:17-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>May be this is it:
&quot;Since none route is matched the router passes empty values to the dispatcher, and the dispatcher is using the default controller/index to address the request. In 1.0.0 you can set what paths must be used if none existing route is matched:</p>
<pre><code class="language-php">$router-&gt;notFound(array('controller' =&gt; 'errors', 'action' =&gt; 'notfound404')); </code></pre>
<p><a href="https://github.com/phalcon/cphalcon/issues/446#issuecomment-14251200">https://github.com/phalcon/cphalcon/issues/446#issuecomment-14251200</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="432" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="432" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1492c8da3d88198c0361def89bd8c94a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/92/Agent-J" class="user-moderator-N"><span itemprop="name">Eugene</span></a>        </span>
        <br>

        <span class="karma">29.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="433" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C433" href="#C433">
                <time itemprop="dateCreated" datetime="2013-03-07T03:24:41-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>But there's no difference</p>
<pre><code class="language-php">$router-&gt;setDefaults(array('controller' =&gt; 'errors', 'action' =&gt; 'notfound404')); </code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="433" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="433" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/99c4e429c31ce6e1fd7b95adef882e9b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/86/johnnyajax" class="user-moderator-N"><span itemprop="name">johnnyajax</span></a>        </span>
        <br>

        <span class="karma">2.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C439" href="#C439">
                <time itemprop="dateCreated" datetime="2013-03-07T04:50:40-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think notFound make sense if framework automatically sets the correct 404 response header regardless of page content, otherwise it's pointless.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="439" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="439" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1492c8da3d88198c0361def89bd8c94a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/92/Agent-J" class="user-moderator-N"><span itemprop="name">Eugene</span></a>        </span>
        <br>

        <span class="karma">29.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C440" href="#C440">
                <time itemprop="dateCreated" datetime="2013-03-07T05:32:43-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Just checked it. Status is &quot;200 OK&quot; in both cases.
Setting the response header is left up on the developers.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="440" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="440" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C442" href="#C442">
                <time itemprop="dateCreated" datetime="2013-03-07T09:42:44-07:00" class="action-date">Mar '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The new 'not-found paths' is different to defaults. 'Defaults' is intended to fill paths that aren't defined in every route added to the router:</p>
<pre><code class="language-php">$router = new Phalcon\Mvc\Router(false);

$router-&gt;setDefaultNamespace('App\Controllers');

$router-&gt;add('/app/index', array(
    'controller' =&gt; 'index',
    'action' =&gt; 'index'
));

$router-&gt;add('/app/robots', array(
    'controller' =&gt; 'robots',
    'action' =&gt; 'index'
));</code></pre>
<p>Both routes have by default the namespace App\Controllers without explicitly set them manually. Consider the following example, where 'defaults' are used as 'not found' routes:</p>
<pre><code class="language-php">
$router = new Phalcon\Mvc\Router(false);

$router-&gt;setDefaults(array(
    'controller' =&gt; 'errors',
    'action' =&gt; 'notFound404'
));

$router-&gt;add('/index', array(
    'module' =&gt; 'frontend',
    'controller' =&gt; 'index',
));

$router-&gt;add('/admin/index', array(
    'module' =&gt; 'backend',
    'controller' =&gt; 'index'
));
</code></pre>
<p>The path 'action' is not defined because we expect to use the default 'index', but as we're using the defaults it will fill it with 'notFound404' instead of 'index', so when we access /index the paths returned by the router will be: module =&gt; frontend, 'controller' =&gt; 'index', 'action' =&gt; 'notFound404' that is wrong.</p>
<p>This is fixed using the notFound method:</p>
<pre><code class="language-php">
$router = new Phalcon\Mvc\Router(false);

$router-&gt;notFound(array(
    'controller' =&gt; 'errors',
    'action' =&gt; 'notFound404'
));

$router-&gt;add('/index', array(
    'module' =&gt; 'frontend',
    'controller' =&gt; 'index',
));

$router-&gt;add('/admin/index', array(
    'module' =&gt; 'backend',
    'controller' =&gt; 'index'
));
</code></pre>
<p>Note that notFound method is not a final solution for a 'not-found' handler, Let's pretend we define the following routes:</p>
<pre><code class="language-php">
$router = new Phalcon\Mvc\Router(false);

$router-&gt;add('/:controller', array(
    'module' =&gt; 'frontend',
    'controller' =&gt; 1
));

$router-&gt;add('/:controller/:action/:params', array(
    'module' =&gt; 'frontend',
    'controller' =&gt; 1,
    'action' =&gt; 2,
    'params' =&gt; 3
));
</code></pre>
<p>These routes match almost every URI passed to the application, there're no way that the router doesn't match a route if they're defined in this way, so implement 'notFound' paths are useless here. </p>
<p>If /products/save/1 is passed as route it passes {controller =&gt; products, action =&gt; save, params =&gt;  [1] }</p>
<p>The dispatcher needs to execute the route but it couldn't exists, so that's why you need to implement a notFound handler in the dispatcher:</p>
<pre><code class="language-php">$eventsManager-&gt;attach("dispatch", function($event, $dispatcher, $exception) {

    if ($event-&gt;getType() == 'beforeException') {
        switch ($exception-&gt;getCode()) {
            case Phalcon\Dispatcher::EXCEPTION_HANDLER_NOT_FOUND:
            case Phalcon\Dispatcher::EXCEPTION_ACTION_NOT_FOUND:
                $dispatcher-&gt;forward(array(
                    'controller' =&gt; 'errors',
                    'action' =&gt; 'show404'
                ));
                return false;
        }
    }
});</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="442" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="442" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/444180903345e196a857d69ebb6a335a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/205/mruz" class="user-moderator-N"><span itemprop="name">Mariusz Łączak</span></a>        </span>
        <br>

        <span class="karma">595</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C1257" href="#C1257">
                <time itemprop="dateCreated" datetime="2013-05-12T06:15:26-07:00" class="action-date">May '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Maybe $router-&gt;notFound() should catch EXCEPTION_ACTION_NOT_FOUND also?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="1257" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="1257" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6935b795a9de2def9a565818e2f63420?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2234/mrthebob" class="user-moderator-N"><span itemprop="name">Mike B</span></a>        </span>
        <br>

        <span class="karma">100</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C10915" href="#C10915">
                <time itemprop="dateCreated" datetime="2014-09-02T11:50:19-07:00" class="action-date">Sep '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>How do you setup/attach the eventsManager for this?  I'm trying to implement this very thing!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="10915" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="10915" data-cf-modified-f558900cb908837136701466-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="106" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>