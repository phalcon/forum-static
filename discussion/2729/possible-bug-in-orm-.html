---
layout: default
title: 'Possible bug in ORM? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Possible bug in ORM?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/78/tmihalik" class="user-moderator-N"><span itemprop="name">tmihalik</span></a></span>
            <time itemprop="dateCreated" datetime="2014-07-03T22:27:31-07:00">Jul '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-07-03T22:27:31-07:00">Jul '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>663</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/98964c53ee95795d14af55eb88b07cf4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/78/tmihalik" class="user-moderator-N"><span itemprop="name">tmihalik</span></a></span>
                <span class="karma">2.5k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C2729" href="#C2729">
        <time class="action-date">Jul '14</time>
    </a>
</div>
<div class="post-content"><div><p>I have two Phalcon\Mvc\Model (Users, Cities). Every user has a city, so the Users model has a hasOne relationship (alias = City).</p>
<pre><code class="language-php">$User = Users::findFirst($user_id);
$name = $User-&gt;name;
$name = $User-&gt;name;
$name = $User-&gt;name;</code></pre>
<p>The above code is ok, because Phalcon runs only one query to the database.</p>
<pre><code class="language-php">$User = Users::findFirst($user_id);
$city = $User-&gt;City-&gt;name;
$city = $User-&gt;City-&gt;name;
$city = $User-&gt;City-&gt;name;</code></pre>
<p>The above code runs 3 query. Everytime I try to get a value from Cities Phalcon runs the same query again. Why?</p>
<pre><code>Phalcon 1.3.2
PHP 5.5.9
PostgreSQL 9.3.4</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-895296be24c359398d068c8d-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-895296be24c359398d068c8d-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/529a9bf0cac49ae51c4a5caabb317761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1918/szegheo" class="user-moderator-N"><span itemprop="name">szegheo</span></a>        </span>
        <br>

        <span class="karma">60</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9267" href="#C9267">
                <time itemprop="dateCreated" datetime="2014-07-07T22:41:21-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think $User-&gt;City should be inited (filled with data) at the first time I try to access it and then kept in memory. We are in the process of changing from Kohana framework to Phalcon. The ORM system of Kohana works like this and we loved it.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9267" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9267" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9268" href="#C9268">
                <time itemprop="dateCreated" datetime="2014-07-07T22:56:12-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You have to define the relation as 'reusable' to obtain the records as you want. <a href="https://docs.phalcon.io/en/latest/reference/models-cache.html#reusable-related-records">https://docs.phalcon.io/en/latest/reference/models-cache.html#reusable-related-records</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9268" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9268" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/529a9bf0cac49ae51c4a5caabb317761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1918/szegheo" class="user-moderator-N"><span itemprop="name">szegheo</span></a>        </span>
        <br>

        <span class="karma">60</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9269" href="#C9269">
                <time itemprop="dateCreated" datetime="2014-07-07T23:28:33-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Oh, I see, thanks. We were stucked at the &quot;Working with Models&quot; section of the docs and that not mentioned this. A grid with available relation options (alias, reusable, etc) could be helpful there. Anyway, thanks four your help!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9269" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9269" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/98964c53ee95795d14af55eb88b07cf4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/78/tmihalik" class="user-moderator-N"><span itemprop="name">tmihalik</span></a>        </span>
        <br>

        <span class="karma">2.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9271" href="#C9271">
                <time itemprop="dateCreated" datetime="2014-07-07T23:37:24-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks! Can it be set globally? </p>
<p>\Phalcon\Mvc\Model::setup does not support it.</p>
<p>Any other way?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9271" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9271" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9273" href="#C9273">
                <time itemprop="dateCreated" datetime="2014-07-07T23:40:19-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>No, it cannot be set globally, you have to pass that option to every relation definition</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9273" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9273" data-cf-modified-895296be24c359398d068c8d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="2729" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>