---
layout: default
title: 'Caching of Phalcon\Mvc\Model\Resultset\Simple - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/8/cache">Cache</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Caching of Phalcon\Mvc\Model\Resultset\Simple</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/2503/mraspor" class="user-moderator-N"><span itemprop="name">mraspor</span></a></span>
            <time itemprop="dateCreated" datetime="2016-05-12T02:15:43-07:00">May '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-05-12T02:15:43-07:00">May '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>886</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/eff69f4e1760f1b3c652281d4030d3cf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/2503/mraspor" class="user-moderator-N"><span itemprop="name">mraspor</span></a></span>
                <span class="karma">12.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11505" href="#C11505">
        <time class="action-date">May '16</time>
    </a>
</div>
<div class="post-content"><div><p>Seems I am lost. </p>
<p>So, how to cache a Phalcon\Mvc\Model\Resultset\Simple query?</p>
<p>If I have something like this:</p>
<pre><code class="language-php">
return new Simple(null, $this, $this-&gt;getReadConnection()-&gt;query($sql));

# and when I pass the cache object (although I am not sure what it does)

return new Simple(null, $this, $this-&gt;getReadConnection()-&gt;query($sql), $this-&gt;getDI()-&gt;get('cache'));
</code></pre>
<p>What actually happens when I pass the cache object and how can I name/get it later?</p>
<p>If I try to save the above return to a cache in controller, I get </p>
<pre><code>Object of class Phalcon\Mvc\Model\Resultset\Simple could not be converted to string</code></pre>
<p>Which seems right as there is no magic method. So, can it be cached from controller at all or how to do it?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-777c5f3f12e178696493e09d-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-777c5f3f12e178696493e09d-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33911" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33911" href="#C33911">
                <time itemprop="dateCreated" datetime="2016-05-12T03:17:07-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Why you even doing it like this ? Why you just not use modelsManager or <code>find</code> <code>findFirst</code>t query from model class ? Simple is just resultset, the cache works on before select and then it creats simple resultset. You should really don't create simple object yourself beacause query from PHQL already returns it.</p>
<p><a href="https://docs.phalcon.io/pl/latest/reference/models-cache.html#caching-phql-queries">https://docs.phalcon.io/pl/latest/reference/models-cache.html#caching-phql-queries</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33911" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33911" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/eff69f4e1760f1b3c652281d4030d3cf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2503/mraspor" class="user-moderator-N"><span itemprop="name">mraspor</span></a>        </span>
        <br>

        <span class="karma">12.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33919" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33919" href="#C33919">
                <time itemprop="dateCreated" datetime="2016-05-12T03:44:01-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/3812/Jurigag">@Jurigag</a></p>
<p>It's a query where I use a subselect in FROM (and last time I checked it is not supported in phql)</p>
<pre><code class="language-php">
SELECT x, y FROM (SELECT...) JOIN ...
</code></pre>
<p>And because of the above, I can't use:</p>
<pre><code class="language-php">
$modelsManager = $this-&gt;getDI()-&gt;get('modelsManager');

$builder = $modelsManager-&gt;createBuilder();

$s = $builder-&gt;from(['alias' =&gt; \Phalcon\Db\Expression('FROM_SUBSELECT')])-&gt;join()....
</code></pre>
<p>Using find() and lazy loading each related record is kind of not an option.</p>
<p>So, my question is still, can it be done? And if yes, how?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33919" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33919" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33921" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33921" href="#C33921">
                <time itemprop="dateCreated" datetime="2016-05-12T03:46:21-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It is supported in phql using query builder or just builder.</p>
<p>Oh sorry i thought you mean just subselect, not in from.</p>
<p>So just just have raw select ? Just cache it yourself, i don't really see any other option.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33921" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33921" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33935" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33935" href="#C33935">
                <time itemprop="dateCreated" datetime="2016-05-12T04:19:42-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I mean just access $this-&gt;getDI()-&gt;get('cache') and cache it there of course.</p>
<p>ALSO if you are using mysql yo for 90% already have mysql result cache, if it's just raw query which will don't need heavy orm things then you don't even need to cache it it's already cached.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33935" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33935" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/eff69f4e1760f1b3c652281d4030d3cf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2503/mraspor" class="user-moderator-N"><span itemprop="name">mraspor</span></a>        </span>
        <br>

        <span class="karma">12.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33939" href="#C33939">
                <time itemprop="dateCreated" datetime="2016-05-12T04:25:51-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Actually, I was mistaken here. When I was saving to cache the result of the Phalcon\Mvc\Model\Resultset\Simple object I accidentally switched the places of needed variables:</p>
<pre><code class="language-php">/* In my controller */

$result = $model-&gt;findRecordsSimpleObject();

# this of course doesn't work
$this-&gt;cache-&gt;save($result, $cacheName, $seconds);

# this works
$this-&gt;cache-&gt;save($cacheName, $result, $seconds);
</code></pre>
<p>Your comment &quot;Just cache it yourself&quot; got me wondering, so I rechecked. Thx for that :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33939" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33939" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33963" href="#C33963">
                <time itemprop="dateCreated" datetime="2016-05-12T05:04:18-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I use <a href="https://api.phalcon.io/class/Phalcon/Cache/Backend/Libmemcached.html">https://api.phalcon.io/class/Phalcon/Cache/Backend/Libmemcached.html</a> for this purpose.
So yeah, you do whatever you think is the most approporiate for your use case, since you're the one who knows your data best.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33963" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33963" data-cf-modified-777c5f3f12e178696493e09d-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11505" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>