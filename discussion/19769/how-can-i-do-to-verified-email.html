---
layout: default
title: 'How can i do to verified email - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">How can i do to verified email</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/12531/ejetli" class="user-moderator-N"><span itemprop="name">ejetli</span></a></span>
            <time itemprop="dateCreated" datetime="2019-06-18T03:00:36-07:00">Jun '19</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2019-06-18T03:00:36-07:00">Jun '19</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '19</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>365</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/28bea29a505e99fac9ba711716473e6a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/12531/ejetli" class="user-moderator-N"><span itemprop="name">ejetli</span></a></span>
                <span class="karma">537</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C19769" href="#C19769">
        <time class="action-date">Jun '19</time>
    </a>
</div>
<div class="post-content"><div><pre><code class="language-php"> public function confirmEmail()
    {
        $data = getEmail;
        $email = $data['email'];

        // Find the user in the database
        $user = Users::findFirstByEmail($email);
        if ($user) {
            return $this-&gt;response-&gt;setJsonContent(["tokenKey" =&gt; $this-&gt;security-&gt;getTokenKey(), "value" =&gt; $this-&gt;security-&gt;getToken()]);
        }
    }</code></pre>
<p>but i got this error</p>
<pre><code class="language-bash">Warning: get_object_vars() expects parameter 1 to be object, boolean given in E:\paps-lms\app\controllers\LoginController.php on line 146</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-3b407a919c39854510b05138-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-3b407a919c39854510b05138-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60097" href="#C60097">
                <time itemprop="dateCreated" datetime="2019-06-18T06:43:01-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What is in line 146 of your <code>LoginController.php</code>?</p>
<p>Also, put a <code>var_dump</code> right after the <code>$user = Users::find....</code> to see that you are getting the correct object back.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60097" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60097" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/28bea29a505e99fac9ba711716473e6a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12531/ejetli" class="user-moderator-N"><span itemprop="name">ejetli</span></a>        </span>
        <br>

        <span class="karma">537</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60097"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nikolaos Dimopoulos                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="60107" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '19</span>
              </span><br/><a name="C60107" href="#C60107">
                <time itemprop="dateCreated" datetime="2019-06-18T08:00:24-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>What is in line 146 of your <code>LoginController.php</code>?</p>
<p>Also, put a <code>var_dump</code> right after the <code>$user = Users::find....</code> to see that you are getting the correct object back.</p>
</blockquote>
<p>On line 146 ,
this is what i want to achieve but not locally but dynamically ,  like this <code>&gt; $data['email'] = '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a1d5c4d2d5e1d5c4d2d58fc2cecc">[email&#160;protected]</a>';</code> but from the db </p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60107" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60107" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60111" href="#C60111">
                <time itemprop="dateCreated" datetime="2019-06-18T08:34:54-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>There are a few things missing from your code that really don't help. Usually what you would do is:</p>
<ul>
<li>Get input from the user</li>
<li>Assign the email to a variable</li>
<li>Check the database for that email</li>
<li>If it exists then tell the user that the email is already there - choose another one or login</li>
<li>If not update the database</li>
</ul>
<p>Now if you want them to verify that their email is correct or valid then lets assume that you send them a code <code>12345</code>. Then when they click a link it will go to an action <code>confirmAction</code>. The posted data to that action would be the email and the verification code. In your action you then need to do:</p>
<pre><code class="language-php">// First parameter field name, 2nd filter, 3rd default value if the field does not exist
$email = $this-&gt;request-&gt;getQuery('email', 'email', '');
$code  = $this-&gt;request-&gt;getQuery('code', 'string', '');

// Check the database
$user = Users::find(
    [
        'conditions' =&gt; 'email = :email: AND token = :token:',
        'bind'       =&gt; [
            'email' =&gt; $email,
            'token' =&gt; $token,
        ],
    ]
);

if (false === $user) {
    // Inform the user that something went wrong - code does not exist or anything like that
} else {
    // Correct verification - update the verification flag
    $user-&gt;verified = true;
    $result = $user-&gt;save();

    if (false === $user) {
        // Something went wrong with saving the record - throw an exception or send a message back
    } else {
        // Success -&gt; you are now verified
    }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60111" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60111" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/28bea29a505e99fac9ba711716473e6a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12531/ejetli" class="user-moderator-N"><span itemprop="name">ejetli</span></a>        </span>
        <br>

        <span class="karma">537</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60111"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nikolaos Dimopoulos                    </a>
                </div><div class="posts-buttons" align="right"><a name="C60123" href="#C60123">
                <time itemprop="dateCreated" datetime="2019-06-19T03:27:24-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>There are a few things missing from your code that really don't help. Usually what you would do is:</p>
<ul>
<li>Get input from the user</li>
<li>Assign the email to a variable</li>
<li>Check the database for that email</li>
<li>If it exists then tell the user that the email is already there - choose another one or login</li>
<li>If not update the database</li>
</ul>
<p>Now if you want them to verify that their email is correct or valid then lets assume that you send them a code <code>12345</code>. Then when they click a link it will go to an action <code>confirmAction</code>. The posted data to that action would be the email and the verification code. In your action you then need to do:</p>
<pre><code class="language-php">// First parameter field name, 2nd filter, 3rd default value if the field does not exist
$email = $this-&gt;request-&gt;getQuery('email', 'email', '');
$code  = $this-&gt;request-&gt;getQuery('code', 'string', '');

// Check the database
$user = Users::find(
   [
       'conditions' =&gt; 'email = :email: AND token = :token:',
       'bind'       =&gt; [
           'email' =&gt; $email,
           'token' =&gt; $token,
       ],
   ]
);

if (false === $user) {
   // Inform the user that something went wrong - code does not exist or anything like that
} else {
   // Correct verification - update the verification flag
   $user-&gt;verified = true;
   $result = $user-&gt;save();

   if (false === $user) {
       // Something went wrong with saving the record - throw an exception or send a message back
   } else {
       // Success -&gt; you are now verified
   }
}</code></pre>
</blockquote>
<p>thanks for the above answer
Now i have verified the email and i want to use it to reset the user password by sending a confirmation email to the user please how can i go about that with the use of  codes will be very happy if you answer it .</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60123" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60123" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60123"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/28bea29a505e99fac9ba711716473e6a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        ejetli                    </a>
                </div><div class="posts-buttons" align="right"><a name="C60125" href="#C60125">
                <time itemprop="dateCreated" datetime="2019-06-19T07:54:41-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>There are very few changes you need to do for the reset password code.</p>
<p>You get the call from the user in your action, you generate a random password, you set the password expiration time in your database and send the email. If the request has been made in error then you ignore the new password (expiration time)</p>
<p>When the user clicks the link you send them to a screen where they type their new password and that is done.</p>
<p>Have a look at the Vokuro <a href="https://github.com/phalcon/vokuro">sample application</a>. It has many of the concepts you need here.</p>
<blockquote>
<p>thanks for the above answer
Now i have verified the email and i want to use it to reset the user password by sending a confirmation email to the user please how can i go about that with the use of  codes will be very happy if you answer it .</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60125" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60125" data-cf-modified-3b407a919c39854510b05138-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="19769" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>