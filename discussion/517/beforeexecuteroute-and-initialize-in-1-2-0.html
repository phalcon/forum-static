---
layout: default
title: 'beforeExecuteRoute and Initialize in 1.2.0 - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/11/events-manager">Events</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">beforeExecuteRoute and Initialize in 1.2.0</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a></span>
            <time itemprop="dateCreated" datetime="2013-07-01T13:51:29-07:00">Jul '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-07-01T13:51:29-07:00">Jul '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '13</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>1342</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/d85988ab06bf0e1e57f72cda8fb7243e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a></span>
                <span class="karma">18.5k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C517" href="#C517">
        <time class="action-date">Jul '13</time>
    </a>
</div>
<div class="post-content"><div><p>If I use:</p>
<pre><code class="language-php">$eventsManager-&gt;attach('dispatch:beforeExecuteRoute', new \Engine\Plugin\CacheAnnotation());</code></pre>
<p>and in plugin:</p>
<pre><code class="language-php">$annotations = $this-&gt;annotations-&gt;getMethod(
            $dispatcher-&gt;getActiveController(),
            $dispatcher-&gt;getActiveMethod()
        );
....</code></pre>
<p>'initialize' is not being called in this case... is it normal? (There is no stopping of event.)</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-af972a23f16d7ddf1b764446-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-af972a23f16d7ddf1b764446-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a4893b2103244c9dfdb6b83dd334d78?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/66/arantir" class="user-moderator-N"><span itemprop="name">arantir</span></a>        </span>
        <br>

        <span class="karma">32.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2138" href="#C2138">
                <time itemprop="dateCreated" datetime="2013-07-01T14:31:10-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I use plugin and exact those rows too, but never noticed problems.
What about action? It is strange if action would be called without initialize. I don't think such behaviour is reachable.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2138" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2138" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d85988ab06bf0e1e57f72cda8fb7243e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a>        </span>
        <br>

        <span class="karma">18.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2139" href="#C2139">
                <time itemprop="dateCreated" datetime="2013-07-01T14:46:47-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Do you have latest origin/1.2.0 branch? If you look at changelog (<a href="https://github.com/phalcon/cphalcon/blob/1.2.0/CHANGELOG">https://github.com/phalcon/cphalcon/blob/1.2.0/CHANGELOG</a>), you will see such string:</p>
<pre><code class="language-text">Now if a controller implements 'initialize' it only is called if 'beforeExecuteRoute' is not stopped</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2139" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2139" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0a4893b2103244c9dfdb6b83dd334d78?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/66/arantir" class="user-moderator-N"><span itemprop="name">arantir</span></a>        </span>
        <br>

        <span class="karma">32.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2140" href="#C2140">
                <time itemprop="dateCreated" datetime="2013-07-01T15:17:59-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes, I do. I understood what you meant. Actually, this string appeared in changelog because of me :D <a href="https://github.com/phalcon/cphalcon/issues/703">https://github.com/phalcon/cphalcon/issues/703</a>
I have a lot of important things in initializes and few additional annotations, using same code you have posted on same event. So, If something went wrong
I see it immediately on many pages. That's why I can say all is right generally.</p>
<p>Can you try to leave just a test &quot;echo '&lt;func_name&gt; called'&quot; in initialize and beforeExecuteRoute to check execution of these functions? Maybe the problem is elsewhere.</p>
<p>Or you meant that initialize is to called <em>before</em> beforeExecuteRoute?
I didn't actually want to change current event sequence when created that issue. I proposed to created additional event, beforeInitialize of something like. Maybe, Phalcon hadn't considered the fact that generally developers need both of event — right before initialization (after beforeDispatch) and right after initialization (before execute action). Second one was beforeExecuteRoute. But now it is the first of them.</p>
<p>If you really need event between initialize &amp; action, a new issue on github is needed to solve this problem. Maybe it is better to revert beforeExecuteRoute and create new event instead (between beforeDispatch &amp; initialize).</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2140" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2140" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d85988ab06bf0e1e57f72cda8fb7243e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a>        </span>
        <br>

        <span class="karma">18.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2145" href="#C2145">
                <time itemprop="dateCreated" datetime="2013-07-02T00:06:21-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-text">Yes, I do. I understood what you meant. Actually, this string appeared in changelog because of me :D https://github.com/phalcon/cphalcon/issues/703
I have a lot of important things in initializes and few additional annotations, using same code you have posted on same event. So, If something went wrong 
I see it immediately on many pages. That's why I can say all is right generally.</code></pre>
<p>Yes, this is important feature.</p>
<pre><code class="language-text">Can you try to leave just a test "echo '&lt;func_name&gt; called'" in initialize and beforeExecuteRoute to check execution of these functions? Maybe the problem is elsewhere.</code></pre>
<p>I went it with xdebug.</p>
<pre><code class="language-text">Or you meant that initialize is to called *before* beforeExecuteRoute?
I didn't actually want to change current event sequence when created that issue. I proposed to created additional event, beforeInitialize of something like. Maybe, Phalcon hadn't considered the fact that generally developers need both of event — right before initialization (after beforeDispatch) and right after initialization (before execute action). Second one was beforeExecuteRoute. But now it is the first of them.

If you really need event between initialize &amp; action, a new issue on github is needed to solve this problem. Maybe it is better to revert beforeExecuteRoute and create new event instead (between beforeDispatch &amp; initialize).</code></pre>
<p>No. I think, that event of this plugin (not implementation of beforeExecuteRoute method in base controller class) somehow interrupts the initialization method call (that is implemented in base controller class). Strange that you have no problem... i've got it when update to latest Phalcon. I will create a gist for this.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2145" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2145" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ae97c58ab751f240dd8eabe91cf5f7a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/281/lazycommit" class="user-moderator-N"><span itemprop="name">Matey Goyce</span></a>        </span>
        <br>

        <span class="karma">4.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2198" href="#C2198">
                <time itemprop="dateCreated" datetime="2013-07-05T06:26:46-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>same thing. if beforeExecuteRoute function just exists in BaseController (for example) no invokation of initialize method happens.
and does not matter void return from beforeExecuteRoute or true.
but, other subscribers on dispatch:beforeExecuteRoute does not prevents initizlize() call</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2198" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2198" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/344b80fe47ae42728ce65f265a6b0fd0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/91/philippgerard" class="user-moderator-N"><span itemprop="name">Philipp Gérard</span></a>        </span>
        <br>

        <span class="karma">19.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2216" href="#C2216">
                <time itemprop="dateCreated" datetime="2013-07-05T09:00:00-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Same problem here, a complete projects stopped working when tested in 1.2 branch because of not called initialize methods in controllers.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2216" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2216" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d85988ab06bf0e1e57f72cda8fb7243e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a>        </span>
        <br>

        <span class="karma">18.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2222" href="#C2222">
                <time itemprop="dateCreated" datetime="2013-07-05T12:09:55-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Can not reproduce this in new project (created via phalcon dev-tools) ... but in main project it still present...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2222" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2222" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d85988ab06bf0e1e57f72cda8fb7243e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/70/lantian" class="user-moderator-N"><span itemprop="name">Ivan Vorontsov</span></a>        </span>
        <br>

        <span class="karma">18.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C2223" href="#C2223">
                <time itemprop="dateCreated" datetime="2013-07-05T12:14:40-07:00" class="action-date">Jul '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://github.com/phalcon/cphalcon/issues/787">https://github.com/phalcon/cphalcon/issues/787</a> &amp;&amp; <a href="https://github.com/phalcon/cphalcon/pull/788">https://github.com/phalcon/cphalcon/pull/788</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="2223" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="2223" data-cf-modified-af972a23f16d7ddf1b764446-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="517" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>