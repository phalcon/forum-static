---
layout: default
title: 'Check if relation is loaded - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Check if relation is loaded</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a></span>
            <time itemprop="dateCreated" datetime="2017-04-06T00:36:02-07:00">Apr '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-04-06T00:36:02-07:00">Apr '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Apr '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">1</span>
                </td>
                <td>
                    <label>Views</label><br>608</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a></span>
                <span class="karma">23.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C15897" href="#C15897">
        <time class="action-date">Apr '17</time>
    </a>
</div>
<div class="post-content"><div><p>Hi,
I was wondering if is it possible to check if a relationship is loaded.</p>
<p>I'm using eager loading and caché so when I'm at a model instance I want to : </p>
<ul>
<li>
<p>check if the relationship is loaded, </p>
</li>
<li>
<p>if it's not, then I will try to take it from caché,</p>
</li>
<li>if not I fetch it using <code>getRelated</code>.</li>
</ul>
<p>*1 My problem here is that when I try to check if it's null, it automagically loads the relationship, avoiding the caché layer. So, summing up in pseudocode:</p>
<pre><code class="language-php">public function getMyRelationship()
{
     $cache_key = '....';
     $ttl = 10 * 60;
     if($this-&gt;myRelationsip === null) {  // check if the related models are already fetched // *1
              // get from cache or execute function to fetch the related models
              $this-&gt;myRelationship = $this-&gt;cache-&gt;remember($cache_key, $ttl, function() { 
                      return $this-&gt;getRelated('myRelationship');
               }
     }

     return $this-&gt;myRelationship;  
}</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8ac62b3845c98e2c93c24f457e0701a6?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/189/Farkhod" class="user-moderator-N"><span itemprop="name">Farkhod</span></a>        </span>
        <br>

        <span class="karma">42.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="47325" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '17</span>
              </span><br/><a name="C47325" href="#C47325">
                <time itemprop="dateCreated" datetime="2017-04-06T00:54:58-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi.</p>
<p>Maybe here is what you're looking for <a href="https://docs.phalcon.io/en/latest/reference/models-cache.html">Caching in the ORM</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47325" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47325" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C47325"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/8ac62b3845c98e2c93c24f457e0701a6?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Farkhod                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="47327" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '17</span>
              </span><br/><a name="C47327" href="#C47327">
                <time itemprop="dateCreated" datetime="2017-04-06T01:11:41-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Nop :(
I just need to check if the relationship is already loaded. So the lazy loading does not fire and I can take it from cache.</p>
<p>The thing is that I could have the relationships loaded using eager load (the relationship is already loaded) and all that models cache documentation only talks about fetching it from database or caché, but it says nothing about checking if it's already loaded.</p>
<p>If I already have a relationship loaded and I call getRelated with caché the system always try to get from cache or fetch from db, never looks if it's already loaded to return the loaded ones.</p>
<blockquote>
<p>Hi.</p>
<p>Maybe here is what you're looking for <a href="https://docs.phalcon.io/en/latest/reference/models-cache.html">Caching in the ORM</a></p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47327" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47327" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47329" href="#C47329">
                <time itemprop="dateCreated" datetime="2017-04-06T01:44:51-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Maybe this is the key:</p>
<pre><code class="language-php">    if($this-&gt;_related['relationshipAlias'] === null) ...</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47329" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47329" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47333" href="#C47333">
                <time itemprop="dateCreated" datetime="2017-04-06T02:46:01-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://github.com/phalcon/cphalcon/pull/12772">https://github.com/phalcon/cphalcon/pull/12772</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47333" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47333" data-cf-modified-7f6f384cb265ab9b1f36d417-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="15897" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>