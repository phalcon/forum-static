---
layout: default
title: 'Some question about dispatcher forward - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Some question about dispatcher forward</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/244/BaiYulong" class="user-moderator-N"><span itemprop="name">BaiYulong</span></a></span>
            <time itemprop="dateCreated" datetime="2014-05-12T00:17:06-07:00">May '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-05-12T00:17:06-07:00">May '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>1065</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/6dcb4636923643bea05a6b7a03cc21e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/244/BaiYulong" class="user-moderator-N"><span itemprop="name">BaiYulong</span></a></span>
                <span class="karma">15.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C2287" href="#C2287">
        <time class="action-date">May '14</time>
    </a>
</div>
<div class="post-content"><div><p>ControllerBase.php</p>
<pre><code class="language-php">&lt;?php
protected function forward($uri){
        $uriParts = explode('/', $uri);
        return $this-&gt;dispatcher-&gt;forward(
            array(
                'controller' =&gt; $uriParts[0], 
                'action' =&gt; $uriParts[1]
            )
        );
    }</code></pre>
<p>SessionController.php</p>
<pre><code class="language-php">.....
if ($password != $rePassword) {
       $this-&gt;flash-&gt;error('两次输入的密码不一致，请重新输入！');
       return $this-&gt;forward('session/register');
}
......</code></pre>
<p>The result-----&gt;</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>...........</p>
<p>两次输入的密码不一致，请重新输入！</p>
<p>Dispatcher has detected a cyclic routing causing stability problems</p>
<p>I can't find the way to debug the question, help me!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-c2ea24b5fb480165f830d33e-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-c2ea24b5fb480165f830d33e-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bf2876998907a5932aa609a948720862?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/241/gsouf" class="user-moderator-N"><span itemprop="name">Soufiane Ghzal</span></a>        </span>
        <br>

        <span class="karma">21.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C7831" href="#C7831">
                <time itemprop="dateCreated" datetime="2014-05-13T03:20:57-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Please, can you show us the code in SessesionController::registerAction ?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7831" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7831" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6dcb4636923643bea05a6b7a03cc21e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/244/BaiYulong" class="user-moderator-N"><span itemprop="name">BaiYulong</span></a>        </span>
        <br>

        <span class="karma">15.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="7871" data-toggle="modal" data-target="#historyModal">
                edited <span>May '14</span>
              </span><br/><a name="C7871" href="#C7871">
                <time itemprop="dateCreated" datetime="2014-05-14T01:55:30-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">
/**
     * 用户注册
     * @return [type] [description]
     */
    public function registerAction() {
        $request = $this-&gt;request;
        if ($request-&gt;isPost()) {
            $username = $request-&gt;getPost('username', array('email', 'email'));
            $password = $request-&gt;getPost('password');
            $rePassword = $request-&gt;getPost('repassword');
            $sex = $request-&gt;getPost('sex', array('int'));

            if ($password != $rePassword) {
                $this-&gt;flash-&gt;error('两次输入的密码不一致，请重新输入！');
                return $this-&gt;forward('session/register');
            }

            $user = new Model\User();
            $user-&gt;u_username = $username;
            $user-&gt;u_password = sha1($password);
            $user-&gt;u_email = $username;
            if ($user-&gt;save() == false) {
                foreach ($user-&gt;getMessage() as $msg) {
                    $this-&gt;flash-&gt;error((string) $msg);
                }
                return $this-&gt;forward('session/register');
            } else {
                Tag::setDefault('username', '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e29a8b838d978fa28e8b9487cc818d8f">[email&#160;protected]</a>');
                Tag::setDefault('password', '');
                Tag::setDefault('sex', 1);
                $this-&gt;flash-&gt;success('欢饮加入我们的团队，您的宝宝将万众瞩目下成长！');
                return $this-&gt;forward('index/index');
            }
        }
    }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7871" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7871" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bf2876998907a5932aa609a948720862?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/241/gsouf" class="user-moderator-N"><span itemprop="name">Soufiane Ghzal</span></a>        </span>
        <br>

        <span class="karma">21.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="7872" data-toggle="modal" data-target="#historyModal">
                edited <span>May '14</span>
              </span><br/><a name="C7872" href="#C7872">
                <time itemprop="dateCreated" datetime="2014-05-14T02:15:25-07:00" class="action-date">May '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Actually it's very simple.</p>
<p>When you forward, you keep the same POST data. </p>
<p>Forwarding is just a way to execute another action with the same request (the same post/get data, same http header etc...) then when you save user, you forward again on register, with the same post data (it means that you still ask to register the user), then you do the same job : register user, forward, register user, forward, register user , forward.</p>
<p>Instead you may use <a href="http://docs.phalcon.io/en/latest/reference/response.html#making-redirections">$this-&gt;request-&gt;redirect</a> or forward to another action.
The request-&gt;redirect will end the actual script, send a 301 http status (or 302) and the client will load your script once again, but w/o the post datas</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="7872" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="7872" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6dcb4636923643bea05a6b7a03cc21e1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/244/BaiYulong" class="user-moderator-N"><span itemprop="name">BaiYulong</span></a>        </span>
        <br>

        <span class="karma">15.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C8688" href="#C8688">
                <time itemprop="dateCreated" datetime="2014-06-15T23:59:48-07:00" class="action-date">Jun '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>E.....Understand......Thank for your replay!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="8688" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="8688" data-cf-modified-c2ea24b5fb480165f830d33e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="2287" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>