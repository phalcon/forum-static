---
layout: default
title: 'Storing Related Records Question - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Storing Related Records Question</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/10513/BradSelfridge" class="user-moderator-N"><span itemprop="name">BradSelfridge</span></a></span>
            <time itemprop="dateCreated" datetime="2017-12-04T13:02:33-07:00">Dec '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-12-04T13:02:33-07:00">Dec '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>352</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/ba33d3d68bb5898249c7e1c3de0b6ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/10513/BradSelfridge" class="user-moderator-N"><span itemprop="name">BradSelfridge</span></a></span>
                <span class="karma">442</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C17401" href="#C17401">
        <time class="action-date">Dec '17</time>
    </a>
</div>
<div class="post-content"><div><p>I have a Property model that has a &quot;hasOne-&gt;addressId&quot; relationship to an Address model. The Address model has a &quot;belongsTo-&gt;addressId&quot; relationship to the Property. I create a Property instance, then create an Addess instance and add it to the Property instance. I then try to  &quot;save()&quot; the Property instance where I get a &quot;PresenceOf - addressId is required&quot; error. It looks like the framework is trying to save the Property before the Address, hence thr Address id is missing. Can someone tell me the sequence that the framework uses when inserting parent and child objects?  </p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/877a54304e07c8cb38c47b43e1d6b6b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2828/sergeyklay" class="user-moderator-Y"><span itemprop="name">Serghei Iakovlev</span></a>        </span>
        <br>

        <span class="karma">39.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52659" href="#C52659">
                <time itemprop="dateCreated" datetime="2017-12-04T13:25:43-07:00" class="action-date">Dec '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Could you please provide models and steps to reproduce the issue?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52659" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52659" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ba33d3d68bb5898249c7e1c3de0b6ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10513/BradSelfridge" class="user-moderator-N"><span itemprop="name">BradSelfridge</span></a>        </span>
        <br>

        <span class="karma">442</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="52663" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '17</span>
              </span><br/><a name="C52663" href="#C52663">
                <time itemprop="dateCreated" datetime="2017-12-04T13:34:13-07:00" class="action-date">Dec '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">namespace Library\Models\Properties\Base;

class Property 
{

    const TABLE_NAME = 'properties';

    public $loanId; 
    public $addressId;
    public $propertyTypeId;
    public $propertyUseId;

    /**
     * Initialize method for model
     */
    public function initialize()
    {
        parent::initialize();
        $this-&gt;hasOne(
            'addressId',
            'Library\Models\Addresses\Base\Address',
            'id', ['alias' =&gt; 'Address']);
        $this-&gt;hasOne(
            'propertyTypeId',
            'Library\Models\Types\PropertyType',
            'id', ['alias' =&gt; 'PropertyType']);
        $this-&gt;hasOne(
            'propertyUseId',
            'Library\Models\Types\PropertyUseType',
            'id', ['alias' =&gt; 'PropertyUseType']);
    }

    /**
     * Independent Column Mapping.
     * Keys are the real names in the table and the values their names in the application
     *
     * @return array
     */
    public function columnMap()
    {
        return
            [
                'loan_id' =&gt; 'loandId',
                'address_id' =&gt; 'addressId',
                'property_type_id' =&gt; 'propertyTypeId',
                'property_use_id' =&gt; 'propertyUseId'
            ];
    }
}</code></pre>
<pre><code class="language-php">namespace Library\Models\Addresses\Base;

class Address
{

    const TABLE_NAME = 'addresses';
    const BLANK_FIELD = "''";

    public $loanId; 
    public $address1;
    public $address2 = self::BLANK_FIELD;
    public $city;
    public $state;
    public $zip;
    public $country;

    /**
     * Initialize method for model
     */
    public function initialize()
    {
        parent::initialize();
        $this-&gt;belongsTo(
            'id',
            'Library\Models\Properties\Base\Property',
            'addressId', ['alias' =&gt; 'Property']);
    }

    /**
     * Independent Column Mapping.
     * Keys are the real names in the table and the values their names in the application
     *
     * @return array
     */
    public function columnMap()
    {
        return
            [
                'loan_id' =&gt; 'loandId',
                'address1' =&gt; 'address1',
                'address2' =&gt; 'address2',
                'city'     =&gt; 'city',
                'state'    =&gt; 'state',
                'zip'      =&gt; 'zip',
                'country'  =&gt; 'country'
            ];
    }
}</code></pre>
<pre><code class="language-php">{
        $property = new \Library\Models\Properties\Base\Property();
        $property
            -&gt;setLoanId('96')
            -&gt;setPropertyUseId('1')
            -&gt;setPropertyTypeId('1');

        $address = new Address();
        $address
            -&gt;setLoanId('96')
            -&gt;setAddress1('3456 Some Street')
            -&gt;setCity('Yuck')
            -&gt;setState('MO')
            -&gt;setZip('12345')
            -&gt;setCountry('USA');

        $property-&gt;address = $address;
        if ($property-&gt;save() == false) {
            foreach ($property-&gt;getMessages() as $message) {
                echo $message;
            }
        }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52663" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52663" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/ba33d3d68bb5898249c7e1c3de0b6ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10513/BradSelfridge" class="user-moderator-N"><span itemprop="name">BradSelfridge</span></a>        </span>
        <br>

        <span class="karma">442</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52665" href="#C52665">
                <time itemprop="dateCreated" datetime="2017-12-04T13:34:51-07:00" class="action-date">Dec '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Not sure how to add code segment to this forum.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52665" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52665" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/877a54304e07c8cb38c47b43e1d6b6b3?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2828/sergeyklay" class="user-moderator-Y"><span itemprop="name">Serghei Iakovlev</span></a>        </span>
        <br>

        <span class="karma">39.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52667" href="#C52667">
                <time itemprop="dateCreated" datetime="2017-12-04T13:43:15-07:00" class="action-date">Dec '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>```php</p>
<p>new stdClass();</p>
<p>```</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52667" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52667" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/533985d102feef881f5c41933bd43bfb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/283/calinrada" class="user-moderator-N"><span itemprop="name">Calin Rada</span></a>        </span>
        <br>

        <span class="karma">51.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52715" href="#C52715">
                <time itemprop="dateCreated" datetime="2017-12-05T02:14:35-07:00" class="action-date">Dec '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">$address = new Address();
...
...

$property = new Property();
$property-&gt;Address = $address;</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52715" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52715" data-cf-modified-ff2260a0ecd8d1cd86650668-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="17401" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>