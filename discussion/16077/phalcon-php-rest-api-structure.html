---
layout: default
title: 'Phalcon PHP REST API structure - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/22/micro">Micro</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon PHP REST API structure</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/9545/maryjosh" class="user-moderator-N"><span itemprop="name">maryjosh</span></a></span>
            <time itemprop="dateCreated" datetime="2017-05-04T08:06:28-07:00">May '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-05-04T08:06:28-07:00">May '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>1218</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">1</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/be69045e2cea46f7df04dea53fa35956?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/9545/maryjosh" class="user-moderator-N"><span itemprop="name">maryjosh</span></a></span>
                <span class="karma">5.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C16077" href="#C16077">
        <time class="action-date">May '17</time>
    </a>
</div>
<div class="post-content"><div><p>I am developing REST API using Phalcon. The application will have multiple modules like Users, Company, Contacts and so on. Each of these modules have their own tables for storing data. Moreover each module have their own defination file which mentions what fields to show in API response. I am pretty new to Phalcon, i just started learning, and I need help regarding how i should structure the application so that this code won't give me future problems, or if I'm missing something or if the code could be abstracted more then that would be great.</p>
<p>Directory Structure as planned:</p>
<p>app/</p>
<pre><code>MyAPI/
    MyAPIControler.php</code></pre>
<p>library/</p>
<pre><code>controller.php //master controller where all controllers inherit from
model.php //master model where all models inherit from
utilities.php
MyAPI/

    models/

        User.php 
        Contacts.php
        Company.php
        Myapi.php</code></pre>
<p>/config</p>
<pre><code>config.php
routes.php</code></pre>
<p>index.php</p>
<p>I want all database related queries of each module to reside in their own models. API URL say for listing of records will be <a href="https://api.example.com/MyAPI/V2/contacts/list">https://api.example.com/MyAPI/V2/contacts/list</a> or /MyAPI/V2/users/list. Similarly API URL for creating records will be <a href="https://api.example.com/MyAPI/V2/contacts/add">https://api.example.com/MyAPI/V2/contacts/add</a> or /MyAPI/V2/users/list</p>
<p>Please advise how i should proceed.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="47965" data-toggle="modal" data-target="#historyModal">
                edited <span>May '17</span>
              </span><br/><a name="C47965" href="#C47965">
                <time itemprop="dateCreated" datetime="2017-05-04T16:04:28-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>1st to clarify - why you wish for independent modules per API feature while trying to use Phalcon Micro?</p>
<p>IMO that's not desired pattern for a number of reasons. You can do all of that in a single Micro app structure, with Models, Controllers etc. </p>
<p>Or perhaps you are aiming at Microservices architecture?</p>
<p>The thing with Phalcon (Micro) is to use services container (IoC) wisely and DRY. You control your routes with <code>MicroCollection</code> component.  And you use simple app events - <code>before</code>, <code>after</code> and <code>finish</code>.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47965" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47965" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47985" href="#C47985">
                <time itemprop="dateCreated" datetime="2017-05-07T02:14:47-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>HI,</p>
<p>also, a REST app has some specific rules based on http verbs (GET, POST, PUT, DELETE), so </p>
<ul>
<li><a href="https://api.example.com/MyAPI/V2/contacts/list">https://api.example.com/MyAPI/V2/contacts/list</a>  should be GET <a href="https://api.example.com/MyAPI/V2/contacts">https://api.example.com/MyAPI/V2/contacts</a></li>
<li><a href="https://api.example.com/MyAPI/V2/contacts/add">https://api.example.com/MyAPI/V2/contacts/add</a> should be POST <a href="https://api.example.com/MyAPI/V2/contacts">https://api.example.com/MyAPI/V2/contacts</a></li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47985" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47985" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/be69045e2cea46f7df04dea53fa35956?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9545/maryjosh" class="user-moderator-N"><span itemprop="name">maryjosh</span></a>        </span>
        <br>

        <span class="karma">5.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48203" href="#C48203">
                <time itemprop="dateCreated" datetime="2017-05-18T01:07:06-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks both of you for quick reply. I was under the weather so couldn't replied earlier.</p>
<p>I have changed the directory structure. it goes like this:</p>
<p>app</p>
<pre><code>/config
    config.php
    routes.php
    loader.php
    di.php

/controllers
    mycontroller.php
    Abstractexception.php
    Abstratcontroller.php  #this extends \Phalcon\DI\Injectable

/models
    mymodel.php

/services
    AbstractService.php #this extends \Phalcon\DI\Injectable
    myservice.php </code></pre>
<p>public</p>
<pre><code>index.php</code></pre>
<p>I can controll the routes using routes.php. </p>
<p>I have many DB tables to handle like Contacts, Users, Accounts etc. I am dynamically setting source for my single model from Service container depending on the request. Is this right thing to do or do you have any suggestions.</p>
<p>Also I have several functions which will be used by various API. Is it advisable to create a library where to keep all the common functions and use it when needed.</p>
<p>Your suggestions is very much appreciated. Thank again.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48203" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48203" data-cf-modified-25d612da2d36c3b4cbf27ca4-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="16077" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>