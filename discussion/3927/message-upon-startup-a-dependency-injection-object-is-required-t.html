---
layout: default
title: 'Message upon startup: &quot;A dependency injection object is required to access internal services&quot; - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/6/installation">Installation</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Message upon startup: &quot;A dependency injection object is required to access internal services&quot;</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2179/tabalchi" class="user-moderator-N"><span itemprop="name">tabalchi</span></a></span>
            <time itemprop="dateCreated" datetime="2014-11-11T19:30:54-07:00">Nov '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-11-11T19:30:54-07:00">Nov '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Nov '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>1864</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/20b31d83263ba04021e130472b8a1761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2179/tabalchi" class="user-moderator-N"><span itemprop="name">tabalchi</span></a></span>
                <span class="karma">4.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C3927" href="#C3927">
        <time class="action-date">Nov '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hi,</p>
<p>I am porting my Phalcon-based application to a Raspberry Pi B+ running Arch Linux + Nginx. </p>
<p>Since there wasn't a v1.3.x image for Phalcon for Arch Linux, I successfully compiled Phalcon on the Raspberry Pi, installed the extension in the appropriate directory, and enabled it in php.ini. A call to phpinfo() shows the phalcon extension.</p>
<p>After pointing to the application's &quot;public&quot; directory as webroot in nginx.conf, then starting Nginx and php-fpm, I only see the following line on the browser when I try to access the application:</p>
<p><strong>&quot;A dependency injection object is required to access internal services&quot;</strong></p>
<p>Any suggestions about how to resolve this?</p>
<p>Btw, this app is working on a different machine using Ubuntu+Nginx. Would Raspbian instead of Arch Linux on the Raspberry Pi be a better choice?</p>
<p>Thanks!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e008d7c8aa0c868f618211c399d1e927?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2111/praswicaksono" class="user-moderator-N"><span itemprop="name">Prasetyo</span></a>        </span>
        <br>

        <span class="karma">7.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13050" href="#C13050">
                <time itemprop="dateCreated" datetime="2014-11-12T03:45:10-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>could you please post your bootstrap code here?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13050" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13050" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/20b31d83263ba04021e130472b8a1761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2179/tabalchi" class="user-moderator-N"><span itemprop="name">tabalchi</span></a>        </span>
        <br>

        <span class="karma">4.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13064" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '14</span>
              </span><br/><a name="C13064" href="#C13064">
                <time itemprop="dateCreated" datetime="2014-11-12T07:07:51-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Here is the bootstrap code:</p>
<pre><code class="language-php">&lt;?php

error_reporting(E_ALL);

try {

    /**
     * Read the configuration
     */
    $config = include __DIR__ . "/../app/config/config.php";

    /**
     * Read auto-loader
     */
    include __DIR__ . "/../app/config/loader.php";

    /**
     * Read services
     */
    include __DIR__ . "/../app/config/services.php";

    /**
     * Handle the request
     */
    $application = new \Phalcon\Mvc\Application($di);

    echo $application-&gt;handle()-&gt;getContent();

} catch (\Exception $e) {
    echo $e-&gt;getMessage();
}</code></pre>
<p>AND Here is Services.php:</p>
<pre><code class="language-php">&lt;?php

use Phalcon\DI\FactoryDefault;
use Phalcon\Mvc\View;
use Phalcon\Mvc\Url as UrlResolver;
use Phalcon\Db\Adapter\Pdo\Sqlite as DbAdapter;
use Phalcon\Mvc\View\Engine\Volt as VoltEngine;
use Phalcon\Mvc\Model\Metadata\Memory as MetaDataAdapter;
use Phalcon\Session\Adapter\Files as SessionAdapter;

/**
 * The FactoryDefault Dependency Injector automatically register the right services providing a full stack framework
 */
$di = new FactoryDefault();

/**
 * The URL component is used to generate all kind of urls in the application
 */
$di-&gt;set('url', function () use ($config) {
    $url = new UrlResolver();
    $url-&gt;setBaseUri($config-&gt;application-&gt;baseUri);

    return $url;
}, true);

/**
 * Setting up the view component
 */
$di-&gt;set('view', function () use ($config) {

    $view = new View();

    $view-&gt;setViewsDir($config-&gt;application-&gt;viewsDir);

    $view-&gt;registerEngines(array(
        '.phtml' =&gt; 'Phalcon\Mvc\View\Engine\Php'
    ));

    return $view;
}, true);

/**
 * Database connection for Sqlite based on config.php
 */
$di-&gt;set('db', function () use ($config) {
    return new DbAdapter(array(
        'dbname' =&gt; $config-&gt;database-&gt;dbname
    ));
});

/**
 * If the configuration specify the use of metadata adapter use it or use memory otherwise
 */
$di-&gt;set('modelsMetadata', function () {
    return new MetaDataAdapter();
});

/**
 * Start the session the first time some component request the session service
 */
$di-&gt;set('session', function () {
    $session = new SessionAdapter();
    $session-&gt;start();

    return $session;
});

/**
 * Create a models cache for frequently used static data
 */
$di-&gt;set('modelsCache',function() {

    //Create a Data frontend and set a default lifetime to 1 day
    $frontend = new Phalcon\Cache\Frontend\Data(array(
        'lifetime' =&gt; 86400
    ));

    // Set up APC Cache
    $cache = new Phalcon\Cache\Backend\Apc($frontend, array(
        'prefix' =&gt; 'cache'
    ));

    return $cache;
});

/**
 * Create a regular cache for frequently used static data
 */
$di-&gt;set('appCache',function() {

    //Create a Data frontend and set a default lifetime to 1 day
    $frontend = new Phalcon\Cache\Frontend\Data(array(
        'lifetime' =&gt; 86400
    ));

    // Set up APC Cache
    $cache = new Phalcon\Cache\Backend\Apc($frontend, array(
        'prefix' =&gt; 'appcache'
    ));

    return $cache;
});

/**
 * Take control of dispatcher in order to override EventManager methods
 */
$di-&gt;set('dispatcher', function() use ($di) {

    //Obtain the standard eventsManager from the DI
    $eventsManager = $di-&gt;getShared('eventsManager');

    //Instantiate the Security plugin
    $security = new Security($di);

    //Listen for events produced in the dispatcher using the Security plugin
    $eventsManager-&gt;attach('dispatch', $security);

    $dispatcher = new Phalcon\Mvc\Dispatcher();

    //Bind the EventsManager to the Dispatcher
    $dispatcher-&gt;setEventsManager($eventsManager);

    return $dispatcher;
});</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13064" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13064" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e008d7c8aa0c868f618211c399d1e927?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2111/praswicaksono" class="user-moderator-N"><span itemprop="name">Prasetyo</span></a>        </span>
        <br>

        <span class="karma">7.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13065" href="#C13065">
                <time itemprop="dateCreated" datetime="2014-11-12T07:13:59-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>There is no problem about it, it should works</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13065" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13065" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/20b31d83263ba04021e130472b8a1761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2179/tabalchi" class="user-moderator-N"><span itemprop="name">tabalchi</span></a>        </span>
        <br>

        <span class="karma">4.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C13065"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e008d7c8aa0c868f618211c399d1e927?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Prasetyo                    </a>
                </div><div class="posts-buttons" align="right"><a name="C13066" href="#C13066">
                <time itemprop="dateCreated" datetime="2014-11-12T07:32:54-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>There is no problem about it, it should works</p>
</blockquote>
<p>Right, the same files work on Ubuntu+Nginx and I ported them unchanged. Could it be some environment variables or something else related to Arch Linux? Since this is an exception thrown by Phalcon, it means the extension is being loaded.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13066" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13066" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13093" href="#C13093">
                <time itemprop="dateCreated" datetime="2014-11-12T16:01:54-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This isn't a problem down at the OS level - this is simply a PHP code error.  I've received this error before - it was caused by me not passing the dependency injector variable properly.</p>
<p>Is the error giving you a specific file and line number?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13093" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13093" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/20b31d83263ba04021e130472b8a1761?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2179/tabalchi" class="user-moderator-N"><span itemprop="name">tabalchi</span></a>        </span>
        <br>

        <span class="karma">4.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13105" href="#C13105">
                <time itemprop="dateCreated" datetime="2014-11-12T19:45:02-07:00" class="action-date">Nov '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><strong>FOUND THE PROBLEM AND FIXED IT</strong></p>
<p>There was no specific file and line number error, but it was complaining about &quot;open_basedir restrictions&quot;. I had missed that the first time around, looked everywhere but nginx error log.</p>
<p>The <code>open_basedir</code> parameter in my <code>php.ini</code> file did not include the top-level application directory, so the <code>include</code> statements in the bootstrap were not working. I had only included the <code>/usr/share/nginx/html/</code> path in <code>open_basedir</code> but that is actually a softlink to my Phalcon app's <code>public</code> directory (i.e. <code>/usr/share/nginx/html -&gt; /&lt;my phalcon app location&gt;/myphalconapp/public</code>). </p>
<p>Now, I have cleaned up my installation by moving my Phalcon app under the <code>/usr/share/webapps</code> directory. This directory was already included in the <code>open_basedir</code> parameter. Of course, the softlink above had to be reset to: <code>/usr/share/nginx/html -&gt; /usr/share/webapps/myphalconapp/public</code>.</p>
<p>Thanks for spurring me on. Everything is working great now. To have this running on a Raspberry Pi is really cool.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13105" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13105" data-cf-modified-ea0910c412a71f64d24ca2e2-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="3927" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>