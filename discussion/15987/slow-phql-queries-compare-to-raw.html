---
layout: default
title: 'Slow PHQL queries compare to raw. - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/29/database">Database</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Slow PHQL queries compare to raw.</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/9451/Ringflash" class="user-moderator-N"><span itemprop="name">Ringflash</span></a></span>
            <time itemprop="dateCreated" datetime="2017-04-19T13:29:04-07:00">Apr '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-04-19T13:29:04-07:00">Apr '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Apr '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>907</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/859e423e0b9353e524d7f6b1d762e51b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/9451/Ringflash" class="user-moderator-N"><span itemprop="name">Ringflash</span></a></span>
                <span class="karma">1.1k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C15987" href="#C15987">
        <time class="action-date">Apr '17</time>
    </a>
</div>
<div class="post-content"><div><p>Hello!
I'm choosing a new framework for a modern and fast ecommerce  store.
There will be a lot of sql queries, so the speed is very important. For this issue I'm using: mySQL and table with 50 000 products.</p>
<p><strong>With Phalcon PHQL:</strong></p>
<p>Setup from INVO</p>
<p>first query - 0.0076 sec:</p>
<p>second query - 0.0031 sec:</p>
<pre><code class="language-php">$product = Product::findFirst(25193);</code></pre>
<p><strong>With raw mysqli:</strong></p>
<p>Much faster.</p>
<p>first query - 0.00074 sec:</p>
<pre><code class="language-php">    $mysqli = new mysqli("localhost", "root", "password", "db");
    $stmt = $mysqli-&gt;query("SELECT * FROM product WHERE product_id = 25193");
    $row = mysqli_fetch_assoc($stmt);</code></pre>
<p>So with a lot of joins and many queries an app will be to slow.
Or I'm doing something wrong?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-025d0149fd6785f299cbc90c-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-025d0149fd6785f299cbc90c-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47665" href="#C47665">
                <time itemprop="dateCreated" datetime="2017-04-19T23:29:31-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That's the price you pay for ORM and/or Active record. </p>
<p>P.S. You'd better try with PDO instead of MySQLi driver when you compare Phalcon ORM vs. PHP raw.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47665" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47665" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6221c81c81cd357c818daec1bb8b17ff?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4153/nikolay-mihaylov" class="user-moderator-N"><span itemprop="name">Nikolay Mihaylov</span></a>        </span>
        <br>

        <span class="karma">93.7k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="47667" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '17</span>
              </span><br/><a name="C47667" href="#C47667">
                <time itemprop="dateCreated" datetime="2017-04-20T00:46:10-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>As<a href="https://forum.phalcon.io/user/0/Jonathan"> @Jonathan</a> said, using the ORM in every framework will always be slower than anything else. ORM's fetch whole objects, relations and other crap. When using ORM you have to use model relations (hasMany, belongsTo etc...) which will cause n+1 problem and you said you will have a lot of queries, this will be problematic with every framework.</p>
<p>You may want to take a look at Phalcon Query Builder, it's elegant way to create queries, allows you to do joins which are way faster than ORM relations. <code>https://docs.phalcon.io/en/3.0.2/api/Phalcon_Mvc_Model_Query_Builder.html</code>.</p>
<p>You said &quot;modern&quot;, so might as well use PDO, since mysqli is pretty old already :)</p>
<p>And never ever do <code>select *</code> when aiminig for performance ;)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47667" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47667" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/859e423e0b9353e524d7f6b1d762e51b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/9451/Ringflash" class="user-moderator-N"><span itemprop="name">Ringflash</span></a>        </span>
        <br>

        <span class="karma">1.1k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C47665"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Jonathan Aaron Steel                    </a>
                </div><div class="posts-buttons" align="right"><a name="C47669" href="#C47669">
                <time itemprop="dateCreated" datetime="2017-04-20T00:56:13-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Jonathan, for your opinion, can I benefit from using Phalcon ORM on ecommerce? Or it always will slow down app with every new query? Yes, Iâ€™ll be using several Memcached layers. But the main operations in ecommerce is reading large joined tables. Now for our projects we are using Opencart with cache, so server response time is 30 ms average with full cache and 45-60 ms with partial cache.</p>
<blockquote>
<p>That's the price you pay for ORM and/or Active record. </p>
<p>P.S. You'd better try with PDO instead of MySQLi driver when you compare Phalcon ORM vs. PHP raw.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47669" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47669" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/859e423e0b9353e524d7f6b1d762e51b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/9451/Ringflash" class="user-moderator-N"><span itemprop="name">Ringflash</span></a>        </span>
        <br>

        <span class="karma">1.1k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C47667"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/6221c81c81cd357c818daec1bb8b17ff?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nikolay Mihaylov                    </a>
                </div><div class="posts-buttons" align="right"><a name="C47671" href="#C47671">
                <time itemprop="dateCreated" datetime="2017-04-20T01:00:16-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Nikolay, yes SELECT * was for quick example and test :) We are profiling and test queries.
Will try Phalcon Query Builder.
Thank you for your reply!</p>
<blockquote>
<p>As<a href="https://forum.phalcon.io/user/0/Jonathan"> @Jonathan</a> said, using the ORM in every framework will always be slower than anything else. ORM's fetch whole objects, relations and other crap. When using ORM you have to use model relations (hasMany, belongsTo etc...) which will cause n+1 problem and you said you will have a lot of queries, this will be problematic with every framework.</p>
<p>You may want to take a look at Phalcon Query Builder, it's elegant way to create queries, allows you to do joins which are way faster than ORM relations. <code>https://docs.phalcon.io/en/3.0.2/api/Phalcon_Mvc_Model_Query_Builder.html</code>.</p>
<p>You said &quot;modern&quot;, so might as well use PDO, since mysqli is pretty old already :)</p>
<p>And never ever do <code>select *</code> when aiminig for performance ;)</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47671" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47671" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Åšlawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="47717" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '17</span>
              </span><br/><a name="C47717" href="#C47717">
                <time itemprop="dateCreated" datetime="2017-04-21T03:58:50-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It's pretty obvious that raw sql will be always faster than orm. But with orm it gives you much more ability and it's more powerful.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47717" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47717" data-cf-modified-025d0149fd6785f299cbc90c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="15987" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>