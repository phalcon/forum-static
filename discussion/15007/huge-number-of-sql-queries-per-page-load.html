---
layout: default
title: 'Huge number of SQL queries per page load - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/4/offtopic">Offtopic</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Huge number of SQL queries per page load</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/8749/konrad-ch" class="user-moderator-N"><span itemprop="name">konrad-ch</span></a></span>
            <time itemprop="dateCreated" datetime="2016-12-12T13:44:51-07:00">Dec '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-12-12T13:44:51-07:00">Dec '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>500</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/8cb5cd99ebb27b4c1399c55c77793cdd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/8749/konrad-ch" class="user-moderator-N"><span itemprop="name">konrad-ch</span></a></span>
                <span class="karma">645</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C15007" href="#C15007">
        <time class="action-date">Dec '16</time>
    </a>
</div>
<div class="post-content"><div><p>So Phalcon is nice with its level of abstraction that &quot;hides&quot; sql queries to the level that we can forget we even use them. But when I actually checked how much queries one of my pages executes when loading paginated records (100 per page) the result was around 500... The queries were generated mostly due to simple relations (belongsTo / hasMany in model) because for every record i must fetch some details from another models.
Is that many queries &quot;normal&quot;? Or should I find another way for loading my records, for example with multiple joins?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-df8acb037f7757fa3b33e549-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-df8acb037f7757fa3b33e549-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C43831" href="#C43831">
                <time itemprop="dateCreated" datetime="2016-12-12T15:18:40-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What metadata adapter you are using ? Are you using query builder ? If not - start using it. It's like any other orm - if you don't do join, then framework will need to make queries. For example let's assume you have 1-n relation. Categories have products. For example we have 100 categories, each having 500 queries. If we don't make joins then we need 100 additional queries for each category to get their products.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="43831" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="43831" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8cb5cd99ebb27b4c1399c55c77793cdd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/8749/konrad-ch" class="user-moderator-N"><span itemprop="name">konrad-ch</span></a>        </span>
        <br>

        <span class="karma">645</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C43833" href="#C43833">
                <time itemprop="dateCreated" datetime="2016-12-12T16:26:46-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I load most of the data with query builder and then i use model relations with params. For example i load some messages and then for every message i display author nickname only when he is &quot;active user&quot; (using relation with alias ActiveUser). if i had to use only builder for that, then i will have to join User table with a appriopriate condition. but then i can't store logic for what makes an active user nicely in relation param :(</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="43833" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="43833" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C43835" href="#C43835">
                <time itemprop="dateCreated" datetime="2016-12-12T17:10:50-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Class Phalcon\Mvc\Model represents the implementation of ActiveRecord (ORM), that's what it is under the hood.</p>
<p>So at the end of the day, RDBMS will be the culprit in each application. That's why I try to avoid as much as I can any ORM out there. When I see 100's of queries instead of 2-3... but that's what it is with ORM.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="43835" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="43835" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C43841" href="#C43841">
                <time itemprop="dateCreated" datetime="2016-12-13T01:51:09-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Then as i wrote - try to use query builder more to select author nickname with <code>join/group_concat</code> or something. This is normal thing and will happen in all orm.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="43841" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="43841" data-cf-modified-df8acb037f7757fa3b33e549-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="15007" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>