---
layout: default
title: 'Phalcon\Assets\Manager outputInlineJs() method. How it works? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon\Assets\Manager outputInlineJs() method. How it works?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/3520/SevaJmurov" class="user-moderator-N"><span itemprop="name">Seva Jmurov</span></a></span>
            <time itemprop="dateCreated" datetime="2016-12-27T12:50:12-07:00">Dec '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-12-27T12:50:12-07:00">Dec '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">1</span>
                </td>
                <td>
                    <label>Views</label><br>450</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/f5c6ce717e91b110b115c9353611c070?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/3520/SevaJmurov" class="user-moderator-N"><span itemprop="name">Seva Jmurov</span></a></span>
                <span class="karma">15.9k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C15151" href="#C15151">
        <time class="action-date">Dec '16</time>
    </a>
</div>
<div class="post-content"><div><p>According to my expectations, after I read oficial docs, this method should serve all js from my collection as single string with code enclosed in &lt;script&gt; tags, however in my case it just returns empty string for non empty collection. </p>
<p>outputJs() for the same collection returns &lt;script&gt; tags with paths to included files in src attributes, in other words works as expected.</p>
<p>By the way, do I understand correctly that this <a href="https://forum.phalcon.io/discussion/640/assets-minification-regenerated-every-time-">Assets minification, regenerated every time?</a> is still true?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-7409ac93ecc597bc5d490cff-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-7409ac93ecc597bc5d490cff-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/f5c6ce717e91b110b115c9353611c070?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3520/SevaJmurov" class="user-moderator-N"><span itemprop="name">Seva Jmurov</span></a>        </span>
        <br>

        <span class="karma">15.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C44431" href="#C44431">
                <time itemprop="dateCreated" datetime="2016-12-29T13:50:34-07:00" class="action-date">Dec '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Well, it appeared that this is normal <a href="https://github.com/phalcon/cphalcon/issues/12512#issuecomment-269674915">behaviour</a> of outputInlineJs()</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="44431" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="44431" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/9f6f645165b73234041f0536a2e618c8?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4721/darxed" class="user-moderator-N"><span itemprop="name">darxed</span></a>        </span>
        <br>

        <span class="karma">3.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C44655" href="#C44655">
                <time itemprop="dateCreated" datetime="2017-01-05T08:23:29-07:00" class="action-date">Jan '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>About the assets, well I don't know if it still regenerates every time, but I built a function to calculate the name for the minified import, works like this:</p>
<pre><code> private static function getDateName($resources, $importpath) {
    $ret = "";
    foreach ($resources as $resource) {
        $file = $importpath . str_replace("//", "/", $resource-&gt;getPath());
        if (filemtime($file) !== FALSE) {
            $ret .= date("YmdHis", filemtime($file)) . $file;
        }
    }
    return md5($ret);
}</code></pre>
<p>$resources comes from $this-&gt;assets-&gt;collection(). So your filename for the minified will be the md5 of the concatenation of the modified dates of all your files. That way, you only hash once per request and if there's been no change, you can just use the file you have or if it's changed, you call your minify logic again and save the new minified file with that name.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="44655" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="44655" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/f5c6ce717e91b110b115c9353611c070?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3520/SevaJmurov" class="user-moderator-N"><span itemprop="name">Seva Jmurov</span></a>        </span>
        <br>

        <span class="karma">15.9k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C44655"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img  src="https://secure.gravatar.com/avatar/9f6f645165b73234041f0536a2e618c8?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        darxed                    </a>
                </div><div class="posts-buttons" align="right"><a name="C45075" href="#C45075">
                <time itemprop="dateCreated" datetime="2017-01-18T07:11:11-07:00" class="action-date">Jan '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Nice solution for problem with assets regeneration, yes, it currently still exists, and it ruins some of client caching techniques. Thank you for sharing.</p>
<blockquote>
<p>About the assets, well I don't know if it still regenerates every time, but I built a function to calculate the name for the minified import, works like this:</p>
<pre><code>private static function getDateName($resources, $importpath) {
   $ret = "";
   foreach ($resources as $resource) {
       $file = $importpath . str_replace("//", "/", $resource-&gt;getPath());
       if (filemtime($file) !== FALSE) {
           $ret .= date("YmdHis", filemtime($file)) . $file;
       }
   }
   return md5($ret);</code></pre>
<p>}</p>
<p>$resources comes from $this-&gt;assets-&gt;collection(). So your filename for the minified will be the md5 of the concatenation of the modified dates of all your files. That way, you only hash once per request and if there's been no change, you can just use the file you have or if it's changed, you call your minify logic again and save the new minified file with that name.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="45075" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="45075" data-cf-modified-7409ac93ecc597bc5d490cff-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="15151" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>