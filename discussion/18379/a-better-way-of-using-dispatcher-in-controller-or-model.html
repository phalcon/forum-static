---
layout: default
title: 'A Better Way of Using Dispatcher in Controller or Model ? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">A Better Way of Using Dispatcher in Controller or Model ?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/8989/LearnPhalcon" class="user-moderator-N"><span itemprop="name">LearnPhalcon</span></a></span>
            <time itemprop="dateCreated" datetime="2018-06-08T19:10:37-07:00">Jun '18</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2018-06-08T19:10:37-07:00">Jun '18</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Aug '18</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>386</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/2e309726888b878103afb13ec0146683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/8989/LearnPhalcon" class="user-moderator-N"><span itemprop="name">LearnPhalcon</span></a></span>
                <span class="karma">9.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C18379" href="#C18379">
        <time class="action-date">Jun '18</time>
    </a>
</div>
<div class="post-content"><div><p>This is how I use it now in my custom Library or Model. Is there a better way to use Dispatcher anywhere in my project without having to always reuse <code>$di = \Phalcon\DI::getDefault();</code> and <code>$dp = $di['dispatcher'];</code> anywhere I need to call <code>getControllerName()</code> ?</p>
<pre><code class="language-php">function test() {
  $di = \Phalcon\DI::getDefault();
  $dp = $di['dispatcher'];
  return $dp-&gt;getControllerName();
} #test</code></pre>
<p>Please provide some snippet code examples when possible. Thank you so much!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-93afa66d35e5e6959e99584c-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-93afa66d35e5e6959e99584c-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Åšlawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C56021" href="#C56021">
                <time itemprop="dateCreated" datetime="2018-06-09T00:14:31-07:00" class="action-date">Jun '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yea, extends Injectable and add your class as a service and you can just access it using <code>$this-&gt;dispatcher</code></p>
<p>Also you are missing public/private/protected keyword.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="56021" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="56021" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9e1c02d47ce2ef87cd037828c840a47a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3738/jcdude" class="user-moderator-N"><span itemprop="name">Jed Fletcher</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C56041" href="#C56041">
                <time itemprop="dateCreated" datetime="2018-06-11T06:33:22-07:00" class="action-date">Jun '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hello</p>
<p>If you have a look at what your controller extends it has DI injection available in it by default.</p>
<p>abstract class Controller extends \Phalcon\Di\Injectable</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="56041" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="56041" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="56093" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '18</span>
              </span><br/><a name="C56093" href="#C56093">
                <time itemprop="dateCreated" datetime="2018-06-13T07:56:50-07:00" class="action-date">Jun '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I have a trait that can be included in models (and wherever else it's needed) that give a shortcut to the DI.  I'm not sure if it's ideal, but it works.</p>
<pre><code class="language-php">&lt;?PHP
/**
 * This file contains the "DI" trait.
 */

namespace Traits;

/**
 * This trait contains methods for simplifying access to the Dependency Injector.
 */
trait DI{
    /**
     * Shortcut function for accessing the Dependency Injector (DI) and its contents
     * 
     * ####Example usage
     * * `di()` - returns the DI
     * * `di('router)` - returns the router in the DI
     * * `di('router',['user'])` - retrieves the router from the DI, passing 'user' as the first parameter
     * 
     * @param string $thing_in_di **[OPTIONAL]**    If provided, causes the method to return that item in the DI, rather than the DI itself
     * @param array $parameters_for_thing **[OPTIONAL]** If provided, passes the parameters on to the closure method for creating the thing
     * @return mixed result of diBody()
     */
    public function di($thing_in_di=NULL,$parameters_for_thing=NULL){
        return self::diBody($thing_in_di,$parameters_for_thing);
    }

    /**
     * Shortcut function for accessing the DI and its contents, in a static way
     * @param string $thing_in_di **[OPTIONAL]**    If provided, causes the method to return that item in the DI, rather than the DI itself
     * @param array $parameters_for_thing **[OPTIONAL]** If provided, passes the parameters on to the closure method for creating the thing
     * @return mixed result of diBody()
     */
    public static function diStatic($thing_in_di=NULL,$parameters_for_thing=NULL){
        return self::diBody($thing_in_di,$parameters_for_thing);
    }

    /**
     * Body of di() and diStatic() methods
     * @param string $thing_in_di **[OPTIONAL]**    If provided, causes the method to return that item in the DI, rather than the DI itself
     * @param array $parameters_for_thing **[OPTIONAL]** If provided, passes the parameters on to the closure method for creating the thing
     * @return \Phalcon\Di|mixed    Either the DI container, or a particular service
     */
    private static function diBody($thing_in_di=NULL,$parameters_for_thing=NULL){
        if($thing_in_di == NULL){
            return \Phalcon\DI::getDefault();
        }
        else{
            return \Phalcon\DI::getDefault()-&gt;get($thing_in_di,$parameters_for_thing);
        }
    }
}</code></pre>
<p>In bootstrap.php, I've set up namespace autoloading to load from the proper <code>traits/</code> directory.</p>
<p>Then in the model:</p>
<pre><code class="language-php">use \Traits\DI;</code></pre>
<p>and</p>
<pre><code class="language-php">$this-&gt;di('dispatcher')-&gt;getControllerName()</code></pre>
<p>As a side note - you really shouldn't be trying to retrieve the controller name from the model - the model shouldn't care what the controller is.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="56093" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="56093" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/757d47a4438a9e7c6637f1918f5d9ccb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/11543/javaschoo" class="user-moderator-N"><span itemprop="name">javaschoo</span></a>        </span>
        <br>

        <span class="karma">102</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C57079" href="#C57079">
                <time itemprop="dateCreated" datetime="2018-08-20T21:49:38-07:00" class="action-date">Aug '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>when you don't create things, you become def<a href="https://www.welookups.com">ine</a>d by your tastes rather than ability. your tastes only narrow &amp; exclude people. so create</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="57079" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="57079" data-cf-modified-93afa66d35e5e6959e99584c-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="18379" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>