---
layout: default
title: 'Ajax save model - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Ajax save model</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a></span>
            <time itemprop="dateCreated" datetime="2016-05-09T05:52:47-07:00">May '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-05-09T05:52:47-07:00">May '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">8</span>
                </td>
                <td>
                    <label>Views</label><br>855</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a></span>
                <span class="karma">41.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11467" href="#C11467">
        <time class="action-date">May '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hi,</p>
<p>When i'm trying to save my model like this <code>if( !$myModel-&gt;save() )</code> I have to surround in try catch my condition if I want to get the errors messages... I can't check if the save() is false, because this will not returns the errors.</p>
<p>How can I do to get <code>$myModels-&gt;getMessages()</code> without using try catch ?</p>
<p>I want to do like this <a href="https://docs.phalcon.io/en/latest/reference/models.html#creating-updating-records">example</a>.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/00181d5fcdb104adae9f28014867b509?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/6925/stratoss" class="user-moderator-N"><span itemprop="name">Stanimir Stoyanov</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33759" href="#C33759">
                <time itemprop="dateCreated" datetime="2016-05-09T06:30:50-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Can you post your model? I think you you're missing some validation or relation.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33759" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33759" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="33761" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C33761" href="#C33761">
                <time itemprop="dateCreated" datetime="2016-05-09T06:34:15-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't have  validations in my model :/ But relations are ok. Actually the errors is that I sent bad datetime format but I seen this error with a try catch. I can't return json_encode because there is a crash on my condition if I remove my try catch.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33761" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33761" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/00181d5fcdb104adae9f28014867b509?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/6925/stratoss" class="user-moderator-N"><span itemprop="name">Stanimir Stoyanov</span></a>        </span>
        <br>

        <span class="karma">3.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33765" href="#C33765">
                <time itemprop="dateCreated" datetime="2016-05-09T06:44:45-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/discussion/3123/custom-date-validator">This thread</a> could be useful then.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33765" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33765" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33769" href="#C33769">
                <time itemprop="dateCreated" datetime="2016-05-09T06:53:35-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok so I have to implement all validations.</p>
<p>I'll do that, thanks.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33769" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33769" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C33789" href="#C33789">
                <time itemprop="dateCreated" datetime="2016-05-10T03:10:03-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I actually created exception. When save/create/delete can't happen for some reason i throw it and it returns reponse with error messages and then value for dispatcher in beforeException is setted for this response and dispatch loop is executed - this way i have returned response with error messages(in json in my case) and i don't have to have additional boilerplate code in every app.</p>
<p>Well another way can be to throw this exception even in save/create/delete etc of model method if it fails.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="33789" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="33789" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C33789"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Wojciech Ślawski                    </a>
                </div><div class="posts-buttons" align="right"><a name="C34525" href="#C34525">
                <time itemprop="dateCreated" datetime="2016-05-24T02:15:56-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Wojciech Ślawski could you give me a code snippet for this please ?</p>
<blockquote>
<p>I actually created exception. When save/create/delete can't happen for some reason i throw it and it returns reponse with error messages and then value for dispatcher in beforeException is setted for this response and dispatch loop is executed - this way i have returned response with error messages(in json in my case) and i don't have to have additional boilerplate code in every app.</p>
<p>Well another way can be to throw this exception even in save/create/delete etc of model method if it fails.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34525" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34525" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="34527" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C34527" href="#C34527">
                <time itemprop="dateCreated" datetime="2016-05-24T02:51:33-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hmm, fine, this is exception for example:</p>
<pre><code class="language-php">&lt;?php
/**
 * Created by PhpStorm.
 * User: User
 * Date: 12.05.16
 * Time: 15:35
 */
namespace Suzuki\App\Exceptions;

use Exception;
use Phalcon\Di;
use Phalcon\Http\Request;
use Phalcon\Http\Response;
use Phalcon\Mvc\Model;
use Phalcon\Mvc\Model\Message;
use Phalcon\Queue\Beanstalk;
use Suzuki\App\Interfaces\ResponseExceptionInterface;

class ModelException extends Exception implements ResponseExceptionInterface
{
    /**
     * @var Model
     */
    protected $model;

    /**
     * @var array
     */
    protected $messages;

    /**
     * @param string $message
     * @param int $code
     * @param Exception|null $previous
     * @param Model $model
     */
    public function __construct($message, $code = 0, Exception $previous = null, Model $model)
    {
        parent::__construct($message, $code, $previous);
        $this-&gt;model = $model;
        $di = Di::getDefault();
        $dispatcher = $di-&gt;get('dispatcher');
        /** @var Beanstalk $queueLog */
        $queueLog = $di-&gt;get('queue');
        $queueLog-&gt;choose('log');
        $queueLog-&gt;put([
            'type' =&gt; 'modelException',
            'message' =&gt; "
                Can't save/delete/update/create model of class " . get_class($model) . " due to certain validation messages:" . PHP_EOL .
                json_encode($this-&gt;getMessages()) . PHP_EOL .
                "Model data:" . json_encode($model-&gt;toArray()) . PHP_EOL .
                PHP_EOL .
                'URL: ' . $di-&gt;get('request')-&gt;getURI() . PHP_EOL .
                'Module name:' . $dispatcher-&gt;getModuleName() . PHP_EOL .
                'Controller name:' . $dispatcher-&gt;getControllerName() . PHP_EOL .
                'Action name:' . $dispatcher-&gt;getActionName() . PHP_EOL .
                'Params:' . json_encode($dispatcher-&gt;getParams()) . PHP_EOL .
                'POST:' . json_encode($_POST) . PHP_EOL .
                'JSON:' . json_encode($di-&gt;get('request')-&gt;getJsonRawBody(true)) . PHP_EOL .
                'User id:' . $di-&gt;get('session')-&gt;get('user') . PHP_EOL .
                'IP:' . $di-&gt;get('request')-&gt;getClientAddress() . PHP_EOL .
                '============================================================='
        ]);
    }

    private function getMessages()
    {
        if (empty($this-&gt;messages)) {
            $messages = [];
            /** @var Message $message */
            foreach ($this-&gt;model-&gt;getMessages() as $message) {
                $messages += [(string)$message-&gt;getField() =&gt; $message-&gt;getMessage()];
            }
            $this-&gt;messages = $messages;
        }
        return $this-&gt;messages;
    }

    /**
     * @param string $message
     * @param Model $model
     * @return ModelException
     */
    public static function create($message, $model)
    {
        return new ModelException($message, 0, null, $model);
    }

    /**
     * @return string
     */
    public function __toString()
    {
        return __CLASS__ . ": [{$this-&gt;code}]: {$this-&gt;message}\n";
    }

    /**
     * @return Response
     */
    public function getResponse()
    {
        $response = new Response();
        $messages = $this-&gt;getMessages();
        return $response-&gt;setJsonContent(['error' =&gt; $this-&gt;message, 'result' =&gt; $messages]);
    }
}</code></pre>
<p>Then somewhere in code:</p>
<pre><code class="language-php">if(!$model-&gt;save()){
    throw ModelException::create("Can't update model", $model);
}</code></pre>
<p>And in dispatcher(im going to move this to seperated class perhaps):</p>
<pre><code class="language-php">di-&gt;set('dispatcher', function () use ($config, $di) {
    //Create an event manager
    $eventsManager = new Manager();
    //Attach a listener for type "dispatch"
    $eventsManager-&gt;attach(
        "dispatch",
        function (Event $event, Dispatcher $dispatcher, Exception $exception) use ($di) {
        // some code
        if($event-&gt;getType() == 'beforeException') {
            if($exception instanceof ResponseExceptionInterface) {
                        $dispatcher-&gt;setReturnedValue($exception-&gt;getResponse());
                        return false;
                    }
            }
        }
    }</code></pre>
<p>Also im using queue to do writing to logs, so it doesn't doing it when returning response.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34527" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34527" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C34529" href="#C34529">
                <time itemprop="dateCreated" datetime="2016-05-24T03:00:00-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks man, this is very nice. I like this way</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34529" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34529" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="34705" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C34705" href="#C34705">
                <time itemprop="dateCreated" datetime="2016-05-26T00:50:42-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I noticed something. This will not working in my project becaise I can't check if the save() is false as you :</p>
<pre><code>if(!$model-&gt;save()){
    throw ModelException::create("Can't update model", $model);
}</code></pre>
<p>My save model is never false because when I have a problem in the save, this will returns  Error 500 on this line <code>if(!$model-&gt;save()){</code> and this is the issue of this topic. I don't know why. I tried to put this in my bootstrap file : </p>
<pre><code>\Phalcon\Mvc\Model::setup(array(    
    'notNullValidations' =&gt; false
));</code></pre>
<p>But there is no changes.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34705" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34705" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="34709" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C34709" href="#C34709">
                <time itemprop="dateCreated" datetime="2016-05-26T00:52:27-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>But what exception you have ? You didn't even post it here. It must be problem somewhere else with your code(like validation method)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34709" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34709" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C34733" href="#C34733">
                <time itemprop="dateCreated" datetime="2016-05-26T05:29:42-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I have this : </p>
<pre><code>#0 [internal function]: PDOStatement-&gt;execute()\n#1 [internal function]: Phalcon\\Db\\Adapter\\Pdo-&gt;executePrepared(Object(PDOStatement), Array, Array)\n#2 [internal function]: Phalcon\\Db\\Adapter\\Pdo-&gt;execute('INSERT INTO `cu...', Array, Array)\n#3 [internal function]: Phalcon\\Db\\Adapter-&gt;insert('customers', Array, Array, Array)\n#4 [internal function]: Phalcon\\Mvc\\Model-&gt;_doLowInsert(Object(Phalcon\\Mvc\\Model\\MetaData\\Memory), Object(Phalcon\\Db\\Adapter\\Pdo\\Mysql), 'customers', 'id')\n#5 Phalcon\\Mvc\\Model-&gt;save()\n#6 [internal function]: Apps\\Master\\Controllers\\CustomersController-&gt;addAction()\n#7 [internal function]: Phalcon\\Dispatcher-&gt;dispatch()\n#8 : Phalcon\\Mvc\\Application-&gt;handle()\n#9

SQLSTATE[HY000]: General error: 1366 Incorrect string value: '\\xF0\\x9F\\x98\\x81\\xF0\\x9F...' for column 'firstname' at row 1
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34733" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34733" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C34753" href="#C34753">
                <time itemprop="dateCreated" datetime="2016-05-26T07:43:09-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It looks like some charset problems maybe ? Show us the rest of code where you setting model(with what)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34753" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34753" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6003c6340c95be89eb57aa50a7cf5beb?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4627/Johngtrs" class="user-moderator-N"><span itemprop="name">Jonathan Vandal</span></a>        </span>
        <br>

        <span class="karma">41.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="34775" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C34775" href="#C34775">
                <time itemprop="dateCreated" datetime="2016-05-27T01:12:16-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes I have this errors when I put emoji in my form inputs with my smarthphone. I don't have validations in my models, but I thought that the save method returns false if there is any error even the model hasn't validations function. My model looks like this :</p>
<pre><code>&lt;?php
namespace Apps\Common\Models;

use Phalcon\Mvc\Model;

class Customers extends Model {

    public $id;
    public $code;
    public $firstname;
    public $familyname;
    public $email;
    public $archive;
    public $customer_infos;

    public function initialize() {

        $this-&gt;hasMany("id", "Apps\Common\Models\Contracts", "id_customer");

        $this-&gt;skipAttributes(array("customer_infos"));

    }

    public function afterFetch() {

        $this-&gt;customer_infos = $this-&gt;firstname." ".$this-&gt;familyname.", ".$this-&gt;email;

    }

}</code></pre>
<p>In my controller :</p>
<pre><code>$customer = new Customers;
$customer-&gt;firstname = $firstname;
$customer-&gt;familyname = $familyname;
$customer-&gt;email = $email;

if( !$customer-&gt;save() ){
    $tools-&gt;checkErrors($customer);
    return;
}</code></pre>
<p>checkErrors function :</p>
<pre><code>    public function checkErrors($object){
      $messages = "";

      foreach ($object-&gt;getMessages() as $message) {
        $messages .= $message.' -- ';
      };

      error_log('Error DB : '.$messages);
      return;
    }</code></pre>
<p>The checkErrors function isn't call because the save() doesn't return false.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34775" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34775" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="34789" data-toggle="modal" data-target="#historyModal">
                edited <span>May '16</span>
              </span><br/><a name="C34789" href="#C34789">
                <time itemprop="dateCreated" datetime="2016-05-27T02:11:50-07:00" class="action-date">May '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Isn't called beacause you have PDO exception - it can't be inserted. Just fix this exception. I don't know what's doing it - i guess it's about charset in database perhaps ? Tu support emoji in mysql you need to use <code>utf8mb4</code></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="34789" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="34789" data-cf-modified-fd582fc4bbd4b11148e6d38a-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11467" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>