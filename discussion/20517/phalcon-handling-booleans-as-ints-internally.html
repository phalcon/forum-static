---
layout: default
title: 'Phalcon handling booleans as ints internally - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon handling booleans as ints internally</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4413/Firzenizer" class="user-moderator-N"><span itemprop="name">Tomi Ruusala</span></a></span>
            <time itemprop="dateCreated" datetime="2020-04-09T05:11:33-07:00">Apr '20</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2020-04-09T05:11:33-07:00">Apr '20</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>174</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/84525ce8ab37cc06caab1ea6d9f8b492?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4413/Firzenizer" class="user-moderator-N"><span itemprop="name">Tomi Ruusala</span></a></span>
                <span class="karma">7.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C20517" href="#C20517">
        <time class="action-date">Apr '20</time>
    </a>
</div>
<div class="post-content"><div><p>I am having trouble with phalcon not being able to handle booleans properly. I am trying to create a change log, that contains data that has been changed.</p>
<p>When I use $this-&gt;getOldSnapshotData() in model to get old data boolean fields are stored as INTs. And $this-&gt;getUpdatedFields() is reporting all booleans as changed always. And as they are typed properties in the model the actual new values are booleans. Is there any way to fix this?</p>
<p>The properties are defined like this in the model.
public ?bool $isActive = null;
I am not using setters / getters if that matters.
I am using Phalcon version 4.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C62717" href="#C62717">
                <time itemprop="dateCreated" datetime="2020-04-09T09:12:46-07:00" class="action-date">Apr '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This data is being fed from the database right?  MariaDB/MySQL doesn't have a boolean type, it uses 1 &amp; 0.  Typically what I do is put some code in <code>afterFetch()</code> to convert from 1/0 to true/false, and some code in <code>beforeSave()</code> to convert vice versa.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="62717" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="62717" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/84525ce8ab37cc06caab1ea6d9f8b492?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4413/Firzenizer" class="user-moderator-N"><span itemprop="name">Tomi Ruusala</span></a>        </span>
        <br>

        <span class="karma">7.4k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C62717"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Dylan Anderson                    </a>
                </div><div class="posts-buttons" align="right"><a name="C62777" href="#C62777">
                <time itemprop="dateCreated" datetime="2020-04-13T23:53:53-07:00" class="action-date">Apr '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>This data is being fed from the database right?  MariaDB/MySQL doesn't have a boolean type, it uses 1 &amp; 0.  Typically what I do is put some code in <code>afterFetch()</code> to convert from 1/0 to true/false, and some code in <code>beforeSave()</code> to convert vice versa.</p>
</blockquote>
<p>Yes we are using MariaDB and I know how it works internally. Our problem might be, type conversions thou. We are using our custom validator from another project. It converts types before validating. And the validation is not ran for the snapshots obviously. We might have to rearrange that a bit.</p>
<p>Thanks anyways. I think this might solve our problem. Althou I created a quick workaround for this already. It checks all fields in getUpdatedFields() then validates those changes against the data, so it can filter out these changes where true !== 1 on boolean fields.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="62777" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="62777" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/84525ce8ab37cc06caab1ea6d9f8b492?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4413/Firzenizer" class="user-moderator-N"><span itemprop="name">Tomi Ruusala</span></a>        </span>
        <br>

        <span class="karma">7.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C62781" href="#C62781">
                <time itemprop="dateCreated" datetime="2020-04-14T00:48:25-07:00" class="action-date">Apr '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Did some testing and it seems afterFetch() is not called for snapshots. So both $this-&gt;getOldSnapshotData() and $this-&gt;getUpdatedFields() return ints. Are there some other methods that could be used?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="62781" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="62781" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="62807" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '20</span>
              </span><br/><a name="C62807" href="#C62807">
                <time itemprop="dateCreated" datetime="2020-04-14T08:11:09-07:00" class="action-date">Apr '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>So you're setting <code>isActive</code> to <code>true</code> (or <code>false</code>), saving the record, then finding <code>isActive</code> is <code>1</code> or <code>0</code>?</p>
<p>It would appear, then, that PDO is converting <code>true</code>/<code>false</code> to <code>1</code>/<code>0</code> before executing the save query - and that the snapshots are being created from that converted data, not the data that is being sent to PDO.</p>
<p>I'd maybe file a bug report on GitHub - the developers tend to be more active there than here and they might have more insight.</p>
<p>If you don't want to use getters &amp; setters, then you may be able to overwrite <code>__set()</code>.  Phalcon defines its own, but you could write your own that keeps track of changes yourself:</p>
<pre><code class="language-php">public function __set($name,$newValue){
    $oldValue = $this-&gt;{$name};
    if($oldValue !== $newValue){
        $this-&gt;changedValues[$name] = $oldValue;
    }

    parent::__set($name,$newValue);
}</code></pre>
<p>Then you could:</p>
<pre><code class="language-php">$MyObject-&gt;isActive = true;
...
$changedFields = $MyObject-&gt;changedValues;</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="62807" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="62807" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/84525ce8ab37cc06caab1ea6d9f8b492?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4413/Firzenizer" class="user-moderator-N"><span itemprop="name">Tomi Ruusala</span></a>        </span>
        <br>

        <span class="karma">7.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C62843" href="#C62843">
                <time itemprop="dateCreated" datetime="2020-04-17T01:02:58-07:00" class="action-date">Apr '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I have my own system in place already for getting the changes. I gotta see, if I have time to file a report and maybe they can fix this.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="62843" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="62843" data-cf-modified-1f55e1678ec1cd3153fd9d6f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="20517" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>