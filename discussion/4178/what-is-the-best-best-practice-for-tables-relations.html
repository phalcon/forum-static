---
layout: default
title: 'what is the best best practice for tables relations - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">what is the best best practice for tables relations</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/1107/mohamedragabdahab" class="user-moderator-N"><span itemprop="name">Mohamed Ragab Dahab</span></a></span>
            <time itemprop="dateCreated" datetime="2014-12-04T07:41:43-07:00">Dec '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-12-04T07:41:43-07:00">Dec '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>1160</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/ef3aa5b24a9b86e70e0914322853ee43?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/1107/mohamedragabdahab" class="user-moderator-N"><span itemprop="name">Mohamed Ragab Dahab</span></a></span>
                <span class="karma">7.9k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C4178" href="#C4178">
        <time class="action-date">Dec '14</time>
    </a>
</div>
<div class="post-content"><div><p>Our database administrator asked me to drop all the relation between the tables in the database, and replace in code, meaning create the relation in php code instead of inside the DB itself.</p>
<p>Example:
$this-&gt;belongsTo('id','App\Request','request_id',
[
'foreignKey'=&gt; [
'action'=&gt;\Phalcon\Mvc\Model\Relation::ACTION_CASCADE
]
]
);</p>
<p>We both bad a long debate regarding this, the main key of the debate was was the performance and data source best usage.</p>
<p>the question is whis is better regarding performance? a real db relation or doing this in coding?<a href="https://forum.phalcon.io/user/1/phalconphp">
@phalconphp</a><a href="https://forum.phalcon.io/user/1/phalcon"> @phalcon</a></p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-b29737f0a4e8b3132e38139f-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-b29737f0a4e8b3132e38139f-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1320/tztztztz" class="user-moderator-N"><span itemprop="name">Tomasz Zadora</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="13900" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '14</span>
              </span><br/><a name="C13900" href="#C13900">
                <time itemprop="dateCreated" datetime="2014-12-04T08:12:54-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Performance: it is always faster and safer, if database engine manage foreign keys integrity, and do appropriate actions in DB triggers</p>
<p>Flexibility: doing it on php/orm side gives you more flexibility at cost of performance</p>
<p>Choose what is better for Your project.</p>
<p>PS. If you want to do it on DB side, IMHO PostgreSQL i better choice than MySQL</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13900" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13900" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13907" href="#C13907">
                <time itemprop="dateCreated" datetime="2014-12-04T08:57:18-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You might want to use virtual foreign keys instead of native foreign keys when:</p>
<ul>
<li>You want to handle better errors related to foreign key integrity in the application layer rather than directly in the database </li>
<li>You want to speed up the application by checking foreign keys against a cached results in memcached or redis instead of the relational database server (performance)</li>
<li>You have models that map to tables in different servers or database systems without concerns on data integrity (scalability)</li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13907" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13907" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1320/tztztztz" class="user-moderator-N"><span itemprop="name">Tomasz Zadora</span></a>        </span>
        <br>

        <span class="karma">10.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13908" href="#C13908">
                <time itemprop="dateCreated" datetime="2014-12-04T09:01:37-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>You want to speed up the application by checking foreign keys against a cached results in memcached or redis instead of the relational database server
(performance)</p>
</blockquote>
<p>That's risky, what if DB is changed externally?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13908" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13908" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C13908"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/07dedd51671291aca4f3f84a115c534e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Tomasz Zadora                    </a>
                </div><div class="posts-buttons" align="right"><a name="C13909" href="#C13909">
                <time itemprop="dateCreated" datetime="2014-12-04T09:04:24-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes, you have to design a caching strategy only on those tables that rarely change and implement the right purge when needed</p>
<blockquote>
<blockquote>
<p>You want to speed up the application by checking foreign keys against a cached results in memcached or redis instead of the relational database server
(performance)</p>
</blockquote>
<p>That's risky, what if DB is changed externally?</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13909" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13909" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d0d38bb2fe6ddd4995064a1a9d911328?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/656/brandonlamb" class="user-moderator-N"><span itemprop="name">Brandon Lamb</span></a>        </span>
        <br>

        <span class="karma">2.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C13972" href="#C13972">
                <time itemprop="dateCreated" datetime="2014-12-08T00:35:45-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Makes me think YAGNI. If you are experiencing application performance issues due to your database implementing referential integrity, you probably have bigger issues to deal with.</p>
<p>Database are designed to enforce relations, do joins, optimize, yadda yadda. While you can certainly fall into anti-patterns and abuse features, definitely use proper, consistent table/column naming, add proper indexes and foreign key relations, etc.</p>
<p>Personally I have found that I tend to use mostly just the query builder feature of ORM libraries instead of string concat with lots of if statements to build a query.</p>
<p>Dont design your database around your application programming language limitations if you can help it. You dont have to be a purist either though.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="13972" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="13972" data-cf-modified-b29737f0a4e8b3132e38139f-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="4178" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>