---
layout: default
title: 'Invo Database Connection - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/29/database">Database</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Invo Database Connection</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/3873/SteveRepp" class="user-moderator-N"><span itemprop="name">Steve Repp</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-30T11:10:47-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-30T11:10:47-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Aug '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>552</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/c36b9b62ec59d4a25f85443f0438858c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/3873/SteveRepp" class="user-moderator-N"><span itemprop="name">Steve Repp</span></a></span>
                <span class="karma">7.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7889" href="#C7889">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>I am using the Invo example and curious about how to handle DB Connections within models/controllers.</p>
<p>I know the services.php file defines a connection; but how would one execute a direct SQL query from one (PHQL approach is known, I am trying the direct query approach in this case...)</p>
<p>Do I need to explicitly define a connection instance on the model init?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21401" href="#C21401">
                <time itemprop="dateCreated" datetime="2015-07-30T19:30:52-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can always use <a href="https://php.net/manual/en/book.pdo.php">pdo</a> or <a href="https://php.net/manual/en/book.mysqli.php">mysqli</a> to connect if you want to directly query w/ php.  You can use this anywhere in your php code.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21401" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21401" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c36b9b62ec59d4a25f85443f0438858c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3873/SteveRepp" class="user-moderator-N"><span itemprop="name">Steve Repp</span></a>        </span>
        <br>

        <span class="karma">7.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="21409" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C21409" href="#C21409">
                <time itemprop="dateCreated" datetime="2015-07-31T03:54:55-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think my question is changing as I read more into Phalcon. More specifics follow:</p>
<p>Currently using FactoryDefault, not di. </p>
<p>Question part one is, once a db conn is defined in services.php as it is in Invo, does it need to be assigned within the models or is it globally available. Looks like it is an anonymous function, so I think it should be; but then how to call it?</p>
<p>Second; if it does need to be explicitly defined in a model, would it be advisable to create a ModelBase class, define the connection in the init function, and then inherit?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21409" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21409" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21465" href="#C21465">
                <time itemprop="dateCreated" datetime="2015-08-01T12:11:31-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Without looking at your services.php file, I can't say for sure.  If it is set up like Invo, then yes... You can access it from anywhere.  Here is a thread that explains raw queries:</p>
<p><a href="https://forum.phalcon.io/discussion/2417/use-raw-queries-in-phalconphp">https://forum.phalcon.io/discussion/2417/use-raw-queries-in-phalconphp</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21465" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21465" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c36b9b62ec59d4a25f85443f0438858c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3873/SteveRepp" class="user-moderator-N"><span itemprop="name">Steve Repp</span></a>        </span>
        <br>

        <span class="karma">7.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21483" href="#C21483">
                <time itemprop="dateCreated" datetime="2015-08-01T20:37:42-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for the response. Trying to work with the examples on that link. Getting some odd results. Ex: Just trying to print out the DI Object to verify the DB ibject exists fails with:</p>
<p>Notice:  Undefined variable: di in /Library/WebServer/Documents/Cyclone/app/controllers/IndexController.php on line 41</p>
<p>echo(&quot;&lt;pre&gt;&quot;);
print_r($di);
echo(&quot;&lt;/pre&gt;&quot;);
die;</p>
<p>However: this works and shows the DB object:</p>
<p>echo(&quot;&lt;pre&gt;&quot;);
print_r(<strong>$this-&gt;di</strong>);
echo(&quot;&lt;/pre&gt;&quot;);
die;</p>
<p>Yet, this later example fails with an empty result it I try something like:
$this-&gt;di-&gt;getDB();</p>
<p>I must be missing something. But what?!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21483" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21483" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c36b9b62ec59d4a25f85443f0438858c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3873/SteveRepp" class="user-moderator-N"><span itemprop="name">Steve Repp</span></a>        </span>
        <br>

        <span class="karma">7.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21489" href="#C21489">
                <time itemprop="dateCreated" datetime="2015-08-02T05:17:21-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>So, I hve figured this out:</p>
<p>In my ControllerBase I have the following in my initialize function:
$this-&gt;di = \Phalcon\DI\FactoryDefault::getDefault();</p>
<p>And in my IndexController I have this to get a single record:
$story = $this-&gt;di[&quot;db&quot;]-&gt;fetchOne(&quot;CALL <code>test</code>.<code>website_story_get_by_name</code>('Test');&quot;);</p>
<p>Zach, thank you!!!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21489" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21489" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C21495" href="#C21495">
                <time itemprop="dateCreated" datetime="2015-08-02T09:33:32-07:00" class="action-date">Aug '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Interesting... Calling stored procs.  Glad you figured it out!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="21495" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="21495" data-cf-modified-3b34e3686a2ffadac85dd54e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7889" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>