---
layout: default
title: 'Get many to many relationship between two models - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Get many to many relationship between two models</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/8205/lacsyst" class="user-moderator-N"><span itemprop="name">lacsyst</span></a></span>
            <time itemprop="dateCreated" datetime="2018-04-29T23:46:53-07:00">Apr '18</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2018-04-29T23:46:53-07:00">Apr '18</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '18</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>317</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/a5acb530bcb763deca419bb20b7b138c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/8205/lacsyst" class="user-moderator-N"><span itemprop="name">lacsyst</span></a></span>
                <span class="karma">3.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C18151" href="#C18151">
        <time class="action-date">Apr '18</time>
    </a>
</div>
<div class="post-content"><div><p>Hi</p>
<p>I try to retreive a many to many relation between 2 models, for I use the model function <strong>getRelationsBetween</strong> and pass the 2 models name in parameters but a var_dump return me false.</p>
<p>How I have to use this function? An other ways to achieve this?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-a419d119f29a4bfa75e3d583-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-a419d119f29a4bfa75e3d583-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55073" href="#C55073">
                <time itemprop="dateCreated" datetime="2018-04-30T00:41:20-07:00" class="action-date">Apr '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi,</p>
<p>So far as I know, there is no getRelationsBetween method in the Phalcon\Mvc\Model class (<a href="https://docs.phalcon.io/en/3.3/api/Phalcon_Mvc_Model">https://docs.phalcon.io/en/3.3/api/Phalcon_Mvc_Model</a>)</p>
<p>to use relationships with phalcon's ORM, you'll have to declare the explicitly in the model class: <a href="https://docs.phalcon.io/en/3.3/db-models-relationships#defining">https://docs.phalcon.io/en/3.3/db-models-relationships#defining</a></p>
<p>then you can easily use them as explained in the doc: <a href="https://docs.phalcon.io/en/3.3/db-models-relationships#taking-advantage-of">https://docs.phalcon.io/en/3.3/db-models-relationships#taking-advantage-of</a></p>
<p>happy coding ;-)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55073" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55073" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a5acb530bcb763deca419bb20b7b138c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/8205/lacsyst" class="user-moderator-N"><span itemprop="name">lacsyst</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55075" href="#C55075">
                <time itemprop="dateCreated" datetime="2018-04-30T01:30:39-07:00" class="action-date">Apr '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi le51</p>
<p>Sorry the getRelationsBetween is function of Model\Manager
<a href="https://docs.phalcon.io/en/3.2/api/Phalcon_Mvc_Model_Manager">https://docs.phalcon.io/en/3.2/api/Phalcon_Mvc_Model_Manager</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55075" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55075" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55079" href="#C55079">
                <time itemprop="dateCreated" datetime="2018-04-30T02:03:49-07:00" class="action-date">Apr '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok.
For better help, show us:</p>
<ul>
<li>your models classes</li>
<li>the way you use them with getRelationsBetween</li>
</ul></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55079" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55079" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a5acb530bcb763deca419bb20b7b138c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/8205/lacsyst" class="user-moderator-N"><span itemprop="name">lacsyst</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="55081" data-toggle="modal" data-target="#historyModal">
                edited <span>Apr '18</span>
              </span><br/><a name="C55081" href="#C55081">
                <time itemprop="dateCreated" datetime="2018-04-30T05:02:53-07:00" class="action-date">Apr '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>My 3 Models</p>
<pre><code class="language-php">class Users extends Model {

 public function initialize() {
        $this-&gt;hasManyToMany('id', __NAMESPACE__ . '\UsersRoles', 'userid', 'roleid', __NAMESPACE__ . '\Roles', 'id', array("alias" =&gt; "Roles"));
        }
}</code></pre>
<pre><code class="language-php">class Roles extends Model {

 public function initialize() {
        $this-&gt;hasManyToMany('id', __NAMESPACE__ . '\UsersRoles', 'roleid', 'userid', __NAMESPACE__ . '\Users', 'id', array("alias" =&gt; "Users"));
        }
}</code></pre>
<pre><code class="language-php">class UsersRoles extends Model {

 public function initialize() {
        $this-&gt;belongsTo("userid", __NAMESPACE__ . "\Users", "id", ["alias" =&gt; "user"]);
        $this-&gt;belongsTo("roleid", __NAMESPACE__ . "\Roles", "id", ["alias" =&gt; "role"]);
        }
}</code></pre>
<p>the use of getRelationsBetween in controller</p>
<pre><code class="language-php">$modelUsers = __NAMESPACE__."\Users";
$modelRoles = __NAMESPACE__."\Roles";
$this-&gt;modelsManager-&gt;initialize(new $modelUsers());
$rel = $this-&gt;modelsManager-&gt;getRelationsBetween($modelUsers, $modelsRoles);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55081" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55081" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55105" href="#C55105">
                <time itemprop="dateCreated" datetime="2018-05-01T15:29:42-07:00" class="action-date">May '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What are you trying to accomplish?  Why are you trying to get the relationship itself?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55105" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55105" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a5acb530bcb763deca419bb20b7b138c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/8205/lacsyst" class="user-moderator-N"><span itemprop="name">lacsyst</span></a>        </span>
        <br>

        <span class="karma">3.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55123" href="#C55123">
                <time itemprop="dateCreated" datetime="2018-05-02T04:32:04-07:00" class="action-date">May '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>In the user form I display a table of the user roles and a button to add role to user.</p>
<p>When I click on this button I display a modal with list of roles that are not linked to the user.</p>
<p>I choose the role that I want to add and click on a button that perform the UsersRoles records creation.</p>
<p>I want to build this widget (table + modal) to be generic, today I need display UsersRoles tomorrow Posts, Transactions, whatever ... </p>
<p>I managed to achieve this using getRelationByAlias but I think using getRelationsBetween is more elegant and generic.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55123" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55123" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c0ce8f5e133750a4dfea4712e533a178?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/15/le51" class="user-moderator-N"><span itemprop="name">le51</span></a>        </span>
        <br>

        <span class="karma">43.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C55165" href="#C55165">
                <time itemprop="dateCreated" datetime="2018-05-03T11:19:40-07:00" class="action-date">May '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi,</p>
<p>I think it's more like you've initialized  a new Model, but &quot;as is&quot;, it does not hold any relation ... so var_dump($rel); return null (or something like this ;-))</p>
<p>otherwise model declarations looks correct.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="55165" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="55165" data-cf-modified-a419d119f29a4bfa75e3d583-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="18151" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>