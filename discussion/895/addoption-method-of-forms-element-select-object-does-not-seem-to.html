---
layout: default
title: 'addOption method of forms-element-select object does not seem to work with array as argument - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">addOption method of forms-element-select object does not seem to work with array as argument</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/278/strayobject" class="user-moderator-N"><span itemprop="name">Michal Zdrojewski</span></a></span>
            <time itemprop="dateCreated" datetime="2013-09-14T14:07:43-07:00">Sep '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-09-14T14:07:43-07:00">Sep '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Mar '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>2726</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/837b82efa11afb3ee661e53ac6e5cc6b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/278/strayobject" class="user-moderator-N"><span itemprop="name">Michal Zdrojewski</span></a></span>
                <span class="karma">6.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C895" href="#C895">
        <time class="action-date">Sep '13</time>
    </a>
</div>
<div class="post-content"><div><p>Hi,</p>
<p>I want to add options to my form's select field using addOption() method. Docs state that it takes an array as an argument, well in my case it does not. I'm using Phalcon 1.2.3 and I'm sure I'm doing something wrong, but I don't really know what.
What I want to achieve is pass an id and a value, which consists of a given text (in my case &quot;(role_type) role_name&quot;, however the only thing I get in the view is the string 'Array'. addOption() method works fine with a string.
In my form class I set the select field as follows:</p>
<pre><code class="language-php">$user_role_params = array(
    'useEmpty'  =&gt; true,
    'emptyText' =&gt; 'Please Select...',
    'using'     =&gt; array('id', 'name')
);
$acl_roles = Role::find();
$user_role = new Select('role_id');

$user_role-&gt;setAttributes($user_role_params);

foreach ($acl_roles as $acl_role) {
    $user_role-&gt;addOption(array(
        'id'   =&gt; $acl_role-&gt;getId(),
        'name' =&gt; '('.$acl_role-&gt;getType().')'.$acl_role-&gt;getName()));
}

$user_role-&gt;setLabel('User Role: ');
$this-&gt;add($user_role);</code></pre>
<p>And my view is a simple volt template with the following content:</p>
<pre><code class="language-html">&lt;form method="post"&gt;
        {% raw %}{%{% endraw %} for field in form {% raw %}%}{% endraw %}
            &lt;p&gt;
            {% raw %}{%{% endraw %} set label = field.getLabel() {% raw %}%}{% endraw %}
            {% raw %}{%{% endraw %} if label !== '' {% raw %}%}{% endraw %}
                &lt;label for="{% raw %}{{{% endraw %} field.getName() {% raw %}}}{% endraw %}"&gt;{% raw %}{{{% endraw %} label {% raw %}}}{% endraw %}&lt;/label&gt;
            {% raw %}{%{% endraw %} endif {% raw %}%}{% endraw %}

                {% raw %}{{{% endraw %} field {% raw %}}}{% endraw %}
            &lt;/p&gt;
        {% raw %}{%{% endraw %} endfor {% raw %}%}{% endraw %}
        {% raw %}{{{% endraw %} submit_button("Add User") {% raw %}}}{% endraw %}
    &lt;/form&gt;</code></pre>
<p>Thanks.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5d6f567f9109789fd9f702959768e35d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1/phalcon" class="user-moderator-Y"><span itemprop="name">Phalcon</span></a>        </span>
        <br>

        <span class="karma">98.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3475" href="#C3475">
                <time itemprop="dateCreated" datetime="2013-09-17T09:09:51-07:00" class="action-date">Sep '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>addOption appends an option if the current options are an array of options, combining a database resultset with an array is not supported. You can convert the resultset to an array first before passing it to Select.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3475" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3475" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/837b82efa11afb3ee661e53ac6e5cc6b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/278/strayobject" class="user-moderator-N"><span itemprop="name">Michal Zdrojewski</span></a>        </span>
        <br>

        <span class="karma">6.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="3484" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '14</span>
              </span><br/><a name="C3484" href="#C3484">
                <time itemprop="dateCreated" datetime="2013-09-17T15:48:25-07:00" class="action-date">Sep '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi Phalcon,</p>
<p>Could you please elaborate on where I try to combine a resultset with an array? Your anwer made me try various other things I have not tried before and none of them seem to work, appending an array with addOption results in a string 'Array', even if I create a select with </p>
<pre><code class="language-php">$user_role = new Select('role_id', array(1 =&gt; 'one'));</code></pre>
<p>I did, however manage to get what I wanted, but not in a way I wanted / I was expecting. Here is how:</p>
<pre><code class="language-php">// set params var
        $user_role_params = array(
            'useEmpty'   =&gt; true,
            'emptyValue' =&gt; 0,
            'emptyText'  =&gt; 'Please Select...'
        );
// get all roles
        $acl_roles = Role::find();
// loop through to get the required format       
        foreach ($acl_roles as $acl_role) {
           $arr[$acl_role-&gt;getId()] = '('.$acl_role-&gt;getType().')'.$acl_role-&gt;getName();
        }
// create select object using array and parms var
        $user_role = new Select('role_id', $arr, $user_role_params);
        $user_role-&gt;setLabel('User Role: ');
        $this-&gt;add($user_role);</code></pre>
<p>And for those who might want to add more options elswhere in their code I came up with a workaround (first get existing options, append additional options to that array and replace the existing ones with setOptions method):</p>
<pre><code class="language-php">        $ar = $user_role-&gt;getOptions() + array(4 =&gt; 'more');
        $user_role-&gt;setOptions($ar);</code></pre>
<p>Overall, either I don't understand something (most likely) or there is a bug in a way the addOption() method works (less likely, but possible) which leads to only one conclusion: I must start learning C :)
Take care.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3484" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3484" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/921be5aa7ffcdfa1624b262932738b69?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/807/moderndeveloperllc" class="user-moderator-N"><span itemprop="name">Mark Garrett</span></a>        </span>
        <br>

        <span class="karma">5.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4700" href="#C4700">
                <time itemprop="dateCreated" datetime="2013-12-16T08:34:15-07:00" class="action-date">Dec '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Found something that would keep you from doing a loop:</p>
<pre><code class="language-php">$results = Role::find(
            array(
                'columns' =&gt; 'id, ' . new RawValue('CONCAT ("(", type, ") ", name) as typeName')
            )
        );

$user_role_params = array(
    'useEmpty'  =&gt; true,
    'emptyText' =&gt; 'Please Select...',
    'using'     =&gt; array('id', 'typeName')
);

$user_role = new Select('role_id', $results, $user_role_params);</code></pre>
<p>The key is to return the concatenated columns from the database directly and use that virtual column name in the Select() function. Might be too late for your, but will hopefully help others searching for something like this.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4700" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4700" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/60ffc0e01551cc5809445076da642103?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1058/humugus" class="user-moderator-N"><span itemprop="name">humugus</span></a>        </span>
        <br>

        <span class="karma">7.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6116" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6116" href="#C6116">
                <time itemprop="dateCreated" datetime="2014-03-12T02:21:59-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>based on Mark Garret's solution, the below snippet worked fine and produced a select with entries like :</p>
<p>EDP Manager<br />
EDP Senior<br />
TAX Manager<br />
TAX Senior  </p>
<p>where uppercase come from &quot;cls&quot; filed and Camelcase come from &quot;name&quot; field  </p>
<p><strong>code within a Form class</strong></p>
<pre><code class="language-php">
        $rank_id = new Select
        (
            'rank_id', 
            Ranks::find
            (
                array
                (
                    'conditions' =&gt; 'ISNULL(deleted_at)', 
                    'columns' =&gt; 'id,'.new Phalcon\Db\RawValue('CONCAT (cls, " ", name) AS clsName'),
                    'order' =&gt; ' sort_order ASC, cls ASC, name ASC'
                )
            ), 
            array
            (
                'using' =&gt; array
                (
                    'id', 
                    'clsName'
                ), 
                'useEmpty' =&gt; TRUE, 
                'class' =&gt; 'form-control'
            )
        );
        $rank_id-&gt;setLabel('Rank');
        $this-&gt;add($rank_id);
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6116" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6116" data-cf-modified-83c6ffa4cf219aa1e64232b3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="895" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>