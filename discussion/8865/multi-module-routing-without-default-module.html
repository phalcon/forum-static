---
layout: default
title: 'Multi module routing without default module - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/13/routing">Routing</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Multi module routing without default module</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4543/ph55" class="user-moderator-N"><span itemprop="name">Alex Kalmikov</span></a></span>
            <time itemprop="dateCreated" datetime="2015-10-06T07:32:12-07:00">Oct '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-10-06T07:32:12-07:00">Oct '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Mar '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>705</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img  src="https://secure.gravatar.com/avatar/a454f835870f605cd4d2809820f8e916?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4543/ph55" class="user-moderator-N"><span itemprop="name">Alex Kalmikov</span></a></span>
                <span class="karma">2.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C8865" href="#C8865">
        <time class="action-date">Oct '15</time>
    </a>
</div>
<div class="post-content"><div><p>Hi guys,</p>
<p>Is it possible to define multimodule routing without default module (setDefaultModule) ?
I have same error when trying without setDefaultModule like in this thread:</p>
<p><a href="https://forum.phalcon.io/discussion/2736/service-view-was-not-found-in-the-dependency-injection-container">https://forum.phalcon.io/discussion/2736/service-view-was-not-found-in-the-dependency-injection-container</a></p>
<pre><code class="language-php">&lt;?php

use Phalcon\Mvc\Router;

$router = new Router(false);

$router-&gt;add(
    '/:module/:controller/:action/:params',
    array(
        'module'     =&gt; 1,
        'controller' =&gt; 2,
        'action'     =&gt; 3,
        'params'     =&gt; 4
    )
);</code></pre>
<blockquote>
<p>Service 'view' was not found in the dependency injection container</p>
</blockquote></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="24255" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '15</span>
              </span><br/><a name="C24255" href="#C24255">
                <time itemprop="dateCreated" datetime="2015-10-06T07:42:36-07:00" class="action-date">Oct '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I probably can't solve your problem.
However i dont have setDefaultModule in my routes.</p>
<pre><code>$this-&gt;add('/', array(
            'module' =&gt; 'home',
            'controller' =&gt; 'index',
            'action' =&gt; 'index',
            'namespace' =&gt; 'MY_NS\Home\Controllers\\'
        ))-&gt;setName('default');</code></pre>
<p>but my guess is that you problem comes from Module.php</p>
<p>( its a pure guess I am not master of those views / layouts I had many issues with them )</p>
<p>//edit you define View in your DI for this module right ? Show us Module.php &quot;registerServices&quot; function</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="24255" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="24255" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/a454f835870f605cd4d2809820f8e916?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4543/ph55" class="user-moderator-N"><span itemprop="name">Alex Kalmikov</span></a>        </span>
        <br>

        <span class="karma">2.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="24259" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '15</span>
              </span><br/><a name="C24259" href="#C24259">
                <time itemprop="dateCreated" datetime="2015-10-06T08:04:44-07:00" class="action-date">Oct '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks for reply<a href="https://forum.phalcon.io/user/0/Izo"> @Izo</a>,</p>
<p>It seems that in your example you need to define routes manually each time.
Not the case I'm looking for.</p>
<p>In my <code>Module.php</code> I load services dynamically:</p>
<pre><code class="language-php">public function registerServices(DiInterface $di)
    {
        // list of services that should be defined
        $services = [
            '\Modules\Tools\Services\ConfigService',
            '\Modules\Tools\Services\DispatcherService',
            '\Modules\Common\Services\ModelsDataService',
            '\Modules\Common\Services\SessionService',
            '\Modules\Common\Services\UrlService',
            '\Modules\Common\Services\ViewService',
        ];

        // iterate over services and define/set them
        foreach($services as $serviceNameSpace){

            /** @var \Modules\Common\Services\AbstractService $service */
            $service = new $serviceNameSpace;
            $service-&gt;define();
        }
    }</code></pre>
<p>Views service contains:</p>
<pre><code class="language-php">        $this-&gt;_calls = [

            // set views directory
            [
                'method'    =&gt; 'setViewsDir',
                'arguments' =&gt; [
                    [
                        'type'  =&gt; 'parameter',
                        'value' =&gt; $this-&gt;_di-&gt;get('config')-&gt;application-&gt;dirs-&gt;views
                    ]
                ]
            ],

            // set template engine
            [
                'method' =&gt; 'registerEngines',
                'arguments' =&gt; [
                    [
                        'type' =&gt; 'parameter',
                        'value' =&gt; [
                            '.volt' =&gt; function(){

                                $volt = new \Phalcon\Mvc\View\Engine\Volt($this-&gt;resolve(), $this-&gt;_di);

                                $volt-&gt;setOptions([
                                    'compiledPath'      =&gt; $this-&gt;_di-&gt;get('config')-&gt;application-&gt;dirs-&gt;cache,
                                    'compiledSeparator' =&gt; '_'
                                ]);

                                return $volt;
                            },
                            '.phtml' =&gt; 'Phalcon\Mvc\View\Engine\Php'
                        ]
                    ]
                ]
            ]
        ];</code></pre>
<p>Router service contains:</p>
<pre><code class="language-php">protected $_calls = [
        [
            'method'    =&gt; 'setDefaultModule',
            'arguments' =&gt; [
                [
                    'type'  =&gt; 'parameter',
                    'value' =&gt; 'tools'
                ]
            ]
        ],

        [
            'method' =&gt; 'add',
            'arguments' =&gt; [
                [
                    'type' =&gt; 'parameter',
                    'value' =&gt; '/:module/:controller/:action/:params'
                ],

                [
                    'type' =&gt; 'parameter',
                    'value' =&gt; [
                        'module'     =&gt; 1,
                        'controller' =&gt; 2,
                        'action'     =&gt; 3,
                        'params'     =&gt; 4
                    ]
                ]
            ]
        ],

        [
            'method'    =&gt; 'removeExtraSlashes',
            'arguments' =&gt; [
                [
                    'type'  =&gt; 'parameter',
                    'value' =&gt; true
                ]
            ]
        ]
    ];</code></pre>
<p><code>$this-&gt;_calls</code> /  <code>protected $_calls</code> - is an array that will be passed as setter injection:
<a href="https://docs.phalcon.io/en/latest/reference/di.html#setter-injection">https://docs.phalcon.io/en/latest/reference/di.html#setter-injection</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="24259" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="24259" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="24265" data-toggle="modal" data-target="#historyModal">
                edited <span>Oct '15</span>
              </span><br/><a name="C24265" href="#C24265">
                <time itemprop="dateCreated" datetime="2015-10-06T09:22:12-07:00" class="action-date">Oct '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>what's the name of the module here and the exact url ? ( where you have issues )</p>
<p>//edit</p>
<p>also go to this module Module.php, inside registerServices function type : </p>
<pre><code>echo "yeaa";exit;</code></pre>
<p>just to be sure, I had this issue recentyly and my router wansnt working correctly ( so my module wasnt initiated at all ). </p>
<p>also i had issues with namespacing ( capital and small letters ).</p>
<p>in those cases I had the same error</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="24265" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="24265" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/a454f835870f605cd4d2809820f8e916?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4543/ph55" class="user-moderator-N"><span itemprop="name">Alex Kalmikov</span></a>        </span>
        <br>

        <span class="karma">2.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C24311" href="#C24311">
                <time itemprop="dateCreated" datetime="2015-10-07T08:18:29-07:00" class="action-date">Oct '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Izo">@Izo</a>,</p>
<p>Module works. And routing also works with <code>setDefaultModule</code>
The question was if its possible to define dynamic routing without <code>setDefaultModule</code> like in head post example.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="24311" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="24311" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/42e9570827f219c4f0387eee7e2b6235?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9275/mia0x75" class="user-moderator-N"><span itemprop="name">mia0x75</span></a>        </span>
        <br>

        <span class="karma">105</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C46927" href="#C46927">
                <time itemprop="dateCreated" datetime="2017-03-24T20:21:23-07:00" class="action-date">Mar '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/4543/ph55">@ph55</a></p>
<p>Hi Alex, I am trying to start a large project with multi-module(publisher/advertiser/admin/common/apiv1/apiv2 etc), multi-database(pubdb/advdb etc), could you please share your project folder structure with code? Thanks in advance.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="46927" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="46927" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img  src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C46929" href="#C46929">
                <time itemprop="dateCreated" datetime="2017-03-25T00:58:18-07:00" class="action-date">Mar '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://www.npmjs.com/package/generator-phalcon">https://www.npmjs.com/package/generator-phalcon</a></p>
<p>when generated it has few errors, like warrning etc... you have to put fre $di = \Phalcon\DiInterface in few function params and thats pretty much it. It works works with multi module like a charm</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="46929" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="46929" data-cf-modified-d3daae9f0d360aec9082e1a0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="8865" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>