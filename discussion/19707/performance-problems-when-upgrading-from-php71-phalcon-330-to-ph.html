---
layout: default
title: 'Performance problems when upgrading from PHP7.1, Phalcon 3.3.0 to PHP7.3 Phalcon 3.4.3 - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Performance problems when upgrading from PHP7.1, Phalcon 3.3.0 to PHP7.3 Phalcon 3.4.3</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a></span>
            <time itemprop="dateCreated" datetime="2019-05-30T07:37:36-07:00">May '19</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2019-05-30T07:37:36-07:00">May '19</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Oct '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">7</span>
                </td>
                <td>
                    <label>Views</label><br>333</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/228712d18c0cdbdc36534ab9f882575a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a></span>
                <span class="karma">448</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C19707" href="#C19707">
        <time class="action-date">May '19</time>
    </a>
</div>
<div class="post-content"><div><p>Hi,
We tried to upgrade from php7.1 to 7.3 and had performance issues
performance degraded 15%~30% depending on sites we serve</p>
<p>We moved from:</p>
<pre><code>PHP 7.1.12-3
Phalcon 3.3.0
Nginx 1.4.6 (according to phpinfo())
ubunto 14.04</code></pre>
<p>to :</p>
<pre><code>PHP 7.3.5-1
Phalcon 3.4.3
Nginx 1.15.12
Ubunto 18.04</code></pre>
<p>The same happens with other versions of Nginx/Ubunto
Any ideas what might cause it? </p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C59931" href="#C59931">
                <time itemprop="dateCreated" datetime="2019-05-31T03:46:40-07:00" class="action-date">May '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>make sure your benchmark is correct, because there are many things that are different based on the infomation you provided</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59931" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59931" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/228712d18c0cdbdc36534ab9f882575a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a>        </span>
        <br>

        <span class="karma">448</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C59931"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Izo                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="59933" data-toggle="modal" data-target="#historyModal">
                edited <span>May '19</span>
              </span><br/><a name="C59933" href="#C59933">
                <time itemprop="dateCreated" datetime="2019-05-31T04:24:06-07:00" class="action-date">May '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I take microtime at the begining and at the end of the controller.
The regression happens even when Nginx and Ubunto are the same (meaning Only PHP and Phalcon have changed).
This is also notable in Newrelic monitoring.</p>
<p>Would love to get ideas on where can I investigate</p>
<blockquote>
<p>make sure your benchmark is correct, because there are many things that are different based on the infomation you provided</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59933" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59933" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C59969" href="#C59969">
                <time itemprop="dateCreated" datetime="2019-06-06T01:11:13-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>best would be to create a isolated ( and simple / very short ) example.
Test it on both places and check if there is a difference.</p>
<p>There is a difference in the performance in the framework, but its so small that It should not be visibile.</p>
<p>My pure guess would be that your mysql is slowing things down</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59969" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59969" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/228712d18c0cdbdc36534ab9f882575a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a>        </span>
        <br>

        <span class="karma">448</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C59971" href="#C59971">
                <time itemprop="dateCreated" datetime="2019-06-06T01:30:01-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi Izo
Firsr of all, thanks for your effort :-)
I'm using same redis for both cases (no mysql).
You mentioned a difference in performence. Is it Phalcon 3.4 Vrs earlier versions? can if be mapped to do's and don'ts?
I'm hopping to heare from the community, Are there known issues in php7.3 that can cause this (e.g. diffrence in error reporting, depprecated functions, etc.) </p>
<p>thanks again
Yariv</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59971" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59971" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6549777fa33638d0674db65d9111d400?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2145/DestinyMKas" class="user-moderator-N"><span itemprop="name">Karolis Mačiulskis</span></a>        </span>
        <br>

        <span class="karma">26.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C59975" href="#C59975">
                <time itemprop="dateCreated" datetime="2019-06-06T02:48:22-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>How about hardware? Did you changed it?
Also probably it can be configuration issue. Let's say opcache is not enabled or xdebug enabled.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59975" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59975" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="59977" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '19</span>
              </span><br/><a name="C59977" href="#C59977">
                <time itemprop="dateCreated" datetime="2019-06-06T03:02:17-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Well you changed OS and nginx as well, so there might be many things that went wrong, like even your OS configuration or hardware itself if it's some kind of cloud.</p>
<p>I saw even differences on cloud providers were theoritcally same configuration could potentially have such performance difference, because simply not all servers are always using exactly same CPU.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59977" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59977" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/228712d18c0cdbdc36534ab9f882575a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a>        </span>
        <br>

        <span class="karma">448</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C59975"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/6549777fa33638d0674db65d9111d400?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Karolis Mačiulskis                    </a>
                </div><div class="posts-buttons" align="right"><a name="C59979" href="#C59979">
                <time itemprop="dateCreated" datetime="2019-06-06T03:13:34-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks,</p>
<p>I'll double check the configuration
I'm running on same hardware (using dockers on AWS)</p>
<blockquote>
<p>How about hardware? Did you changed it?
Also probably it can be configuration issue. Let's say opcache is not enabled or xdebug enabled.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59979" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59979" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/228712d18c0cdbdc36534ab9f882575a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/12471/YarivGdidiNi" class="user-moderator-N"><span itemprop="name">YarivGdidiNi</span></a>        </span>
        <br>

        <span class="karma">448</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C59977"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Wojciech Ślawski                    </a>
                </div><div class="posts-buttons" align="right"><a name="C59981" href="#C59981">
                <time itemprop="dateCreated" datetime="2019-06-06T03:15:42-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks,
same results happend with same OS/Nginx.
I'm planning another try cycle with different docker configuration, will update....</p>
<blockquote>
<p>Well you changed OS and nginx as well, so there might be many things that went wrong, like even your OS configuration or hardware itself if it's some kind of cloud.</p>
<p>I saw even differences on cloud providers were theoritcally same configuration could potentially have such performance difference, because simply not all servers are always using exactly same CPU.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59981" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59981" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6549777fa33638d0674db65d9111d400?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2145/DestinyMKas" class="user-moderator-N"><span itemprop="name">Karolis Mačiulskis</span></a>        </span>
        <br>

        <span class="karma">26.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C59983" href="#C59983">
                <time itemprop="dateCreated" datetime="2019-06-06T04:04:23-07:00" class="action-date">Jun '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Can you do some profiling to better understand where performance degraded</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="59983" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="59983" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6d42f779b8b9b7b79d0e69bfd3fcfe78?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/13843/shaneosie" class="user-moderator-N"><span itemprop="name">shaneosie</span></a>        </span>
        <br>

        <span class="karma">74</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C63427" href="#C63427">
                <time itemprop="dateCreated" datetime="2020-06-12T14:15:37-07:00" class="action-date">Jun '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Can we use it in any profile on website? I want to use with my <a href="https://circularsawjudge.com/">tools reviews</a> website. Kindly guide.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="63427" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="63427" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/32afd02cdd2d9ba52ba0bbc8f36d7f12?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/14203/hemlacarss" class="user-moderator-N"><span itemprop="name">hemlacarss</span></a>        </span>
        <br>

        <span class="karma">95</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64473" href="#C64473">
                <time itemprop="dateCreated" datetime="2020-10-08T04:20:33-07:00" class="action-date">Oct '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Then there is something coming out of your database. Perhaps a field that can not be null or some data inconsistency there. Check what information you send in and test the entire SQL statment that you inte<a href="https://playwheresult.com">guide</a> <a href="https://forum.phalcon.io/discussion/19975/api-rest">https://forum.phalcon.io/discussion/19975/api-rest</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64473" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64473" data-cf-modified-17699a9a4b8ebadd4a100f59-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="19707" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>