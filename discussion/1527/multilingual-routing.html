---
layout: default
title: 'Multilingual routing - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Multilingual routing</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/1005/Krokodilen" class="user-moderator-N"><span itemprop="name">Krokodilen</span></a></span>
            <time itemprop="dateCreated" datetime="2014-01-30T15:35:30-07:00">Jan '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-01-30T15:35:30-07:00">Jan '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Aug '14</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>3057</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/54f4f4214a9af9734adb277dc93611c2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/1005/Krokodilen" class="user-moderator-N"><span itemprop="name">Krokodilen</span></a></span>
                <span class="karma">3.0k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1527" href="#C1527">
        <time class="action-date">Jan '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hi, </p>
<p>I've just started out with Phalcon, the first PHP framework I've ever used. I'm currently developing on a site which will be in both English and Swedish. The English site will feature four different pages being: Home, About, Contact and Extras. The Swedish site will be exactly the same but with: Hem, Om, Kontakt and Extra instead. I want the url to look like this:</p>
<p><a href="http://baseurl/sv/hem">http://baseurl/sv/hem</a>
<a href="http://baseurl/sv/om">http://baseurl/sv/om</a>
<a href="http://baseurl/sv/kontakt">http://baseurl/sv/kontakt</a>
<a href="http://baseurl/sv/extra">http://baseurl/sv/extra</a></p>
<p><a href="http://baseurl/en/home">http://baseurl/en/home</a>
<a href="http://baseurl/en/about">http://baseurl/en/about</a>
<a href="http://baseurl/en/contact">http://baseurl/en/contact</a>
<a href="http://baseurl/en/extras">http://baseurl/en/extras</a></p>
<p>I want to use one controller per site and language meaning that both:
<a href="http://baseurl/sv/home">http://baseurl/sv/home</a>
and
<a href="http://baseurl/en/home">http://baseurl/en/home</a>
goes to the same controller.</p>
<p>What would be the best way to achive this? I've looked into routing and tested this piece of code:</p>
<pre><code class="language-php">$router-&gt;add(
    "/sv/om/:action",
    array(
        "language" =&gt; "sv",
        "controller" =&gt; "about",
        "action"     =&gt; 2,
    )
);</code></pre>
<p>Even though this would work just fine, you would have to add every single controller, I would instead prefer to have some sort of configuration file like the following array:</p>
<pre><code class="language-php">$sites = array(
    "hem" =&gt; "home",
    "om" =&gt; "about",
    "kontakt" =&gt; "contact",
    "extra" =&gt; "extras"
);</code></pre>
<p>To handle this instead. I've also looked into using convert for the route but I don't know how to implement that.</p>
<p>Much help is appreciated! Also great work with this awesome framework, I'm looking forward to dig deeper in to this.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1eb2415bda000b22fd1f801bb9e8c003?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2/niden" class="user-moderator-Y"><span itemprop="name">Nikolaos Dimopoulos</span></a>        </span>
        <br>

        <span class="karma">39.3k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C5343" href="#C5343">
                <time itemprop="dateCreated" datetime="2014-01-30T16:26:04-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can do something like this:</p>
<pre><code class="language-php">// This will get you straight to home
$router-&gt;add(
    '/{language:[a-z]{2{% raw %}}}{% endraw %}',
    array(
        'controller' =&gt; 'index',
        'action'     =&gt; 'index',
    )
);

$router-&gt;add(
    '/{language:[a-z]{2{% raw %}}}{% endraw %}/{pageSlug:(home|about|contact|extras|hem|om|kontakt|extra)}',
    array(
        'controller' =&gt; 'index',
        'action'     =&gt; 'page',
    )
);</code></pre>
<p>Then in your index controller you have the following actions</p>
<pre><code class="language-php">class IndexController extends \Phalcon\Mvc\Controller
{
    public function indexAction()
    {
        $lang   = $this-&gt;dispatcher-&gt;getParam('language');
        $lang   = ($lang != 'sv' &amp;&amp; $lang != 'en') ? 'en' : $lang;
        $action = ($lang == 'sv') ? 'hem' : 'home';
        $this-&gt;response-&gt;redirect($lang . '/' . $action);
    }

    public function pageAction()
    {
        $lang   = $this-&gt;dispatcher-&gt;getParam('language');
        $page   = $this-&gt;dispatcher-&gt;getParam('pageSlug');
        $action = '';
        switch ($page) {
            case 'home':
            case 'hem':
                $action = 'home';
                break;
            case 'about':
            case 'om':
                $action = 'about';
                break;
            case 'contact':
            case 'kontakt':
                $action = 'contact';
                break;
            case 'extras':
            case 'extra':
                $action = 'extras';
                break;
        }

        // Forward to the relevant action
        $this-&gt;dispatcher-&gt;forward(
            array(
                'controller' =&gt; 'index',
                'action'     =&gt; $action
            )
        );
    }

    public function homeAction()
    {
        // Home stuff goes here
    }

    public function aboutAction()
    {
        // About stuff goes here
    }

    public function contactAction()
    {
        // Contact stuff goes here
    }

    public function extrasAction()
    {
        // Home stuff goes here
    }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5343" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5343" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">3</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/54f4f4214a9af9734adb277dc93611c2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1005/Krokodilen" class="user-moderator-N"><span itemprop="name">Krokodilen</span></a>        </span>
        <br>

        <span class="karma">3.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="5350" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C5350" href="#C5350">
                <time itemprop="dateCreated" datetime="2014-01-31T08:34:11-07:00" class="action-date">Jan '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thank you so much for your reply Nikolaos!</p>
<pre><code class="language-php">$this-&gt;dispatcher-&gt;forward</code></pre>
<p>was exactly what I needed!</p>
<p>My router now looks like this:</p>
<pre><code class="language-php"> # /public/index.php
$router-&gt;add("(/.+)?", array(
    'controller' =&gt; 'index',
    'action' =&gt; 'routing'
));

$router-&gt;add("/([a-z]{2})(/?)", array(
    'redirectLanguage' =&gt; 1,
    'controller' =&gt; 'index',
    'action' =&gt; 'routing'
));

$router-&gt;add("/([a-z]{2})/:controller(/?)", array(
    'redirectLanguage' =&gt; 1,
    'redirectController' =&gt; 2,
    'controller' =&gt; 'index',
    'action' =&gt; 'routing'
));

$router-&gt;add("/([a-z]{2})/:controller/:action(/?)", array(
    'redirectLanguage' =&gt; 1,
    'redirectController' =&gt; 2,
    'redirectAction' =&gt; 3,
    'controller' =&gt; 'index',
    'action' =&gt; 'routing'
));</code></pre>
<p>Everything is sent to the routing action in my index controller which looks as following:</p>
<pre><code class="language-php">&lt;?php
 # /app/controllers/IndexController.php

class IndexController extends \Phalcon\Mvc\Controller
{

    public function indexAction()
    {

    }

    public function routingAction() 
    {   
        // Get entered language.
        $language   = $this-&gt;dispatcher-&gt;getParam('redirectLanguage');

        // Get entered controller.
        $controller   = $this-&gt;dispatcher-&gt;getParam('redirectController');

        // Get entered action.
        $action = $this-&gt;dispatcher-&gt;getParam('redirectAction');

        // Load global config.
        $config = $this-&gt;config;

        // Check if the language is available.
        if (!array_key_exists($language, (array) $config-&gt;sites)) {

            $this-&gt;response-&gt;redirect('');

        } else {

            if (!array_key_exists($controller, (array) $config-&gt;sites-&gt;$language)) {

                reset($config-&gt;sites-&gt;$language);
                $this-&gt;response-&gt;redirect($language . '/' . key($config-&gt;sites-&gt;$language) );

            } else {

                // Forward to the relevant action
                $this-&gt;dispatcher-&gt;forward(
                    array(
                        'controller' =&gt; $config-&gt;sites-&gt;$language-&gt;$controller,
                        'action'     =&gt; $action
                    )
                );

            }

        }

    }

}</code></pre>
<p>This takes an array from my config file which looks like this</p>
<pre><code class="language-php">&lt;?php
 # /app/config/config.php

$settings = array(

    "sites" =&gt; array(

        "sv" =&gt; array(
            "hem" =&gt; "home",
            "om" =&gt; "about",
            "kontakt" =&gt; "contact",
            "extra" =&gt; "extras"
        ),
        "en" =&gt; array(
            "home" =&gt; "home",
            "about" =&gt; "about",
            "contact" =&gt; "contact",
            "extras" =&gt; "extras"
        )

    )

);</code></pre>
<p>It might not be the best way to do it but it works as it should.</p>
<p>Once again thank you so much for your fast reply, I went ahead and donated some to Phalcon!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="5350" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="5350" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/24e438429d975d345e4f99e53b740150?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1487/Conradaek" class="user-moderator-N"><span itemprop="name">Conradaek</span></a>        </span>
        <br>

        <span class="karma">26.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9911" href="#C9911">
                <time itemprop="dateCreated" datetime="2014-08-01T13:49:27-07:00" class="action-date">Aug '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Krokodilen">@Krokodilen</a></p>
<p>Hi, I know the topic is solved but I am analyzing the code here and have a question.</p>
<p>What is the goal of <code>(/?)</code> and <code>(/.+)?</code> in your routes? Could you explain it please?</p>
<p>I assume it is some substitution of simple <code>/</code>, am I right? What is the difference?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9911" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9911" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/54f4f4214a9af9734adb277dc93611c2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1005/Krokodilen" class="user-moderator-N"><span itemprop="name">Krokodilen</span></a>        </span>
        <br>

        <span class="karma">3.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9915" href="#C9915">
                <time itemprop="dateCreated" datetime="2014-08-01T16:11:08-07:00" class="action-date">Aug '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><code>(/?)</code> Allows for a trailing slash in the end of the URL, that way domain.com/en/about/ will still lead to the AboutController. Looking back at my code I realize that the regex grouping isn't necessary and simply <code>/?</code> will work as well. Using only <code>/</code> would require a slash to be trailing the URL, adding ? makes it optional.
<code>(/.+)?</code> Will match a slash and any following text, once again the grouping isn't necessary and <code>/.+</code> will work as fine.</p>
<p>I hope this explained everything, otherwise reply and I will try to explain it better.</p>
<p>Cheers, Jens.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9915" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9915" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/24e438429d975d345e4f99e53b740150?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1487/Conradaek" class="user-moderator-N"><span itemprop="name">Conradaek</span></a>        </span>
        <br>

        <span class="karma">26.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9916" href="#C9916">
                <time itemprop="dateCreated" datetime="2014-08-02T00:42:56-07:00" class="action-date">Aug '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thank you for your explanation. I think now it's clear for me. I checked some docs and found that Phalcon can remove this slashes automatically by:</p>
<pre><code class="language-php">
$router-&gt;removeExtraSlashes(true);
</code></pre>
<p>It's here, <a href="http://docs.phalcon.io/en/latest/reference/routing.html#dealing-with-extra-trailing-slashes"><a href="http://docs.phalcon.io/en/latest/reference/routing.html#dealing-with-extra-trailing-slashes">http://docs.phalcon.io/en/latest/reference/routing.html#dealing-with-extra-trailing-slashes</a></a> </p>
<p>May be helpfull sometime in the future. Thanks!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9916" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9916" data-cf-modified-bfe249830845f9e13dc4a3e0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1527" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>