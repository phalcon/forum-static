---
layout: default
title: 'php7.0-fpm occasional crash - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/25/configuration">Configuration</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">php7.0-fpm occasional crash</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a></span>
            <time itemprop="dateCreated" datetime="2017-05-16T17:05:37-07:00">May '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-05-16T17:05:37-07:00">May '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>May '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">6</span>
                </td>
                <td>
                    <label>Views</label><br>553</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/1d64d48ae08f9b613cb6729ccd5a6b64?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a></span>
                <span class="karma">1.4k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C16147" href="#C16147">
        <time class="action-date">May '17</time>
    </a>
</div>
<div class="post-content"><div><p>Hey everyone, I'm currently using phalcon with the following setup</p>
<ul>
<li>Ubuntu 14.04 trusty</li>
<li>Phalcon 3.0.3</li>
<li>nginx/1.4.6</li>
<li>php7.0-fpm</li>
</ul>
<p>Problem is, occasionally the server would crash out of the blue, and when it happens, the fpm needs to be reloaded using <code>sudo service php7.0-fpm restart</code> and it goes back to normal operation. What could be the root cause of the trouble? Is this a known issue? Any help/pointer on this issue would be much appreciated, thank you! </p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-cf9f1b596ea9c196aa382764-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-cf9f1b596ea9c196aa382764-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48179" href="#C48179">
                <time itemprop="dateCreated" datetime="2017-05-16T23:48:14-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>dig into logs, turn all error reports and pipe them into a file and monitor it</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48179" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48179" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1d64d48ae08f9b613cb6729ccd5a6b64?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C48179"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Izo                    </a>
                </div><div class="posts-buttons" align="right"><a name="C48183" href="#C48183">
                <time itemprop="dateCreated" datetime="2017-05-17T02:56:07-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Izo">@Izo</a>, thanks for the reply</p>
<blockquote>
<p>dig into logs, turn all error reports and pipe them into a file and monitor it</p>
</blockquote>
<p>Is there something specific I should be looking out? Or should I report back and paste the log file?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48183" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48183" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48187" href="#C48187">
                <time itemprop="dateCreated" datetime="2017-05-17T03:15:38-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I dont know to be honest, i have seen some problems with fpm, but its regualr stuff, never actually have to restart the service.</p>
<p>My blind guess would be that workers/proccess are not enough and requests takes high amount of time and you have to wait some time to spawn a new process.</p>
<p>post screenshot of htop when service is stuck  aswell. </p>
<p>But i am not sure if I am gonna be able to help.</p>
<p>You can contact me at discord or slack, my nickname there is Izo </p>
<p>then we will see what we can do, perhaps a teamviewer to check it myself to see if i can spot anything</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48187" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48187" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48189" href="#C48189">
                <time itemprop="dateCreated" datetime="2017-05-17T04:30:43-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Is its possible that you have compileAlways enabled? If yes then it's not phalcon issue, it's php issue from they category like it won't be fixed because it's os/file system related - it tries to access file which is currently written by other process.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48189" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48189" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1d64d48ae08f9b613cb6729ccd5a6b64?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48191" href="#C48191">
                <time itemprop="dateCreated" datetime="2017-05-17T09:06:49-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Izo">@Izo</a> after taking a stroll through the nginx error log, I found several <code>[error] 41371#0: *3308726 connect() to unix:/run/php/php7.0-fpm.sock failed (11: Resource temporarily unavailable)</code> errors, but mostly just php warnings. What could be the root cause?</p>
<p><a href="https://forum.phalcon.io/user/0/Wojciech">@Wojciech</a>Ślawski  Thanks for the response. Yes! I do have <code>compileAlways</code> enabled, is that the problem? Should I disable it and see how it goes?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48191" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48191" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="48193" data-toggle="modal" data-target="#historyModal">
                edited <span>May '17</span>
              </span><br/><a name="C48193" href="#C48193">
                <time itemprop="dateCreated" datetime="2017-05-17T09:33:12-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes, it is a problem. It's just how php is developed, it's not phalcon issue.</p>
<p>Well i see you use sockets, if there is many connections then it's known thing that sockets are not stable, you should switch to tcp/ip if you have many requests.</p>
<p>Check this issue here - <a href="https://github.com/phalcon/cphalcon/issues/12506">https://github.com/phalcon/cphalcon/issues/12506</a></p>
<p>Related php bug from 2010 - <a href="https://bugs.php.net/bug.php?id=52752">https://bugs.php.net/bug.php?id=52752</a> to this compileAlways</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48193" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48193" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1d64d48ae08f9b613cb6729ccd5a6b64?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C48193"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Wojciech Ślawski                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="48199" data-toggle="modal" data-target="#historyModal">
                edited <span>May '17</span>
              </span><br/><a name="C48199" href="#C48199">
                <time itemprop="dateCreated" datetime="2017-05-17T17:11:39-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>Yes, it is a problem. It's just how php is developed, it's not phalcon issue.</p>
<p>Well i see you use sockets, if there is many connections then it's known thing that sockets are not stable, you should switch to tcp/ip if you have many requests.</p>
<p>Check this issue here - <a href="https://github.com/phalcon/cphalcon/issues/12506">https://github.com/phalcon/cphalcon/issues/12506</a></p>
<p>Related php bug from 2010 - <a href="https://bugs.php.net/bug.php?id=52752">https://bugs.php.net/bug.php?id=52752</a> to this compileAlways</p>
</blockquote>
<p>Thanks for the links, it is strongly similar to the issue I'm currently facing. I've tried using tcp by following <a href="https://easyengine.io/tutorials/php/fpm-sysctl-tweaking/">this</a> . Disabled <code>compileAlways</code> also. Unfortunately the errors are still occuring though. Is there a certain tcp configuration I'm missing or other parts I should look into? </p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48199" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48199" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48205" href="#C48205">
                <time itemprop="dateCreated" datetime="2017-05-18T01:14:56-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Then idk, it doesn't look like seg fault. You could check if you have any core dump or run php-fpm in gdb.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48205" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48205" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1d64d48ae08f9b613cb6729ccd5a6b64?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/8999/taufansatrio" class="user-moderator-N"><span itemprop="name">Taufan Satrio</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48217" href="#C48217">
                <time itemprop="dateCreated" datetime="2017-05-19T00:26:37-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Is there a known issue related to <a href="https://docs.phalcon.io/en/3.0.0/reference/volt.html#view-integration">volt partials</a>? I tried rolling back to a previous commit, before I started using partials. The server has not crashed since</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48217" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48217" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48219" href="#C48219">
                <time itemprop="dateCreated" datetime="2017-05-19T01:08:40-07:00" class="action-date">May '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What you mean? I don't know, im not using them.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48219" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48219" data-cf-modified-cf9f1b596ea9c196aa382764-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="16147" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>