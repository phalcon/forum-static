---
layout: default
title: 'Catching exceptions from dispatch event listeners - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/11/events-manager">Events</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Catching exceptions from dispatch event listeners</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a></span>
            <time itemprop="dateCreated" datetime="2016-06-14T06:48:31-07:00">Jun '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-06-14T06:48:31-07:00">Jun '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>889</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/6d6e3d46cfee663f83d3d362de14fc2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a></span>
                <span class="karma">999</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11823" href="#C11823">
        <time class="action-date">Jun '16</time>
    </a>
</div>
<div class="post-content"><div><p>Hello,</p>
<p>I want to use exceptions for error handling, however whenever I throw anything inside dispatch event listeners, they are not caught inside the framework, even though I have my beforeException event listener. It only catches exceptions from within controllers action.</p>
<p>What should I do to utilize exceptions inside those event listeners?</p>
<p>Thank you very much</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-2f053d8180421a2512bbe3da-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-2f053d8180421a2512bbe3da-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="35435" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '16</span>
              </span><br/><a name="C35435" href="#C35435">
                <time itemprop="dateCreated" datetime="2016-06-14T07:01:44-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Well, wait, wouldn't this mean that you could possibly have recursion ? You mean in beforeException even listener you want to throw exception which should be again catch in beforeException ? I don't think it's possible, also i think you shouldn't do stuff like this.</p>
<p>You can always use <code>set_error_handler</code> from php</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35435" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35435" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6d6e3d46cfee663f83d3d362de14fc2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a>        </span>
        <br>

        <span class="karma">999</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35439" href="#C35439">
                <time itemprop="dateCreated" datetime="2016-06-14T07:14:29-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't think so. When you catch an exception, you surrender your control to the catch block, regardless of how many blocks you might be in. Meaning that once you jump out of the dispatch scope, there won't be any listener that could trigger nesting of exceptions.
And I want to catch exceptions from &quot;beforeExecute&quot; or &quot;beforeDispatchLoop&quot;. And handle them in &quot;beforeException&quot;.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35439" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35439" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6d6e3d46cfee663f83d3d362de14fc2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a>        </span>
        <br>

        <span class="karma">999</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35443" href="#C35443">
                <time itemprop="dateCreated" datetime="2016-06-14T07:15:16-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Also, I want to handle the error inside ErrorController, which I can not do when I get thrown outside the application.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35443" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35443" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35447" href="#C35447">
                <time itemprop="dateCreated" datetime="2016-06-14T07:46:13-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Try - catch block is done only on executing your action - <a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/dispatcher.zep#L508(which">https://github.com/phalcon/cphalcon/blob/master/phalcon/dispatcher.zep#L508(which</a> checks for beforeException listener). This is why throwing exception in beforeExecute is not catch be beforeException. You need to currently use set_error_handler or do PR for fixing current behaviour if you thinks it's necessary.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35447" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35447" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6d6e3d46cfee663f83d3d362de14fc2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a>        </span>
        <br>

        <span class="karma">999</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35451" href="#C35451">
                <time itemprop="dateCreated" datetime="2016-06-14T08:16:16-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>So my only option to do what I actually want without having to put try/catch in every listener is to implement my own dispatcher and put explicit catch around the dispatch method? :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35451" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35451" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35453" href="#C35453">
                <time itemprop="dateCreated" datetime="2016-06-14T08:17:48-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>No, you can use <code>set_error_handler</code>.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35453" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35453" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/6d6e3d46cfee663f83d3d362de14fc2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/7509/sagesan" class="user-moderator-N"><span itemprop="name">sagesan</span></a>        </span>
        <br>

        <span class="karma">999</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35455" href="#C35455">
                <time itemprop="dateCreated" datetime="2016-06-14T09:33:54-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I assume you mean <code>set_exception_handler</code>. Which, again, is completely outside the application scope, meaning I can simply put <code>$app-&gt;handle();</code> in <code>try/catch</code> block and the result would be the same. However, as I mentioned, I would like to catch the exceptions coming from dispatcher (both direct and indirect) inside the application, forward them to ErrorController and process them there.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35455" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35455" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C35459" href="#C35459">
                <time itemprop="dateCreated" datetime="2016-06-14T09:50:58-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Well yea, then you right, you need extend dispatcher. Or as i already wrote - you can do PR with this &quot;fix&quot;.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="35459" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="35459" data-cf-modified-2f053d8180421a2512bbe3da-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11823" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>