---
layout: default
title: 'MVC or Micro or Middle - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">MVC or Micro or Middle</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a></span>
            <time itemprop="dateCreated" datetime="2017-06-19T17:09:40-07:00">Jun '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-06-19T17:09:40-07:00">Jun '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>555</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a></span>
                <span class="karma">9.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C16365" href="#C16365">
        <time class="action-date">Jun '17</time>
    </a>
</div>
<div class="post-content"><div><p>The factory default MVC loads heaps of services. Micro loads nothing. I ended up using a mixture of micro and an MVC config with no factory defaults, using only what I specifically need. Has anyone compared the memory usage or performance for the factory default versus a cut down services list?</p>
<p>Many of my Web site pages do not need the Model code. I use the following DB handler to execute some SQL. The SQL is usually simple. 'select name in abc order by name'. There is no reason to load the model code for every page.</p>
<p>$db = Di::getDefault()-&gt;getDb()-&gt;getInternalHandler();</p>
<p>Given that most of the pages on the site will be information pages, a reduced MVC is worth the effort. I call it the Middle level. The most frequently used pages will be the ones that use the least services and benefit the most from Middle.</p>
<p>I can see potential database access performance improvements. I have not attempted to measure memory usage or CPU usage. Is there any research into replacing Model with a cut down version or plain PDO?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C48905" href="#C48905">
                <time itemprop="dateCreated" datetime="2017-06-20T03:18:02-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Keep in mind that factory default creates services only when they are accessed.</p>
<p>There is actually Medium/Middle Application approach in phalcon - like Micro kernel + controllers as handlers.</p>
<p>You can always just access db service and call methods like fetchAll fetchOne etc, it's just wrapper over PDO but without models, you will just have arrays or stdobject as result.</p>
<p>Memory usage will be smaller, but not very much really. Mostly about amount of php files you have. Cpu usage can be bigger difference - micro doesn't have dispatcher - so it should be faster at this point.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48905" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48905" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C48905"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Wojciech Ślawski                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="48951" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '17</span>
              </span><br/><a name="C48951" href="#C48951">
                <time itemprop="dateCreated" datetime="2017-06-21T02:01:42-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>There is actually Medium/Middle Application approach in phalcon - like Micro kernel + controllers as handlers.</p>
</blockquote>
<p>That's my approach 99% of the time with Phalcon :) Works like a charm. Flexible, efficient and very performant.</p>
<p><a href="https://forum.phalcon.io/user/9683/petermoo">@petermoo</a> You've done a good job, and for sure you'll end up with a more performant system. Remember, DB is always the culprit on web apps.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="48951" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="48951" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49003" href="#C49003">
                <time itemprop="dateCreated" datetime="2017-06-21T15:27:26-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>&quot;but without models, you will just have arrays or stdobject as result&quot;
I am using -&gt;fetchAll(\PDO::FETCH_CLASS, 'abc'); to use my own classes for some data and leaving the stdObject for others.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49003" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49003" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8da15621865643112c6e3243f2ce4ebe?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3812/Jurigag" class="user-moderator-Y"><span itemprop="name">Wojciech Ślawski</span></a>        </span>
        <br>

        <span class="karma">145.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="49005" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '17</span>
              </span><br/><a name="C49005" href="#C49005">
                <time itemprop="dateCreated" datetime="2017-06-21T16:07:46-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yea i guess you can use it like this too. Im using models mostly for updating/creating/saving/deleting etc. For displaying i use <code>Phalcon\Mvc\Model\Resultset::toArray</code> anyway which a voids a lot of model hydration overhead anyway.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49005" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49005" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="49021" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '17</span>
              </span><br/><a name="C49021" href="#C49021">
                <time itemprop="dateCreated" datetime="2017-06-22T00:10:17-07:00" class="action-date">Jun '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/9683/petermoo">@petermoo</a> : You can also set globally PDO fetch mode. This is my approach, extending Phalcon classes:</p>
<pre><code class="language-php">//Resolve static PDO adapter from current scope, bind parameters bag and execute query, fetch entire result set
                $result = static::$adapter-&gt;query($sql, $criteria['bind']);

                //we need to override default DB service behaviour to always return objects
                $result-&gt;setFetchMode(\Phalcon\Db::FETCH_OBJ);

                $result = $result-&gt;fetchAll();

                return count($result) ? $result : 0x00;         </code></pre>
<p>Or even better globally on the db service itself: </p>
<pre><code class="language-php">$dbConfig['options'] = [
        \PDO::ATTR_DEFAULT_FETCH_MODE =&gt; \PDO::FETCH_OBJ, //force object as default or any other mode
        ];</code></pre>
<p>I must say that I like very much this term - <code>Middle</code> :) Kudos for<a href="https://forum.phalcon.io/user/9683/petermoo"> @petermoo</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49021" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49021" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49287" href="#C49287">
                <time itemprop="dateCreated" datetime="2017-07-02T20:02:52-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I decided that taking controll of the database is the first part of the answer to efficiency. if you know databases, you can make queries sing.</p>
<p>Removing the view code is the second part of my efficiency improvement because it is not adding anything for most of my Web site pages. I might use view for some pages when i am presenting a long list as a paged list. I do not see any other use.</p>
<p>At this stage my forms are really simple. Perhaps a multipage form could use a view. I want to acvoid multipage forms because they are messy to use. I occasionally have to fill out one and none of them work. A better approach is a checklist with a single page form for each item. You can then fill out parts and return to the rest later. I might start a separate discussion on that.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49287" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49287" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49363" href="#C49363">
                <time itemprop="dateCreated" datetime="2017-07-06T19:46:03-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>From a security perspective, the only public faceing file is index.php containing one line:</p>
<p>require dirname(<strong>DIR</strong>) . '/index.php';</p>
<p>The second index.php file contains only one line, require <strong>DIR</strong> . '/code/index.php';</p>
<p>The third index.php loads Config\Adapter\Ini, Di and Loader then loads index-micro.php or index-middle.php.</p>
<p>index-micro.php loads Micro and Response. Images are delivered direct through response. CSS and JS go through Volt to be customised. I will eventually add a Volt bypass for generated CSS and JS.</p>
<p>The response time is really fast for a page with a huge dynamically generated table containing images. :-)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49363" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49363" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49365" href="#C49365">
                <time itemprop="dateCreated" datetime="2017-07-07T00:00:49-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't get why you have 3 layer FrontPageConroller in place (i.e. your index.php x 3)?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49365" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49365" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a4422d89d7bed6763f236da321a1747f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/9683/petermoo" class="user-moderator-N"><span itemprop="name">Peter</span></a>        </span>
        <br>

        <span class="karma">9.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C49377" href="#C49377">
                <time itemprop="dateCreated" datetime="2017-07-07T16:44:23-07:00" class="action-date">Jul '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>The first one includes then code from outside the public directory. One of my security decisions based on experience of people changing the Web server settings in a way where code becomes visible. I simply include the same file from one level lower. Easy to remember.</p>
<p>The second index.php simply includes the code from the directory containing the code. Again an easy to remember setup. I sometimes have selection code here when there are multiple applications in the same Web site.</p>
<p>The third index.php file is the one that switches between the micro and middle applications. Currently it is based purely on the file suffix. I am about to split this part into three. image files will bepassed through direct. Some files will be passed to Volt and cached for repeat use. Everything else will go to the middle size application.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="49377" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="49377" data-cf-modified-f4a02c60fd4b54a58e4926c3-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="16365" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>