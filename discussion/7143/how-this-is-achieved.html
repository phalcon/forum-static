---
layout: default
title: 'how this is achieved? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">how this is achieved?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a></span>
            <time itemprop="dateCreated" datetime="2015-06-12T21:53:56-07:00">Jun '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-06-12T21:53:56-07:00">Jun '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">6</span>
                </td>
                <td>
                    <label>Views</label><br>578</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a></span>
                <span class="karma">1.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7143" href="#C7143">
        <time class="action-date">Jun '15</time>
    </a>
</div>
<div class="post-content"><div><p>I want to use this structure, could you please provide some help?</p>
<blockquote>
<p>controllers -&gt; modules -&gt; index -&gt; indexController.php</p>
<p>views -&gt; modules -&gt; index -&gt; index.phtml</p>
<p>controllers -&gt; modules -&gt; contact -&gt; contactController.php</p>
<p>views -&gt; modules -&gt; contact -&gt; contact.phtml</p>
</blockquote>
<p><img src="https://www.dropbox.com/s/pkqolcaijk7qrh1/Captura%20de%20pantalla%202015-06-12%2023.50.58.png?dl=1" alt="https://www.dropbox.com/s/pkqolcaijk7qrh1/Captura%20de%20pantalla%202015-06-12%2023.50.58.png?dl=1" /></p>
<p>Thanks in advance :)</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19453" href="#C19453">
                <time itemprop="dateCreated" datetime="2015-06-13T10:42:16-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Are you using namespaces? Do you want to have more than one module or is &quot;modules&quot; a static folder in the structure?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19453" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19453" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19461" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19461" href="#C19461">
                <time itemprop="dateCreated" datetime="2015-06-13T11:08:17-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>modules is static folder</p>
<p>modules -&gt;</p>
<pre><code>index (folder) -&gt; IndexController

other (folder) -&gt; OtherController</code></pre>
<p>lo necesito así por un tema de orden en mi proyecto</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19461" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19461" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19467" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19467" href="#C19467">
                <time itemprop="dateCreated" datetime="2015-06-13T11:35:59-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code>├── app
│   ├── config
│   │   └── config.php
│   ├── controllers
│   │   └── modules
│   │       ├── index
│   │       │   └── IndexController.php
│   │       └── other
│   │           └── OtherController.php
│   ├── models
│   └── views
│       └── modules
│           ├── index
│           │   └── index.phtml
│           └── other
│               └── index.phtml</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19467" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19467" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19473" href="#C19473">
                <time itemprop="dateCreated" datetime="2015-06-13T12:43:47-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Regarding views you have to change the viewsDir to point to modules $view-&gt;setDirsView('app/views/modules/');</p>
<p>Controllers are loaded following a PSR-0/PSR-4 structure so you have to ensure that the namespaces follow that structure.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19473" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19473" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19475" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19475" href="#C19475">
                <time itemprop="dateCreated" datetime="2015-06-13T13:08:42-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>efectivamente, cambiando la ruta de las vistas si funcionan pero tengo problemas con los controladores</p>
<pre><code>protected function registerAutoloaders()
{
    $loader = new Loader();
    $loader-&gt;registerNamespaces(array(
        'Single\Controller' =&gt; '../backend/controllers/modules/index/',
        // 'Single\Controller' =&gt; '../backend/controllers/modules/other/',
        'Single\Models'      =&gt; '../backend/models/'
    ));
    $loader-&gt;register();
}
protected function registerServices()
{
    $di = new DI();
    //Registering a router
    $di-&gt;set('router', function(){
        $router = new Router();
        $router-&gt;setDefaultNamespace('Single\Controller');
        return $router;
    });
    //Registering the view component
    $di-&gt;set('view', function(){
        $view = new View();
        $view-&gt;setViewsDir('../backend/views/modules/');
        return $view;
    });
    $this-&gt;setDI($di);
}</code></pre>
<p>this code work only index/</p>
<p>controllers/modules/index/IndexController.php</p>
<pre><code>namespace Single\Controller;
class IndexController extends \Phalcon\Mvc\Controller
{
    public function indexAction()
    {
    }</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19475" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19475" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19487" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19487" href="#C19487">
                <time itemprop="dateCreated" datetime="2015-06-14T15:36:14-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You need to use PSR-0/PSR-4 namespaces:</p>
<pre><code class="language-php">namespace Single\Controller\Index;

class IndexController extends \Phalcon\Mvc\Controller
{
    public function indexAction()
    {
    }</code></pre>
<pre><code class="language-php">$loader = new Loader();
    $loader-&gt;registerNamespaces(array(
        'Single\Controller\Index' =&gt; '../backend/controllers/modules/index/',
        'Single\Controller\Other' =&gt; '../backend/controllers/modules/other/',
        'Single\Models'      =&gt; '../backend/models/'
    ));
    $loader-&gt;register();
}</code></pre>
<p>But also register the routes to match these namespaces:</p>
<pre><code class="language-php">$router-&gt;add('/index', array(
    'namespace' =&gt; 'Single\Controller\Index',
    'controller =&gt; 'index',
    'action' =&gt; 'index'
);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19487" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19487" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19491" href="#C19491">
                <time itemprop="dateCreated" datetime="2015-06-14T18:30:50-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>yes work :)</p>
<p>I also get to this solution, there is no other faster way? Thanks for your time</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19491" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19491" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19535" href="#C19535">
                <time itemprop="dateCreated" datetime="2015-06-16T06:30:43-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Actually I manage to have this configuration for modules without problems. Tell me if you are interested since I could create a github repository to show the entire code. Each Module have it's own namespace.</p>
<pre><code>├── app
│   ├── config
│   │   └── config.php
│   ├── Modules
│   │   └── moduleA
│   │          └── Controllers
│   │          │     ├── admin
│   │          │     │   └── IndexController.php
│   │          │     │   └── OtherController.php
│   │          │     ├── front 
│   │          │     │   └── IndexController.php
│   │          │     │   └── OtherController.php
 │   │         │     └── other
│   │          │          └── OtherController.php
│   │          └── Models
│   │          └── Services
│   │  
│   └── views
│       └── moduleA
│            ├── admin
│            │   └── index   // for indexController in admin
│            │         └── index.volt
│            │         └── anotheractioninIndexController.volt
│            └── front
│            │   └── index   // for indexController in front
│            │         └── index.volt
│            │         └── anotheractioninIndexController.volt</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19535" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19535" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19537" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19537" href="#C19537">
                <time itemprop="dateCreated" datetime="2015-06-16T06:36:53-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Regarding to register the routes for each namespace I use this:</p>
<pre><code class="language-php">//on Module.php (on each module)
    public function registerServices(DiInterface $dependencyInjector = NULL)
    {
        $namespace = 'App\Base\Controllers';
        $dependencyInjector['dispatcher']-&gt;setDefaultNamespace($namespace);
    }</code></pre>
<p>This way, each time you are heading for a module, the namespace is set automatically based on the module, no need to define it on each route and you can have generic routes:</p>
<pre><code class="language-php">$router-&gt;add("/:module/:action", array(
    'module' =&gt; 1,
    'controller' =&gt; 'index',
    'action' =&gt; 2,
));</code></pre>
<p>also, instead of defining a default namespace use the defaultModule</p>
<pre><code class="language-php">$router-&gt;setDefaultModule('base');</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19537" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19537" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5cf5eb5f798184833969e02d4fcf453a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3941/juanpablocs" class="user-moderator-N"><span itemprop="name">Juan pablo</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19549" href="#C19549">
                <time itemprop="dateCreated" datetime="2015-06-16T08:18:55-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>please share repository github :D</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19549" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19549" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d6143a9ff65d2d5222c30fb0d76664a7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3646/Surt" class="user-moderator-N"><span itemprop="name">Erik Wiesenthal</span></a>        </span>
        <br>

        <span class="karma">23.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19691" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19691" href="#C19691">
                <time itemprop="dateCreated" datetime="2015-06-19T01:16:50-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Instead of a git repo I think it could be resumed here.</p>
<p>So, the goal is to have this app structure:</p>
<pre><code>├── app
│   ├── config
│   │   └── config.php
│   ├── Modules
│   │   └── ModuleA
│   │          └── Controllers
│   │          │     ├── admin
│   │          │     │   └── IndexController.php
│   │          │     │   └── OtherController.php
│   │          │     ├── front 
│   │          │     │   └── IndexController.php
│   │          │     │   └── OtherController.php
 │   │         │     └── other
│   │          │          └── OtherController.php
│   │          └── Models
│   │          └── Services
│   │  
│   └── views
│       └── modulea
│            ├── admin
│            │   └── index   // for indexController in admin
│            │         └── index.volt
│            │         └── anotheractioninIndexController.volt
│            └── front
│            │   └── index   // for indexController in front
│            │         └── index.volt
│            │         └── anotheractioninIndexController.volt
</code></pre>
<p>Actually, I set each module as a git repo and I load them trought composer, outside of the app folder. But since the place in the directory only depends in terms of autoload it does not matter too much.</p>
<p>I set namespaces for each module. For example, moduleA have <code>App\ModuleA</code>  as base namespace. So:</p>
<pre><code>
App\ModuleA\Controllers
   |_ App\ModuleA\Controllers\IndexController
   |_ admin
              |_ App\ModuleA\Controllers\Admin\IndexController
              |_,,,,
     |_ ...
App\ModuleA\Models
App\ModuleA\Services
</code></pre>
<p>We just need to set a router, a generic one like:</p>
<p>I wanted to do this kind of dispatching:</p>
<ul>
<li>/admin/modulea/list          ==&gt; App\ModuleA\Controllers\Admin\IndexController::listAction</li>
<li>/admin/modulea/1/view    ==&gt; App\ModuleA\Controllers\Admin\IndexController::viewAction(element_id)</li>
<li>/admin/modulea/1/subcontroller/2/view  ==&gt;  App\ModuleA\Controllers\Admin\SubcontrollerController::viewAction(element_id, subelement_id)</li>
<li>/modulea/other/1/view     ==&gt; App\ModuleA\Controllers\OtherController::view(1)</li>
</ul>
<p>Using this I can manage to use the routes in similar way to a rest routes (still not 100% accurate but I didn't put too much time in it)</p>
<p>Notice that there is no namespace defined.</p>
<pre><code class="language-php">$router = new Router(true);

$router-&gt;setDefaultModule('modulea');

$router-&gt;add("/", array(
    'module' =&gt; 'modulea',
    'controller' =&gt; 'index'
));

$router-&gt;add("/:action", array(
    'module' =&gt; 'modulea',
    'controller' =&gt; 'index',
    'action' =&gt; 1,
));

$router-&gt;add("/:module/:action", array(
    'module' =&gt; 1,
    'controller' =&gt; 'index',
    'action' =&gt; 2,
));

$router-&gt;add("/:module/:action", array(
    'module' =&gt; 1,
    'controller' =&gt; 'index',
    'action' =&gt; 2,
));

$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/:action", array(
    'module' =&gt; 1,
    'controller' =&gt; 'index',
    'element' =&gt; 2,
    'action' =&gt; 3,
));

$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/:controller/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'controller' =&gt; 3,
    'action' =&gt; 4,
));

$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/:controller/([a-zA-Z0-9_-]+)/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'controller' =&gt; 3,
    'action' =&gt; 5,
    'subelement' =&gt; 4,
));

$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/:controller/([a-zA-Z0-9_-]+)/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'controller' =&gt; 3,
    'subelement' =&gt; 4,
    'action' =&gt; 5
));

// third param is wasted, we don't need it
$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/:controller/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'subelement' =&gt; 4,
    'controller' =&gt; 5,
    'action' =&gt; 6,
));

$router-&gt;add("/:module/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/:controller/([a-zA-Z0-9_-]+)/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'subelement' =&gt; 4,
    'controller' =&gt; 5,
    'hiperelement' =&gt; 6,
    'action' =&gt; 7,
));

// since I don't know how to use the grouped routes I'm repeating the same with each resource:
// Notice the resource param added, so we can tell the dispatcher that a subfolder is used

$router-&gt;add("/admin/:module/([a-zA-Z0-9_-]+)/:controller/:action", array(
    'module' =&gt; 1,
    'element' =&gt; 2,
    'controller' =&gt; 3,
    'action' =&gt; 4,
    'resource' =&gt; 'admin'
));

//......</code></pre>
<p>I still think that the phalcon router lacks many things for this way of doing things but... it works</p>
<p>Modules are registered as always:</p>
<pre><code class="language-php">
$application-&gt;registerModules(array(
    'modulea' =&gt; array(
        'namespaceName'  =&gt; 'App\ModuleA\Controllers',
        'className' =&gt; 'App\ModuleA\Module',
        'path' =&gt; $this-&gt;getDi()-&gt;getShared('config')-&gt;paths-&gt;modules_path.'ModuleA'.DS.'Module.php'
    ), // ....
);
</code></pre>
<p>We just need to tell the system wich namespace needs to load when inside a Module. Lets do it inside the Module.php </p>
<pre><code class="language-php">
    public function registerServices(DiInterface $dependencyInjector = NULL)
    {
        $namespace = 'App\ModuleA\Controllers';

        $resource = null;
        if (isset($dependencyInjector['router']-&gt;getParams()['resource'])) {
            $resource = $dependencyInjector['router']-&gt;getParams()['resource'];
        }

        $namespace .= '\\'.ucfirst($resource); // adding the subdir as namespace route
        $dependencyInjector['dispatcher']-&gt;setDefaultNamespace($namespace);
    }
</code></pre>
<p>Now we need to load the adecuate views and layouts. This is a temporal workaround:</p>
<pre><code class="language-php">
        $di-&gt;getShared('eventsManager')-&gt;attach("dispatch:beforeDispatch", function ($event, \Phalcon\Mvc\Dispatcher $dispatcher) use ($di) {
            $layout_dir = '..' . DS;

            $di['view']-&gt;setLayout('index');
            $layout_dir .= '';

            $path_view = '';
            if ($resource = $dispatcher-&gt;getParam('resource')) {
                $path_view = $resource . DS;
                $di['view']-&gt;setLayout($resource);
                $layout_dir .= '..' . DS;
            }

            $dir = strtolower($di['router']-&gt;getModuleName()) . DS . $path_view;
            $di['view']-&gt;setViewsDir($dir);
            $di['view']-&gt;setLayoutsDir($layout_dir . 'layouts' . DS);
        });

        $di['dispatcher']-&gt;setEventsManager($di-&gt;getShared('eventsManager'));
</code></pre>
<p>And it's done. Tell me what you think. (It still have room for many improvements)</p>
<p>P.D. Of course you can call any Model or Service, etc from any model, it is just related to the autoloading. The only thing we do is to guide the dispatcher to load the good Controller based on the module namespace and mess a little with the view paths.</p>
<p>P.D. Creo que tenemos las mismas manías a la hora de organizar la estructura de directorios :p</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19691" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19691" data-cf-modified-8c2a5b44e2eb487dfa923c7e-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7143" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>