---
layout: default
title: 'Hierarchical data sets - Closure table - Transitive closure - Adjacency list - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/24/show-community">Show to Community</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Hierarchical data sets - Closure table - Transitive closure - Adjacency list</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/21/benfavre" class="user-moderator-N"><span itemprop="name">Webdesign29</span></a></span>
            <time itemprop="dateCreated" datetime="2014-08-23T17:18:29-07:00">Aug '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-08-23T17:18:29-07:00">Aug '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>None</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">0</span>
                </td>
                <td>
                    <label>Views</label><br>2590</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/306b83436a7d0d972007bf2daebf51fd?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/21/benfavre" class="user-moderator-N"><span itemprop="name">Webdesign29</span></a></span>
                <span class="karma">5.0k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C3223" href="#C3223">
        <time class="action-date">Aug '14</time>
    </a>
</div>
<div class="post-content"><div><p>Ok, so I spent alot of time researching relational algorithms for inputing some hierarchical data into Mysql.</p>
<p>I wanted :  </p>
<ul>
<li>no excessive db writes if the tree gets modified.</li>
<li>fast to query the data</li>
<li>easy to modify tree hierarchy (move nodes)</li>
</ul>
<p><strong>Nested set</strong></p>
<p>The Nested set algorithm in the incubator looks great except my tree is rather large.
Inserts to the bottom of the tree, trigger recursive updates all the way up the tree.</p>
<p>Let's say i have a company hierarchy with the whole employee structure and frequently add new customers to the bottom most part/leaf of the hierarchy tree.
The nested set algorithm is clearly not made for this :
<strong>Each insert triggers updates right up to the top !!</strong></p>
<p>The nested set could be improved and use the nested interval algorithm but this isn't my point.</p>
<p><strong>Closure table, Transitive closure</strong></p>
<p>I think it would be interesting to have an official phalcon php implementation of &quot;closure tables&quot; (improved adjacency list).
It's basically a self referential many to many relationship, with triggers and some data redundancy.</p>
<ul>
<li>Inserts to the tree do not trigger updates on other nodes. They instead, populate the paths to the inserted node in the closure table.</li>
<li>Moving a node only triggers updates to the node's own children.</li>
<li>Using a &quot;depth&quot; or &quot;path_length&quot; column make's it easy to represent the whole tree structure. You can also easily query any specific level in the tree.</li>
</ul>
<p><strong>My solution for now</strong></p>
<p>For my particular project i'm using mysql triggers and some stored procedures but would have prefered to keep this on the php side of things because now i have to run migrations on all my remote boxes that will be running this app if i need to change something.</p>
<p>I used this as a reference : <a href="https://github.com/developerworks/hierarchy-data-closure-table">https://github.com/developerworks/hierarchy-data-closure-table</a></p>
<p><strong>Sources</strong></p>
<p>More reading :
<a href="https://dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html">https://dirtsimple.org/2010/11/simplest-way-to-do-tree-based-queries.html</a></p>
<p><a href="https://en.wikipedia.org/wiki/Transitive_closure">https://en.wikipedia.org/wiki/Transitive_closure</a></p>
<p>Video overview of different algorithms :
<a href="https://www.youtube.com/watch?v=wuH5OoPC3hA">https://www.youtube.com/watch?v=wuH5OoPC3hA</a></p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-6ca2c1b930bef0d4bfadaed9-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-6ca2c1b930bef0d4bfadaed9-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="3223" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>