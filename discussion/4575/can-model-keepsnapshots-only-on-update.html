---
layout: default
title: 'Can model keepsnapshots only on update ? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/29/database">Database</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Can model keepsnapshots only on update ?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2394/advokata" class="user-moderator-N"><span itemprop="name">advokata</span></a></span>
            <time itemprop="dateCreated" datetime="2015-01-24T19:07:23-07:00">Jan '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-01-24T19:07:23-07:00">Jan '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>885</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/8f89714c6cbd3f981317cf94cec3fc0c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2394/advokata" class="user-moderator-N"><span itemprop="name">advokata</span></a></span>
                <span class="karma">1.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C4575" href="#C4575">
        <time class="action-date">Jan '15</time>
    </a>
</div>
<div class="post-content"><div><p>I want to know what exactly keepsnapshots do in the model.
Could this make only on update snapshot, because i use a lot of ModelName::find() without update. I couldn't need snapshot for this action and this will slow my application performance and will produce more Memory consumption which is not neccessary. I want only when I update information to keepsnapshot and use my Blame Class to save changed fields.  Is it possible ?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-e30de25e337d69b30613c4bf-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-e30de25e337d69b30613c4bf-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15283" href="#C15283">
                <time itemprop="dateCreated" datetime="2015-01-24T21:14:34-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">$this-&gt;useDynamicUpdate(true);</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15283" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15283" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8f89714c6cbd3f981317cf94cec3fc0c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2394/advokata" class="user-moderator-N"><span itemprop="name">advokata</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15294" href="#C15294">
                <time itemprop="dateCreated" datetime="2015-01-25T08:48:02-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>useDynamicUpdate will make snapshot? It is possible to make $this-&gt;keepsnapshots (true) in beforeUpdate Method. I think that this will make.snapshot only when I update record. Is it true?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15294" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15294" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15295" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15295" href="#C15295">
                <time itemprop="dateCreated" datetime="2015-01-25T09:19:45-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>dynamic update will force the update to be updating only the fields that have changed.
so when you make your blameable class track the query used, it will only show the fields that have changed. meaning you have to rewrite that class to hijack and store the query used. which is different from the blame class provided.</p>
<p>if you only want a snapshot only when updating, sure you can do it too.</p>
<pre><code class="language-php">public function beforeSave()
{
    if($id != 0)
    {
        $data = $this-&gt;findFirst($id)-&gt;toArray();
        $this-&gt;setSnapshotData($data);
    }
}</code></pre>
<p>and viola. however if you do this. there will be more cycle consumption, both web server and database. which will really slow your application down. because it has to retrieve the data from database AGAIN. however if you use the snapshot data when you first retrieve it there is no additional cycle. just memory consumption.</p>
<p>so its really up to you. and seriously unless your model is stupid huge, the consumption of keeping the snapshot when it is first retrieve would be a few bytes the most. also if your model is stupid huge that means you really need to work on designing your database model. normalization.</p>
<p>Imo, stick to snapshot from retriving.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15295" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15295" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8f89714c6cbd3f981317cf94cec3fc0c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2394/advokata" class="user-moderator-N"><span itemprop="name">advokata</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15332" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15332" href="#C15332">
                <time itemprop="dateCreated" datetime="2015-01-26T08:44:03-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok I understand but i have another question :)</p>
<p>If i set:
public function initialize() {
$this-&gt;keepSnapshots(true);
}</p>
<p>This will make snapshot every time when i use ModelName::findFirst(); or ModelName::find();
When the snapshot will be removed from memory ? When this snapshot will expire ?</p>
<p>Sorry for my questions but i want to understand how keepsnapshot works and according to this to make a decision to implement or not Blame class in my application.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15332" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15332" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15334" href="#C15334">
                <time itemprop="dateCreated" datetime="2015-01-26T10:06:12-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think you misunderstand how php works.</p>
<p>The only thing that is kept is the info in session, again those are either in memory/files.
The rest of everything is brand new. Every single time you go to a different page, the entire application is cleared from memory, and reinitialized again. = =&quot;</p>
<p>request1 start
request1 finished
exit
request2 start
request2 finished
exit.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15334" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15334" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8f89714c6cbd3f981317cf94cec3fc0c?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2394/advokata" class="user-moderator-N"><span itemprop="name">advokata</span></a>        </span>
        <br>

        <span class="karma">1.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15345" href="#C15345">
                <time itemprop="dateCreated" datetime="2015-01-26T12:53:56-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I know how php works and now I understood how snapshot works :) . It keep snapshot of the model only when is executing.  Thanks alot for your help.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15345" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15345" data-cf-modified-e30de25e337d69b30613c4bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="4575" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>