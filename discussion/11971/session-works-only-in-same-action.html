---
layout: default
title: 'Session works only in same Action - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/28/session">Session</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Session works only in same Action</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a></span>
            <time itemprop="dateCreated" datetime="2016-06-29T12:46:34-07:00">Jun '16</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2016-06-29T12:46:34-07:00">Jun '16</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>661</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/88c20f295ea45b0801ec3c2ee9488ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a></span>
                <span class="karma">18.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C11971" href="#C11971">
        <time class="action-date">Jun '16</time>
    </a>
</div>
<div class="post-content"><div><p>I created a docker container with last phalcon version in docker and now sessions don't works anymore, just works in the same action, in other action in same controller or not don't works.</p>
<p>I created a new phalcon project to test and i get the same problem, someone get the same problem?
Anybody can test for confirm this error?</p>
<pre><code>*** Container Info ***
Nginx last stable version
PHP5-FPM last stable version
Phalcon last stable version
Ubuntu14.4</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36165" href="#C36165">
                <time itemprop="dateCreated" datetime="2016-06-29T15:32:05-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Whta does your services.php look like?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36165" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36165" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/88c20f295ea45b0801ec3c2ee9488ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a>        </span>
        <br>

        <span class="karma">18.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36181" href="#C36181">
                <time itemprop="dateCreated" datetime="2016-06-30T12:43:13-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">&lt;?php
/**
 * Services are globally registered in this file
 *
 * @var \Phalcon\Config $config
 */

use Phalcon\Di\FactoryDefault;
use Phalcon\Mvc\View;
use Phalcon\Mvc\Url as UrlResolver;
use Phalcon\Mvc\View\Engine\Volt as VoltEngine;
use Phalcon\Mvc\Model\Metadata\Memory as MetaDataAdapter;
use Phalcon\Session\Adapter\Files as SessionAdapter;
use Phalcon\Flash\Direct as Flash;

/**
 * The FactoryDefault Dependency Injector automatically register the right services providing a full stack framework
 */
$di = new FactoryDefault();

/**
 * The URL component is used to generate all kind of urls in the application
 */
$di-&gt;setShared('url', function () use ($config) {
    $url = new UrlResolver();
    $url-&gt;setBaseUri($config-&gt;application-&gt;baseUri);

    return $url;
});

/**
 * Setting up the view component
 */
$di-&gt;setShared('view', function () use ($config) {

    $view = new View();

    $view-&gt;setViewsDir($config-&gt;application-&gt;viewsDir);

    $view-&gt;registerEngines(array(
        '.volt' =&gt; function ($view, $di) use ($config) {

            $volt = new VoltEngine($view, $di);

            $volt-&gt;setOptions(array(
                'compiledPath' =&gt; $config-&gt;application-&gt;cacheDir,
                'compiledSeparator' =&gt; '_'
            ));

            return $volt;
        },
        '.phtml' =&gt; 'Phalcon\Mvc\View\Engine\Php'
    ));

    return $view;
});

/**
 * Database connection is created based in the parameters defined in the configuration file
 */
$di-&gt;setShared('db', function () use ($config) {
    $dbConfig = $config-&gt;database-&gt;toArray();
    $adapter = $dbConfig['adapter'];
    unset($dbConfig['adapter']);

    $class = 'Phalcon\Db\Adapter\Pdo\\' . $adapter;

    return new $class($dbConfig);
});

/**
 * If the configuration specify the use of metadata adapter use it or use memory otherwise
 */
$di-&gt;setShared('modelsMetadata', function () {
    return new MetaDataAdapter();
});

/**
 * Register the session flash service with the Twitter Bootstrap classes
 */
$di-&gt;set('flash', function () {
    return new Flash(array(
        'error'   =&gt; 'alert alert-danger',
        'success' =&gt; 'alert alert-success',
        'notice'  =&gt; 'alert alert-info',
        'warning' =&gt; 'alert alert-warning'
    ));
});

/**
 * Start the session the first time some component request the session service
 */
$di-&gt;setShared('session', function () {
    $session = new SessionAdapter();
    $session-&gt;start();

    return $session;
});
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36181" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36181" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36183" href="#C36183">
                <time itemprop="dateCreated" datetime="2016-06-30T13:23:23-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Looks good.  The biggest difference I see between yours and mine are flash and modelsMetadata...  Maybe comment those out and see if session works?  Looking at the file, I have no other ides.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36183" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36183" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/88c20f295ea45b0801ec3c2ee9488ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a>        </span>
        <br>

        <span class="karma">18.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C36183"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Zach                    </a>
                </div><div class="posts-buttons" align="right"><a name="C36187" href="#C36187">
                <time itemprop="dateCreated" datetime="2016-06-30T13:32:39-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I realized tests here now and realized that session variables are persisted to the other controller actions only if I put it in an initialize method in the controller, otherwise if I create them within an action they are only persisted within that action, if I go to another action they are no longer displayed.</p>
<pre><code class="language-php">//This way works in others controller actions
//but not in another controllers
public function initialize()
    {
      $this-&gt;session-&gt;set('name', 'MarcosJr');
      $this-&gt;persistent-&gt;name = 'MJ';
    }
</code></pre>
<p>And even putting them in the initialize method of a controller if I go to another controller they are no longer displayed, I find it strange, I thought the session variables should be global, and before so it worked, I do not know coz no longer works this way, you have any idea?</p>
<blockquote>
<p>Looks good.  The biggest difference I see between yours and mine are flash and modelsMetadata...  Maybe comment those out and see if session works?  Looking at the file, I have no other ides.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36187" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36187" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/88c20f295ea45b0801ec3c2ee9488ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a>        </span>
        <br>

        <span class="karma">18.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36191" href="#C36191">
                <time itemprop="dateCreated" datetime="2016-06-30T14:22:25-07:00" class="action-date">Jun '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I continued conducting tests here, this time created a container installing PHALCON / legacy, and the session worked perfectly, as I suspected is a problem with this latest version of Phalcon, so that to install this latest version I had never had this kind of problem before, somehow this latest estable version of Phalcon leaves epnas session variables in the action scopo where it was created, or do not know why but it's a serious bug ...</p>
<p>Anyone else could test to confirm this?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36191" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36191" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3916/zhegwood" class="user-moderator-N"><span itemprop="name">Zach</span></a>        </span>
        <br>

        <span class="karma">17.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C36437" href="#C36437">
                <time itemprop="dateCreated" datetime="2016-07-05T10:43:05-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What are you doing to retrieve the value in the other actions/controllers?</p>
<p>$this-&gt;session-&gt;get('name'); should be what you're calling.</p>
<p>I don't use $this-&gt;persistent anywhere, so not sure about that one.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36437" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36437" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/88c20f295ea45b0801ec3c2ee9488ba1?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/2826/MarcosJrBR" class="user-moderator-N"><span itemprop="name">Marcos Junior</span></a>        </span>
        <br>

        <span class="karma">18.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C36437"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e00a6fdd3e722135512e013b7f1e9693?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Zach                    </a>
                </div><div class="posts-buttons" align="right"><a name="C36585" href="#C36585">
                <time itemprop="dateCreated" datetime="2016-07-10T16:19:51-07:00" class="action-date">Jul '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I did both ways just to test if any of them work, but none worked on the latest version of PHALCON only in legacy, the legacy both work perfectly.</p>
<blockquote>
<p>What are you doing to retrieve the value in the other actions/controllers?</p>
<p>$this-&gt;session-&gt;get('name'); should be what you're calling.</p>
<p>I don't use $this-&gt;persistent anywhere, so not sure about that one.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="36585" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="36585" data-cf-modified-fb8ddd98695ea28dd8baeb69-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="11971" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>