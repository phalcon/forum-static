---
layout: default
title: 'Sending a response when beforeDispatch has returned false - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/11/events-manager">Events</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Sending a response when beforeDispatch has returned false</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4285/ioncube" class="user-moderator-N"><span itemprop="name">ioncube</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-05T16:28:35-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-05T16:28:35-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>549</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/7fb0b078bf8b16fa5451858d7e3921ff?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4285/ioncube" class="user-moderator-N"><span itemprop="name">ioncube</span></a></span>
                <span class="karma">3.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7453" href="#C7453">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>Hi</p>
<p>I found that when returning false from a beforeDispatch event that has produced and called send() on an Http\response that no output is received by the client. Bailing out with exit() after the send does return the response to the client, but is a nasty kludge. Is there an official way to send a response when a request has been abandoned?  </p>
<p>As an aside, I found too that returning false from a beforeDispatch event interceptor does <em>not</em> stop the request if a subsequent beforeDispatch interceptor returns true, It seems the last response is taken, which could be worth documenting.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-64fe76803f1456ba13765fc0-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-64fe76803f1456ba13765fc0-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20277" href="#C20277">
                <time itemprop="dateCreated" datetime="2015-07-06T07:48:24-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Call send() manually is bad practice, what you have to do is return the response in an action, or obtain the 'response' service from the DI and call setContent() returning false from beforeDispatch.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20277" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20277" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/7fb0b078bf8b16fa5451858d7e3921ff?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4285/ioncube" class="user-moderator-N"><span itemprop="name">ioncube</span></a>        </span>
        <br>

        <span class="karma">3.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C20277"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Andres Gutierrez                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20281" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20281" href="#C20281">
                <time itemprop="dateCreated" datetime="2015-07-06T11:20:22-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi Andres</p>
<blockquote>
<p>Call send() manually is bad practice, what you have to do is return the response in an action, or obtain the 'response' service from the DI and call setContent() returning false from beforeDispatch.</p>
</blockquote>
<p>I agree, and the code already does what you suggest. the event handler decides that the request cannot be processed due to security reasons and uses a responder component that accesses a DI'd $this-&gt;response and sets headers plus a Json response via setJsonContent(). Despite this the response never makes it back to the client unless we bail with exit().</p>
<p>Calling forward() on the dispatcher does seem to work, so it seems that it's not possible to send a response if the dispatcher has nothing to do. One view could be that if there's no request processed there cannot be a response, but on the other hand we want to send a response precisely to say that no request was processed :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20281" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20281" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/7fb0b078bf8b16fa5451858d7e3921ff?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4285/ioncube" class="user-moderator-N"><span itemprop="name">ioncube</span></a>        </span>
        <br>

        <span class="karma">3.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="20295" data-toggle="modal" data-target="#historyModal">
                edited <span>Jul '15</span>
              </span><br/><a name="C20295" href="#C20295">
                <time itemprop="dateCreated" datetime="2015-07-06T17:25:28-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Andres</p>
<p>Just so we're completely sure. Is it officially only possible to return a response if an action is processed, and observing that response content <em>is</em> sent if we exit() after producing a response but not otherwise, is the response effectively being discarded by phalcon and not flushed if the last beforeDispatch event handler returns false?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20295" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20295" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20357" href="#C20357">
                <time itemprop="dateCreated" datetime="2015-07-07T22:21:50-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>A response must be returned from the dispatcher. You can make $dispatcher-&gt;setReturnedValue($response) to override the response or return the response from an action.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20357" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20357" data-cf-modified-64fe76803f1456ba13765fc0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7453" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>