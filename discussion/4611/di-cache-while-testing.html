---
layout: default
title: 'DI cache while testing - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/10/di-ioc">DI/IoC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">DI cache while testing</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a></span>
            <time itemprop="dateCreated" datetime="2015-01-28T08:09:35-07:00">Jan '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-01-28T08:09:35-07:00">Jan '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">11</span>
                </td>
                <td>
                    <label>Views</label><br>720</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a></span>
                <span class="karma">2.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C4611" href="#C4611">
        <time class="action-date">Jan '15</time>
    </a>
</div>
<div class="post-content"><div><p>I have some testing and it call controllers like so:</p>
<pre><code class="language-php">    \Phalcon\DI::reset();
    \Phalcon\DI::setDefault($this-&gt;di);

    $dispatcher = new \Phalcon\Mvc\Dispatcher();
    $dispatcher-&gt;setDI(\Phalcon\DI::getDefault());
    $dispatcher-&gt;setControllerName('Api\\Controllers\\' . $this-&gt;controller);
    $dispatcher-&gt;setActionName($action);
    $dispatcher-&gt;setParams([$debug]);

    $object = $dispatcher-&gt;dispatch();
    return call_user_func([$object, $action . 'Action']);</code></pre>
<p>When i calling controller in one test multiple times i got some strange results.
In my controller for this test i dump a DI service that handle a parser request:</p>
<pre><code class="language-php">    if ($debug) {
      var_dump($this-&gt;apiRequest-&gt;request);
      var_dump($this-&gt;di-&gt;get('apiRequest'));
      exit();
    }</code></pre>
<p>In first case i got:</p>
<pre><code class="language-php">object(stdClass)#368 (3) {
  ["payment_id"]=&gt;
  int(1417693101)
  ["timestamp"]=&gt;
  int(1417693051)
  ["user_id"]=&gt;
  int(4)
}</code></pre>
<p>In second case i got: </p>
<pre><code class="language-php">object(stdClass)#374 (5) {
  ["request_id"]=&gt;
  int(14224571498071)
  ["atm"]=&gt;
  int(295)
  ["request_hash"]=&gt;
  string(47) "14224571498071:ca3ad13574476de68c4dc2f37c481a63"
  ["request"]=&gt;
  object(stdClass)#375 (4) {
    ["cash"]=&gt;
    array(0) {
    }
    ["payment_id"]=&gt;
    int(1417693101)
    ["timestamp"]=&gt;
    int(1417693051)
    ["user_id"]=&gt;
    int(4)
  }
  ["hash"]=&gt;
  string(40) "ac4fbc57a94d5687f9c35c2927b78b4b6471b05e"
}</code></pre>
<p>My question - is <code>$this-&gt;&lt;di_service_name&gt;</code> is not shortcut of <code>$this-&gt;di-&gt;get(&lt;di_service_name&gt;)</code> ?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15439" href="#C15439">
                <time itemprop="dateCreated" datetime="2015-01-28T08:40:54-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">//$this-&gt;apiRequest-&gt;request == $this-&gt;di-&gt;get("apiRequest")-&gt;request;

   if ($debug) {
      var_dump($this-&gt;apiRequest-&gt;request); &lt;&lt; 
      var_dump($this-&gt;di-&gt;get('apiRequest')); &lt;&lt;
      exit();
    }</code></pre>
<p>bro you are clearly dumping 2 different things</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15439" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15439" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15439"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        7thcubic                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15440" href="#C15440">
                <time itemprop="dateCreated" datetime="2015-01-28T08:42:48-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>By default all DI services available through <code>$this</code> in controller. I think that <code>$this-&gt;request</code> and <code>$this-&gt;di-&gt;get('request')</code> is similar things, and <code>$this-&gt;request</code> is just a shortcut in controller to call <code>$this-&gt;di-&gt;get('request')</code></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15440" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15440" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15439"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        7thcubic                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15442" href="#C15442">
                <time itemprop="dateCreated" datetime="2015-01-28T08:44:34-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>And yes, you can see in one case i dump higher level of object. But you can see, that it don't have a <code>cash</code> param.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15442" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15442" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15445" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15445" href="#C15445">
                <time itemprop="dateCreated" datetime="2015-01-28T08:51:52-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>interesting. could you post the class thanks. also the version. </p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15445" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15445" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15446" href="#C15446">
                <time itemprop="dateCreated" datetime="2015-01-28T08:53:28-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It's kinda complicated, i'll try to implement it simplier</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15446" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15446" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15449" href="#C15449">
                <time itemprop="dateCreated" datetime="2015-01-28T09:10:33-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok, this is a testing project:</p>
<pre><code>Controllers\
- TestController.php
Helpers\
- Runner.php
index.php</code></pre>
<p>Index file:</p>
<pre><code class="language-php">// index.php
&lt;?php
$loader = new \Phalcon\Loader();
$loader-&gt;registerNamespaces([
  'Controllers' =&gt; __DIR__ . '/Controllers/',
  'Helpers'     =&gt; __DIR__ . '/Helpers/',
]);
$loader-&gt;register();

$di = new \Phalcon\DI\FactoryDefault();
$di-&gt;set('test_service', function() {
  return json_decode('[1, 2, 3]');
});

\Phalcon\DI::reset();
\Phalcon\DI::setDefault($di);

$firstRun = new \Helpers\Runner();
$secondRun = new \Helpers\Runner();</code></pre>
<p>Helper file, that running:</p>
<pre><code class="language-php">// Helpers/Runner.php
&lt;?php
namespace Helpers;

class Runner {
  private $di;
  private $numbers;

  public function __construct() {
    $this-&gt;numbers = range(1, 100);

    $this-&gt;di = \Phalcon\DI::getDefault();
    $this-&gt;di-&gt;set('test_service', function() {
      return json_decode(json_encode(array_rand($this-&gt;numbers, 5)));
    });

    \Phalcon\DI::reset();
    \Phalcon\DI::setDefault($this-&gt;di);

    $dispatcher = new \Phalcon\Mvc\Dispatcher();
    $dispatcher-&gt;setDI(\Phalcon\DI::getDefault());
    $dispatcher-&gt;setControllerName('Controllers\\Test');
    $dispatcher-&gt;setActionName('index');

    return $dispatcher-&gt;dispatch();
  }
}</code></pre>
<p>And controller:</p>
<pre><code class="language-php">// Controllers\TestController.php
&lt;?php
namespace Controllers;

class TestController extends \Phalcon\Mvc\Controller {
  public function indexAction() {
    echo 'Calling indexAction' . PHP_EOL;
    echo 'Service from $this: ' . json_encode($this-&gt;test_service) . PHP_EOL;
    echo 'Service from DI: ' . json_encode($this-&gt;di-&gt;get('test_service')) . PHP_EOL;
    echo str_repeat('=', 100) . PHP_EOL;
  }
}</code></pre>
<p>When i run <code>php index.php</code>, i got following output:</p>
<pre><code>Calling indexAction
Service from $this: [4,48,52,72,91]
Service from DI: [29,63,74,79,82]
====================================================================================================
Calling indexAction
Service from $this: [4,48,52,72,91]
Service from DI: [5,24,38,67,83]
====================================================================================================</code></pre>
<p>As we can see, service called from <code>$this</code> cached, no matter how it created <code>set</code> or <code>setShared</code></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15449" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15449" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15450" href="#C15450">
                <time itemprop="dateCreated" datetime="2015-01-28T09:11:37-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Version is <strong>1.3.4</strong></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15450" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15450" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15452" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15452" href="#C15452">
                <time itemprop="dateCreated" datetime="2015-01-28T10:24:28-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>can you try this
<a href="http://docs.phalcon.io/en/latest/api/Phalcon_Mvc_User_Component.html">http://docs.phalcon.io/en/latest/api/Phalcon_Mvc_User_Component.html</a></p>
<p>extend your helper class with that and  $this-&gt;di = \Phalcon\DI::getDefault(); also inject the helper into di</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15452" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15452" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15453" href="#C15453">
                <time itemprop="dateCreated" datetime="2015-01-28T11:19:49-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Problem not in Helper class.
Main problem in Controller, that caches magick method.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15453" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15453" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15456" href="#C15456">
                <time itemprop="dateCreated" datetime="2015-01-28T13:59:16-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>OH!</p>
<p>try setShared</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15456" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15456" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15458" href="#C15458">
                <time itemprop="dateCreated" datetime="2015-01-28T14:15:31-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><code>$this-&gt;test_service</code> is  a controller property. The controller has the value after the first access to it in the controller. You say it &quot;cached&quot;.</p>
<p>If you want to change it, create another controller object.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15458" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15458" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15456"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        7thcubic                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15459" href="#C15459">
                <time itemprop="dateCreated" datetime="2015-01-28T14:16:25-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It will not work, setShared will only retrieve a same intance of service niether to instantiate new one.
I'll tried it btw, and it is the same.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15459" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15459" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15458"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        kenjis                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15460" href="#C15460">
                <time itemprop="dateCreated" datetime="2015-01-28T14:18:03-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think you looked bad at my code, look at that place:</p>
<pre><code class="language-php">    $dispatcher = new \Phalcon\Mvc\Dispatcher();
    $dispatcher-&gt;setDI(\Phalcon\DI::getDefault());
    $dispatcher-&gt;setControllerName('Controllers\\Test');
    $dispatcher-&gt;setActionName('index');

    $return = $dispatcher-&gt;dispatch();</code></pre>
<p>Every call a new dispatcher instantiated.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15460" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15460" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15466" href="#C15466">
                <time itemprop="dateCreated" datetime="2015-01-28T14:36:04-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I slightly tune-up a code, to check that it's not a same objects:</p>
<pre><code class="language-php">&lt;?php
// Helpers\Runner.php
namespace Helpers;

class Runner{
  private $di;
  private $numbers;

  public function __construct() {
    $this-&gt;numbers = range(1, 100);

    $this-&gt;di = \Phalcon\DI::getDefault();
    $this-&gt;di-&gt;set('test_service', function() {
      return json_decode(json_encode(array_rand($this-&gt;numbers, 5)));
    });

    \Phalcon\DI::reset();
    \Phalcon\DI::setDefault($this-&gt;di);

    $controller = new \Controllers\TestController();
    $controller-&gt;indexAction();
  }
}</code></pre>
<p>It output a following now:</p>
<pre><code>Version: 1.3.4
Calling indexAction
Controller Object ID: 0000000016b4fafc000000007cfdd348
Service from $this: [14,20,30,39,75]
Service from DI: [4,8,33,39,60]
====================================================================================================
Calling indexAction
Controller Object ID: 0000000016b4fafd000000007cfdd348
Service from $this: [14,20,30,39,75]
Service from DI: [1,5,12,88,91]
====================================================================================================</code></pre>
<p>It's a different objects 0000000016b4fa<strong>fc</strong>000000007cfdd348 -&gt; 0000000016b4fa<strong>fd</strong>000000007cfdd348.
I make a hash using <code>spl_object_hash</code>.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15466" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15466" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15467" href="#C15467">
                <time itemprop="dateCreated" datetime="2015-01-28T14:43:27-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I'm not sure, but you probably use signle DI container. </p>
<p>And two dispatchers use the shared controller from the same container.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15467" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15467" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15467"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        kenjis                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15469" href="#C15469">
                <time itemprop="dateCreated" datetime="2015-01-28T14:44:54-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>If you see above i removed dispatcher at all, to check if this bug take place in dispatcher.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15469" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15469" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15466"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Pavel Makarenko                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15470" href="#C15470">
                <time itemprop="dateCreated" datetime="2015-01-28T14:47:50-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Oh! It is not the same. You are right.</p>
<blockquote>
<h1>Version: 1.3.4
Calling indexAction
Controller Object ID: 0000000016b4fafc000000007cfdd348
Service from $this: [14,20,30,39,75]
Service from DI: [4,8,33,39,60]</h1>
<h1>Calling indexAction
Controller Object ID: 0000000016b4fafd000000007cfdd348
Service from $this: [14,20,30,39,75]
Service from DI: [1,5,12,88,91]</h1>
<pre><code>

It's a different objects 0000000016b4fa**fc**000000007cfdd348 -&gt; 0000000016b4fa**fd**000000007cfdd348.
I make a hash using `spl_object_hash`.</code></pre>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15470" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15470" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15472" href="#C15472">
                <time itemprop="dateCreated" datetime="2015-01-28T14:51:00-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I simplified code, it currently can be reproduced from this code:</p>
<pre><code class="language-php">&lt;?php

class TestController extends \Phalcon\Mvc\Controller {
  public function indexAction() {
    echo 'Calling indexAction' . PHP_EOL;

    echo 'Controller Object ID: ' . spl_object_hash($this) . PHP_EOL;
    echo 'Service from $this: ' . json_encode($this-&gt;test_service) . PHP_EOL;
    echo 'Service from DI: ' . json_encode($this-&gt;di-&gt;get('test_service')) . PHP_EOL;
    echo str_repeat('=', 100) . PHP_EOL;
  }
}

$di = new \Phalcon\DI\FactoryDefault();
$di-&gt;set('test_service', function() {
  return json_decode(json_encode(array_rand(range(1, 100), 5)));
});

\Phalcon\DI::reset();
\Phalcon\DI::setDefault($di);

echo 'Version: ' . Phalcon\Version::get() . PHP_EOL;
echo PHP_EOL;

$controller = new TestController();
$controller-&gt;indexAction();

$controller = new TestController();
$controller-&gt;indexAction();</code></pre>
<p>It outputs:</p>
<pre><code>Version: 1.3.4

Calling indexAction
Controller Object ID: 000000002d6dccb4000000006874776e
Service from $this: [18,55,69,76,77]
Service from DI: [23,39,83,84,88]
====================================================================================================
Calling indexAction
Controller Object ID: 000000002d6dccb7000000006874776e
Service from $this: [18,55,69,76,77]
Service from DI: [10,43,56,70,78]
====================================================================================================</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15472" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15472" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15473" href="#C15473">
                <time itemprop="dateCreated" datetime="2015-01-28T14:57:33-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I reproduced it.</p>
<pre><code>Version: 1.3.4

Calling indexAction
Controller Object ID: 000000000aaff29d00007fcd4294a598
Service from $this: [15,31,41,84,88]
Service from DI: [4,5,15,75,88]
====================================================================================================
Calling indexAction
Controller Object ID: 000000000aaff29e00007fcd4294a598
Service from $this: [15,31,41,84,88]
Service from DI: [11,26,73,86,87]
====================================================================================================</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15473" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15473" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15474" href="#C15474">
                <time itemprop="dateCreated" datetime="2015-01-28T14:59:06-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I think we should ask<a href="https://forum.phalcon.io/user/0/phalcon"> @phalcon</a>, if it's a normal or a bug.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15474" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15474" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15478" href="#C15478">
                <time itemprop="dateCreated" datetime="2015-01-28T15:46:22-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It is strange, not normal, I think.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15478" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15478" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15497" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15497" href="#C15497">
                <time itemprop="dateCreated" datetime="2015-01-29T01:52:26-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>i believe i know why, calm your horses. because you are making rand calls.</p>
<p>basically when you are calling the test service, the result is not cached. you are making rand calls everytime, array_rand is randomizing the numbers everytime you call it. to make it constant it has to be static.</p>
<pre><code class="language-php">class test_service
{
    public $rand;

    public function __construct()
    {
        $rand = array_rand(range(1, 100), 5);
    }
}

$ts1 = new test_service();
var_dump($ts1-&gt;rand);
$ts2 = new test_service(); 
var_dump($ts2-&gt;rand);
//different result</code></pre>
<pre><code class="language-php">class test_service
{
        public static $rand;

        public function __construct()
        {
            if(!self::$rand)  // &lt;&lt; might be typo here nv tried you get the idea
                self::initrand();
        }

        private static function initrand()
        {
            self::$rand = array_rand(range(1, 100), 5);
        }
}

$ts1 = new test_service(); 
var_dump($ts1-&gt;rand); // &lt;&lt; might be typo here nv tried you get the idea
$ts2 = new test_service(); 
var_dump($ts2-&gt;rand);
//same result</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15497" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15497" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/121dd39b7f87c8bd6d1807bcb2f9245e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2975/m1ome" class="user-moderator-N"><span itemprop="name">Pavel Makarenko</span></a>        </span>
        <br>

        <span class="karma">2.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15499" href="#C15499">
                <time itemprop="dateCreated" datetime="2015-01-29T02:27:14-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/7thcubic">@7thcubic</a> you don't get it? It's not a problem in <code>array_rand</code> or any other function in PHP, it's a problem while you trying to access DI in controller through magick method using <code>$this-&gt;test_service</code> in this case in different instances (with different DiC) result will be the same, it's looking like something caches it.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15499" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15499" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/9a998e084495cefe223e97ff0bfe2d8b?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3050/7thcubic" class="user-moderator-N"><span itemprop="name">7thcubic</span></a>        </span>
        <br>

        <span class="karma">2.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C15503" href="#C15503">
                <time itemprop="dateCreated" datetime="2015-01-29T08:01:55-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>not at all. what i see from the samples you gave me is exactly what i said in the earlier post. and if u say it caches it you are right in a way. the service is known to the di, but it does nothing until someone/something calls for that  exact service, after which it it placed in an array of initiated objects.</p>
<p>like the postman, he knows where everybody lives, but he doesnt place anyone on his route list unless he has a parcel, and for the very day the recipient will not change until the next day. so yeah it caches some sort if that's what you are trying to imply. </p>
<p>but based on the sample codes you gave, i am unable to understand as i clearly explained to you what happened.</p>
<p>so are you trying to say it should cache? or should not? = =&quot;</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15503" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15503" data-cf-modified-2a09159dc7052bcca6c48bc8-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="4611" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>