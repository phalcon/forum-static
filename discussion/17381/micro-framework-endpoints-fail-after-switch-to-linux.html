---
layout: default
title: 'Micro Framework Endpoints Fail after Switch to Linux - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/13/routing">Routing</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Micro Framework Endpoints Fail after Switch to Linux</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/3374/Ecksters" class="user-moderator-N"><span itemprop="name">Daniel Eck</span></a></span>
            <time itemprop="dateCreated" datetime="2017-11-28T05:51:53-07:00">Nov '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-11-28T05:51:53-07:00">Nov '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Nov '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">3</span>
                </td>
                <td>
                    <label>Views</label><br>378</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/c593e65a868ad49a257ac965bf8effac?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/3374/Ecksters" class="user-moderator-N"><span itemprop="name">Daniel Eck</span></a></span>
                <span class="karma">8.3k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C17381" href="#C17381">
        <time class="action-date">Nov '17</time>
    </a>
</div>
<div class="post-content"><div><p>So I've been developing on a Windows machine (I know, I know), and I'm having trouble with the switch over to Linux, as my routes are no longer being recognized. What's strange is that my error message appears to make it very clear that I AM connecting to the right route, but it's not going through.</p>
<p>For my Users handler, I have:</p>
<pre><code class="language-php">$users = new MicroCollection();
$users-&gt;setHandler('UsersController', true);
$users-&gt;setPrefix('/users');
$users-&gt;post('/login', 'login');
$app-&gt;mount($users);</code></pre>
<p>and my notFound handler is being triggered when I try the login function:</p>
<pre><code class="language-php">$app-&gt;notFound(
    function () use ($app) {
        throw new ErrorException('URI not found: ' . $app-&gt;request-&gt;getMethod() . ' ' . $app-&gt;request-&gt;getURI(), 404, 10);
    }
);</code></pre>
<p>Giving this error:
<code>URI not found: POST \/users\/login</code> which seems to perfectly match the path it should.</p>
<p>I verified that all the path names are are the correct cases, and made sure my autoloader is working properly (Database connection is working fine, classes are all registered).</p>
<p>Any ideas what could have broken with the switch to Linux?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-34222690a8938a94e02efd00-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-34222690a8938a94e02efd00-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52565" href="#C52565">
                <time itemprop="dateCreated" datetime="2017-11-28T06:57:21-07:00" class="action-date">Nov '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>apache/nginx htaccess is not presed probably</p>
<p><a href="https://olddocs.phalcon.io/en/3.0.0/reference/nginx.html">https://olddocs.phalcon.io/en/3.0.0/reference/nginx.html</a>#
<a href="https://olddocs.phalcon.io/en/3.0.0/reference/apache.html">https://olddocs.phalcon.io/en/3.0.0/reference/apache.html</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52565" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52565" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/660e8c9b157b0029b6e0ba24c0ea3eba?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4363/lajosbencz" class="user-moderator-N"><span itemprop="name">Lajos Bencz</span></a>        </span>
        <br>

        <span class="karma">77.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52567" href="#C52567">
                <time itemprop="dateCreated" datetime="2017-11-28T07:03:06-07:00" class="action-date">Nov '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That would've been my first guess, but then how does the request know about the correct URI?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52567" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52567" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c593e65a868ad49a257ac965bf8effac?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/3374/Ecksters" class="user-moderator-N"><span itemprop="name">Daniel Eck</span></a>        </span>
        <br>

        <span class="karma">8.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C52575" href="#C52575">
                <time itemprop="dateCreated" datetime="2017-11-28T10:32:19-07:00" class="action-date">Nov '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>That was it! NGINX was misconfigured, I hadn't seen that it was shown in the docs, so I was manually configuring it, but I admit when it had the right URI I assumed I had set it all up correctly.</p>
<p>Not 100% sure if this is what caused it, but my app is in a subdirectory and I had failed to change the fastcgi_index to reflect that. I did make some other changes to match the docs better, but that was the most obvious mistake I noticed.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52575" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52575" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bcb5cc9f3d1e3c3cab87efd5ac1dc9c7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4525/stamster" class="user-moderator-N"><span itemprop="name">Jonathan Aaron Steel</span></a>        </span>
        <br>

        <span class="karma">79.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="52601" data-toggle="modal" data-target="#historyModal">
                edited <span>Nov '17</span>
              </span><br/><a name="C52601" href="#C52601">
                <time itemprop="dateCreated" datetime="2017-11-29T04:20:24-07:00" class="action-date">Nov '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Nginx config with Phalcon is quite simple. What did you do wrong?</p>
<pre><code>location / {
        try_files $uri $uri/ /index.php$is_args$query_string;
        }</code></pre>
<p>And just set Router component to read info from <code>$_SERVER['REQUEST_URI']</code>.</p>
<pre><code class="language-php">$di-&gt;setShared('router', function (){
        $router = new \Phalcon\Mvc\Router(false); //Create the router without default routes (note: if routes are handled manually via MicroCollection)

        //we're using Front Page Controller pattern in relation from nginx -&gt; Phalcon
        $router-&gt;setUriSource($router::URI_SOURCE_SERVER_REQUEST_URI); // Use $_SERVER['REQUEST_URI']

        //Set whether router must remove the extra slashes in the handled routes
        $router-&gt;removeExtraSlashes(true);

    return $router;
});</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="52601" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="52601" data-cf-modified-34222690a8938a94e02efd00-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="17381" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>