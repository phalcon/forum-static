---
layout: default
title: 'Migrations failing (due to wrong order??) - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/12/developer-tools">Developer Tools</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Migrations failing (due to wrong order??)</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/1076/mixuuu" class="user-moderator-N"><span itemprop="name">mixuuu</span></a></span>
            <time itemprop="dateCreated" datetime="2014-07-29T10:14:46-07:00">Jul '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-07-29T10:14:46-07:00">Jul '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>None</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">0</span>
                </td>
                <td>
                    <label>Views</label><br>600</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">1</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/87f0036bd1ed611b14a1494a864e4f60?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/1076/mixuuu" class="user-moderator-N"><span itemprop="name">mixuuu</span></a></span>
                <span class="karma">5.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C2956" href="#C2956">
        <time class="action-date">Jul '14</time>
    </a>
</div>
<div class="post-content"><div><p>I generated some migrations with developer tools, and they are  failing when I try to run them, why this could be? (To me it looks like it tries to create images before post table, and images table references post table, so it fails, how could I avoid this?)</p>
<pre><code class="language-php">$ phalcon migration run

Phalcon DevTools (1.3.2)

1406653362.4145: SELECT IF(COUNT(*)&gt;0, 1 , 0) FROM `INFORMATION_SCHEMA`.`TABLES` WHERE `TABLE_NAME`= 'images' AND `TABLE_SCHEMA`='test'  =&gt; 1406653362.4152 (0.00068116188049316)
1406653362.4161: CREATE TABLE `test`.`images` (  `id` INT(11) NOT NULL AUTO_INCREMENT,  `filename` VARCHAR(255),  `original_filename` VARCHAR(255) NOT NULL,  `size` INT(11) NOT NULL,  `post_id` INT(11) NOT NULL,  `filetype` VARCHAR(255) NOT NULL,  PRIMARY KEY (`id`),  KEY `filename` (`filename`),  KEY `post_id` (`post_id`),  CONSTRAINT `images_ibfk_2` FOREIGN KEY (`post_id`) REFERENCES `post`(`id`) ) ENGINE=InnoDB AUTO_INCREMENT=60 DEFAULT CHARSET=latin1 COLLATE=latin1_swedish_ci                                                                                             
  Error: SQLSTATE[HY000]: General error: 1005 Can't create table 'test.images' (errno: 150)  
</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-16291134fc6adc87865b2095-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-16291134fc6adc87865b2095-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
            </div>
        </div><div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="2956" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>