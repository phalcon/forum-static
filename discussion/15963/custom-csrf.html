---
layout: default
title: 'Custom CSRF - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/16/security">Security</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Custom CSRF</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
            <time itemprop="dateCreated" datetime="2017-04-16T07:37:12-07:00">Apr '17</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2017-04-16T07:37:12-07:00">Apr '17</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Apr '17</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>443</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a></span>
                <span class="karma">40.6k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C15963" href="#C15963">
        <time class="action-date">Apr '17</time>
    </a>
</div>
<div class="post-content"><div><p>My site wont work with Phalcon CSRF, becuase when ever there is a ajax request that class the token, it changes.</p>
<p>So i was wondering if it's a bad idea to make a custom key when the user logs in, save it to the session and check if form and session key is the same? But the key only changes on logins, and not with every request.</p>
<p>Hope you understand!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-ac5fcda973d869112ec1cae0-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-ac5fcda973d869112ec1cae0-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47595" href="#C47595">
                <time itemprop="dateCreated" datetime="2017-04-16T09:07:33-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>this is what the phalcon securoity is doing anyways, when checking token , 3rd param needs to be set to false, and it wont delete with each request</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47595" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47595" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d90f9c7fe35e5f94eb6712df52bf3bb9?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4357/GunslerRage" class="user-moderator-N"><span itemprop="name">GunslerRage</span></a>        </span>
        <br>

        <span class="karma">40.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47599" href="#C47599">
                <time itemprop="dateCreated" datetime="2017-04-16T10:56:32-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>$this-&gt;add('csrf', new Identical(array(
'value' =&gt; $this-&gt;security-&gt;getSessionToken(null, null, false),
'message' =&gt; 'CSRF validation failed'
)));</p>
<p>It is false, still changes.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47599" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47599" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C47601" href="#C47601">
                <time itemprop="dateCreated" datetime="2017-04-17T00:35:20-07:00" class="action-date">Apr '17</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://docs.phalcon.io/en/3.0.1/reference/security.html#cross-site-request-forgery-csrf-protection">https://docs.phalcon.io/en/3.0.1/reference/security.html#cross-site-request-forgery-csrf-protection</a></p>
<p>i was refering to this kind of an usage</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="47601" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="47601" data-cf-modified-ac5fcda973d869112ec1cae0-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="15963" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>