---
layout: default
title: 'Проблема с View - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Проблема с View</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a></span>
            <time itemprop="dateCreated" datetime="2013-11-16T11:19:06-07:00">Nov '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-11-16T11:19:06-07:00">Nov '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Apr '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">10</span>
                </td>
                <td>
                    <label>Views</label><br>1322</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">2</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a></span>
                <span class="karma">10.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1191" href="#C1191">
        <time class="action-date">Nov '13</time>
    </a>
</div>
<div class="post-content"><div><p>Столкнулся с какой-то не понятной багой (или фичей?)... Мне надо отправить письмо пользователю после окончания регистрации на сайте. Сделал следующее:</p>
<ol>
<li>Создал класс-обертку для Swift Mailer: <a href="https://gist.github.com/aktuba/7503437">https://gist.github.com/aktuba/7503437</a></li>
<li>Пытаюсь отправить письмо. Облегченный вариант кода: <a href="https://gist.github.com/aktuba/7504097">https://gist.github.com/aktuba/7504097</a></li>
</ol>
<p>Как результат, ожидаю что отправится письмо и появится (в данном, упрощенном, случае) страница регистрации. Письмо уходит, но после появляется просто белая страница, даже layout-а нет.</p>
<p>Подскажите, plz, как победить эту багу/фичу... 2-й день как головой об стену (</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-471dfc3e115cf47264c9e865-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-471dfc3e115cf47264c9e865-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/fcae2565ce4d1ed7240231932dec115a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/659/oleg578" class="user-moderator-N"><span itemprop="name">Oleg</span></a>        </span>
        <br>

        <span class="karma">8.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4254" href="#C4254">
                <time itemprop="dateCreated" datetime="2013-11-16T11:45:14-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Может, здесь</p>
<pre><code class="language-php">    HTTP::redirect($this-&gt;url-&gt;getBasePath());</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4254" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4254" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4261" href="#C4261">
                <time itemprop="dateCreated" datetime="2013-11-16T12:19:37-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Не, это я забыл удалить. Поправил (<a href="https://gist.github.com/aktuba/7504097">https://gist.github.com/aktuba/7504097</a>). Проблема в том, что если делать $view-&gt;setDI($this-&gt;_di) - view приложения перестает работать, а если не делать - новый view  не рендерит (</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4261" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4261" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4272" href="#C4272">
                <time itemprop="dateCreated" datetime="2013-11-17T05:08:10-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Победил проблему, но... Вот он минус компилируемого фреймворка.
Решение: убрать регистрацию движка рендеринга ($view-&gt;registerEngines(array('.php' =&gt; 'Phalcon\Mvc\View\Engine\Php'));). Все. После этого работает нормально все.
Минус: не могу даже посмотреть, почему так. И не знаю, как это поправить (. Пока что переименовал расширения у всех вьюх на .phtml, но это не удобно (</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4272" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4272" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4296" href="#C4296">
                <time itemprop="dateCreated" datetime="2013-11-18T03:03:36-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Хорошо что проблема уже решена, есть вариант class Mail сделать наследуемым от \Phalcon\Mvc\User\Component, тогда в нём будут сразу доступны все сервисы из $di как $this-&gt;view или $this-&gt;getDi()-&gt;get('view'). И использовать вывод шаблона через уже зарегистрированный сервис представлений.
Сам код в sendView тогда сведётся к:</p>
<pre><code class="language-php">list($controller, $action) = explode('/', $view);
return $this-&gt;getDi()-&gt;get('view')-&gt;getRenderer($controller, $action, $data);</code></pre>
<p>Проблема может быть во второй регистрации view.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4296" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4296" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4302" href="#C4302">
                <time itemprop="dateCreated" datetime="2013-11-18T06:16:59-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Не, так не пойдет. У view приложения свои настройки (layout, например), а у mail-класса должны быть свои (вообще без layout, например).
Но, есть вопрос. Если наследоваться от Component, в конструктор класса попадет DI? Если нет - какой смысл наследоваться тогда?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4302" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4302" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4303" href="#C4303">
                <time itemprop="dateCreated" datetime="2013-11-18T07:24:30-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Там в методе можно определить свои дополнительные параметры <a href="https://docs.phalcon.io/en/latest/reference/views.html#id1">https://docs.phalcon.io/en/latest/reference/views.html#id1</a> :</p>
<pre><code class="language-php">echo $view-&gt;getRender('products', 'list',
    array(
        "someProducts" =&gt; $products,
        "someFeatureEnabled" =&gt; true
    ),
    function($view) {
        //Set any extra options here
        $view-&gt;setViewsDir("../app/views/");
        $view-&gt;setRenderLevel(Phalcon\Mvc\View::LEVEL_LAYOUT);
    }
);</code></pre>
<p>Если наследоваться то да, в конструкторе уже должны быть все сервисы из DI.
Пример из реального сайта, ранее в $di был определён сервис config ( $di-&gt;setShared('config' , $config) ) :</p>
<pre><code class="language-php">class Seo extends \Phalcon\Mvc\User\Component
{

    /** @var array */
    protected $_data = array();
    protected $_tags = array();

    function __construct()
    {
        $this-&gt;_data = [ '%host_name%' =&gt; $this-&gt;config-&gt;seo-&gt;title ];
    }
....</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4303" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4303" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4304" href="#C4304">
                <time itemprop="dateCreated" datetime="2013-11-18T07:27:03-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/491/aktuba">@aktuba</a> , еще есть упрощенный компонент представлений с облегченным синтаксисом ( Phalcon\Mvc\View\Simple ), использование его, возможно, в качестве редера для писем будет тоже неплохим вариантом <a href="https://docs.phalcon.io/en/latest/reference/views.html#id2">https://docs.phalcon.io/en/latest/reference/views.html#id2</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4304" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4304" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4306" href="#C4306">
                <time itemprop="dateCreated" datetime="2013-11-18T08:12:34-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>А дополнительные параметры используются временно или меняют основные? В принципе, хороший вариант, переделаю, проверю.
По поводу Simple - не вижу смысла, не решает проблему. А проблема в том, что хочется для шаблонов использовать расширение .php, а не .phtml.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4306" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4306" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4307" href="#C4307">
                <time itemprop="dateCreated" datetime="2013-11-18T08:19:55-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Да, так получается значительно проще и красивее: <a href="https://gist.github.com/aktuba/7529487">https://gist.github.com/aktuba/7529487</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4307" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4307" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4308" href="#C4308">
                <time itemprop="dateCreated" datetime="2013-11-18T11:39:22-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Отличное решение, сможешь оформить в виде библиотеки? У Phalcon нет своего класса работы с почтой, готовое решение очень бы порадовало сообщество ;)</p>
<blockquote>
<p>используются временно или меняют основные?
не могу сказать точно, но с большей вероятностью используются временно, для этого конкретного метода.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4308" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4308" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4310" href="#C4310">
                <time itemprop="dateCreated" datetime="2013-11-18T12:29:54-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Уже проверил - только временно меняются, как я понял. Завтра попробую собрать все в кучу и выложить на гитхаб.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4310" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4310" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4324" href="#C4324">
                <time itemprop="dateCreated" datetime="2013-11-18T23:50:39-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>При создании либы возникла проблема - отправляются по 2 письма. В рабочем приложении только одно, а вот в тестовом два... Почему - пока не могу понять, поэтому:</p>
<ol>
<li>Код все либы здесь: <a href="https://gist.github.com/aktuba/7541241">https://gist.github.com/aktuba/7541241</a></li>
<li>Пример использования:</li>
</ol>
<pre><code class="language-php">$di-&gt;set('mailer', function(){
    return new \Phalcon\Mail\Mail(array(
        'swift' =&gt; __DIR__.'/../vendor/Swift-5.0.1/lib',
        'from'      =&gt; '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e68094898ba68b878f8ac885898b">[email&#160;protected]</a>',
        'transport' =&gt; 'native', //native|smtp|sendmail
        'options'   =&gt; array(
            'host'       =&gt; 'smtp.gmail.com',
            'port'       =&gt; '465',
            'encryption' =&gt; 'ssl',
            'username'   =&gt; 'username',
            'password'   =&gt; 'password',
        ),
    ));
});</code></pre>
<pre><code class="language-php">$this-&gt;mailer-&gt;sendView('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="92e6fdd2fff3fbfebcf1fdff">[email&#160;protected]</a>', 'test subject', 'email/test');</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4324" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4324" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4325" href="#C4325">
                <time itemprop="dateCreated" datetime="2013-11-19T00:01:15-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Очень похоже, что проблема с настройкой локальной машины или библиотекой Swift. Если в контроллере сделать</p>
<pre><code class="language-php">require_once __DIR__.'/../../../vendor/Swift-5.0.1/lib/swift_required.php';
$swift = \Swift_Mailer::newInstance(\Swift_MailTransport::newInstance());
$message = \Swift_Message::newInstance('test', 'test mail', false, 'utf-8');
$message-&gt;setTo('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="34405b7459555d581a575b59">[email&#160;protected]</a>');
$message-&gt;setFrom('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4b2d3924260b262a222765282426">[email&#160;protected]</a>');
$swift-&gt;send($message);</code></pre>
<p>то все-равно отправляется по 2 письма (</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4325" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4325" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/23f127b8afebc5e0cedb57e4eb524af7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/33/xboston" class="user-moderator-Y"><span itemprop="name">Nikolay Kirsh</span></a>        </span>
        <br>

        <span class="karma">5.0k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4330" href="#C4330">
                <time itemprop="dateCreated" datetime="2013-11-19T03:06:40-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Спасибо за готовое решение!</p>
<p>расскажи когда узнаешь что с дублями писем ;)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4330" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4330" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/491/aktuba" class="user-moderator-N"><span itemprop="name">aktuba</span></a>        </span>
        <br>

        <span class="karma">10.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4347" href="#C4347">
                <time itemprop="dateCreated" datetime="2013-11-19T23:16:56-07:00" class="action-date">Nov '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Проблему не нашел, но... Взял пару проектов с github, подключил к ним mailer и отправил письма. Вроде хорошо работает.
Единственное, шаблоны только в .phtml.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4347" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4347" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d256c23599c7ddbb7085ee23f2499f6e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/741/vanchelo" class="user-moderator-N"><span itemprop="name">Брежнев Иван</span></a>        </span>
        <br>

        <span class="karma">1.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C4741" href="#C4741">
                <time itemprop="dateCreated" datetime="2013-12-20T14:40:44-07:00" class="action-date">Dec '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Мы вот такое решение запилили, код ларавел 4 адаптировали для работы  Фальконе
<a href="https://github.com/vanchelo/phalcon-mailer">https://github.com/vanchelo/phalcon-mailer</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="4741" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="4741" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/f1d72515ea8deefa9da7f096df60e23f?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/151/demkinmaxim" class="user-moderator-N"><span itemprop="name">demkinmaxim</span></a>        </span>
        <br>

        <span class="karma">2.3k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9481" href="#C9481">
                <time itemprop="dateCreated" datetime="2014-07-15T10:49:15-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>А тем временем есть готовое решение с интегрированным Swift.
Используется в примере от разработчиков: Vokuro.
см. <a href="https://github.com/phalcon/vokuro/tree/master/app/library/Mail">https://github.com/phalcon/vokuro/tree/master/app/library/Mail</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9481" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9481" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d256c23599c7ddbb7085ee23f2499f6e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/741/vanchelo" class="user-moderator-N"><span itemprop="name">Брежнев Иван</span></a>        </span>
        <br>

        <span class="karma">1.9k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C9484" href="#C9484">
                <time itemprop="dateCreated" datetime="2014-07-15T12:15:16-07:00" class="action-date">Jul '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Я видел это решение) Но мне больше понравилась реализация в ларавел</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="9484" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="9484" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/29b4ebc69875609d84af4f120aaf1882?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/3773/tages" class="user-moderator-N"><span itemprop="name">tages</span></a>        </span>
        <br>

        <span class="karma">318</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C4325"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/0ff0b05acd6b028a0e18f4032c4f345e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        aktuba                    </a>
                </div><div class="posts-buttons" align="right"><a name="C17841" href="#C17841">
                <time itemprop="dateCreated" datetime="2015-04-30T21:43:21-07:00" class="action-date">Apr '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>Очень похоже, что проблема с настройкой локальной машины или библиотекой Swift. Если в контроллере сделать</p>
<pre><code class="language-php">require_once __DIR__.'/../../../vendor/Swift-5.0.1/lib/swift_required.php';
$swift = \Swift_Mailer::newInstance(\Swift_MailTransport::newInstance());
$message = \Swift_Message::newInstance('test', 'test mail', false, 'utf-8');
$message-&gt;setTo('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5e2a311e333f3732703d3133">[email&#160;protected]</a>');
$message-&gt;setFrom('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4d2b3f22200d202c2421632e2220">[email&#160;protected]</a>');
$swift-&gt;send($message);</code></pre>
<p>то все-равно отправляется по 2 письма (</p>
</blockquote>
<p>скорей всего где то устанавливается</p>
<pre><code class="language-php">$message-&gt;cc('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d2a7a1a092bfb3bbbefcb1bdbf">[email&#160;protected]</a>');
$message-&gt;bcc('<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4b3e38390b262a222765282426">[email&#160;protected]</a>');</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="17841" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="17841" data-cf-modified-471dfc3e115cf47264c9e865-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1191" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>