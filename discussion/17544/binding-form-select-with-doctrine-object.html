---
layout: default
title: 'binding form select with doctrine object - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/21/beginners">Beginners</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">binding form select with doctrine object</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a></span>
            <time itemprop="dateCreated" datetime="2018-01-03T07:40:16-07:00">Jan '18</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2018-01-03T07:40:16-07:00">Jan '18</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jan '18</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>516</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/3ab0974fd07be40adf0bd0d3c4192f4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a></span>
                <span class="karma">1.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C17544" href="#C17544">
        <time class="action-date">Jan '18</time>
    </a>
</div>
<div class="post-content"><div><p>I have a problem binding forms with relational objects. </p>
<p>I work with Doctrine and Phalcon2</p>
<p>In the entity I have a getter that returns and object and not and id or string.</p>
<pre><code>     /**
     * @return Laboratorio
     */
    public function getLaboratorioSangrePositivoTKI()
    {
        return $this-&gt;laboratorioSangrePositivoTKI;
    }</code></pre>
<p>And when phalcon try to bind the entity to the form it returns this error:</p>
<blockquote>
<p>Catchable fatal error: Object of class DoctrineProxies__CG__\Identify\Entities\Laboratorio could not be converted to string in /var/www/clients/client1/web1/web/app/common/cache/volt/app/backend/views/hospital/formHospitalInterno.phtml on line 64</p>
</blockquote>
<p>I know that problem is that phalcon try to set a default value with the object, but it doesn't work because I need to get the id.</p>
<p>I try to solve adding using to select attribute, but it doesn't work:</p>
<pre><code>$this-&gt;add(new Select('laboratorioTejido', $laboratoriosTejido, [
            'class' =&gt; 'form-control filter',
            'using' =&gt; ['id','nombre'],
            'useEmpty' =&gt; true,
            'emptyText' =&gt; 'Selecciona ...',
        ]));</code></pre>
<p><strong> 1. Can I change the binding for one element?</strong></p>
<p><strong> 2. If no, also i'm thinking if can I to setup a blacklist to the binding?</strong></p>
<p><strong> 3. What's the best way to solve this issue?</strong></p>
<p>Thanks a lot!
Fidel</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-355134721a3f71597c95e8bf-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-355134721a3f71597c95e8bf-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4769/Izopi4a" class="user-moderator-Y"><span itemprop="name">Izo</span></a>        </span>
        <br>

        <span class="karma">85.5k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C53240" href="#C53240">
                <time itemprop="dateCreated" datetime="2018-01-03T08:24:30-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>i think phalcon components ( including Forms ) are made to work with phalcon orm ( makes sence ? )</p>
<p>so i would guess that the best way is to extend the Select class and overwrite the functions that are using phalcon orm.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53240" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53240" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/3ab0974fd07be40adf0bd0d3c4192f4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a>        </span>
        <br>

        <span class="karma">1.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C53240"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/5915f25e654c4f9e60fe51700cdee683?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Izo                    </a>
                </div><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="53242" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '18</span>
              </span><br/><a name="C53242" href="#C53242">
                <time itemprop="dateCreated" datetime="2018-01-03T08:30:51-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I prefer ignore the binding for this element, the project is in production and your proposal is too hard.
Thanks</p>
<blockquote>
<p>i think phalcon components ( including Forms ) are made to work with phalcon orm ( makes sence ? )</p>
<p>so i would guess that the best way is to extend the Select class and overwrite the functions that are using phalcon orm.</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53242" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53242" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b59fecbff6d1afabf8da316028330df4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2619/emiliodeg" class="user-moderator-N"><span itemprop="name">Emilio Degiovanni</span></a>        </span>
        <br>

        <span class="karma">32.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C53246" href="#C53246">
                <time itemprop="dateCreated" datetime="2018-01-03T10:25:55-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi<a href="https://forum.phalcon.io/user/0/itemvirtual"> @itemvirtual</a> why you don't pass an array?</p>
<pre><code class="language-php">$form-&gt;add(
    new Select(
        'telephoneType',
        [
            'H' =&gt; 'Hogar',
            'C' =&gt; 'Movil',
        ]
    )
);

// in your case
$form-&gt;add(
    new Select(
        'telephoneType',
        array_column($query-&gt;getQuery()-&gt;getArrayResult(), 'nombre', 'id')
    )
);</code></pre>
<p>What do you think? Good luck</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53246" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53246" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/3ab0974fd07be40adf0bd0d3c4192f4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a>        </span>
        <br>

        <span class="karma">1.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C53246"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/b59fecbff6d1afabf8da316028330df4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Emilio Degiovanni                    </a>
                </div><div class="posts-buttons" align="right"><a name="C53250" href="#C53250">
                <time itemprop="dateCreated" datetime="2018-01-03T11:03:54-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi!
I pass an array. But my problem isn't with the creation, is with the binding, because Phalcon tries to bind and object to the Select and it needs an integer to set the Default Value. </p>
<p>Thanks
Fidel</p>
<blockquote>
<p>Hi<a href="https://forum.phalcon.io/user/0/itemvirtual"> @itemvirtual</a> why you don't pass an array?</p>
<pre><code class="language-php">$form-&gt;add(
   new Select(
       'telephoneType',
       [
           'H' =&gt; 'Hogar',
           'C' =&gt; 'Movil',
       ]
   )
);

// in your case
$form-&gt;add(
   new Select(
       'telephoneType',
       array_column($query-&gt;getQuery()-&gt;getArrayResult(), 'nombre', 'id')
   )
);</code></pre>
<p>What do you think? Good luck</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53250" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53250" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c897fab3d4f3e07ca673337a1efa9cbf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6133/corentin-begne" class="user-moderator-N"><span itemprop="name">corentin-begne</span></a>        </span>
        <br>

        <span class="karma">12.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C53252" href="#C53252">
                <time itemprop="dateCreated" datetime="2018-01-03T11:41:57-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What the need to use doctrine when the framework had a native orm which no need any include and clearly better than doctrine in any point ...</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53252" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53252" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/3ab0974fd07be40adf0bd0d3c4192f4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a>        </span>
        <br>

        <span class="karma">1.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C53252"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/c897fab3d4f3e07ca673337a1efa9cbf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        corentin-begne                    </a>
                </div><div class="posts-buttons" align="right"><a name="C53254" href="#C53254">
                <time itemprop="dateCreated" datetime="2018-01-03T11:47:42-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hi,
this is not my question.</p>
<blockquote>
<p>What the need to use doctrine when the framework had a native orm which no need any include and clearly better than doctrine in any point ...</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53254" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53254" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/b59fecbff6d1afabf8da316028330df4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2619/emiliodeg" class="user-moderator-N"><span itemprop="name">Emilio Degiovanni</span></a>        </span>
        <br>

        <span class="karma">32.2k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C53256" href="#C53256">
                <time itemprop="dateCreated" datetime="2018-01-03T19:19:50-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>well you must use the <a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/forms/form.zep#L535">undocumented function <code>getCustomValue($elemName, $entity, $data)</code></a></p>
<p>Here you will do something like this</p>
<pre><code class="language-php">class YourForm extends Phalcon\Forms\Form {

    // all your code here

    public function getCustomValue($name, $entity, $data) {
        if ($name === 'yourSelectName') {
            return 'what you want for select here';
        }

        if ($entity) {
            return $entity-&gt;toArray()[$name];
        }

        return $data[$name] ?? null;
    }
}</code></pre>
<p>Other way you can pass an object as entity but itsn't an Model. Form docs quote: &quot;An entity such as a model/collection/plain instance or just a plain PHP class can be linked to the form in order to set default values in the form's elements or assign the values from the form to the entity easily&quot; <a href="https://docs.phalcon.io/en/3.2/forms#entities">more info forms doc</a></p>
<p>Good luck</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53256" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53256" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/3ab0974fd07be40adf0bd0d3c4192f4d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10628/itemvirtual" class="user-moderator-N"><span itemprop="name">Itemvirtual</span></a>        </span>
        <br>

        <span class="karma">1.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C53256"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/b59fecbff6d1afabf8da316028330df4?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Emilio Degiovanni                    </a>
                </div><div class="posts-buttons" align="right"><a name="C53258" href="#C53258">
                <time itemprop="dateCreated" datetime="2018-01-04T01:27:28-07:00" class="action-date">Jan '18</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Thanks!!!!
It works perfectly!
Can I send you a beer? :D</p>
<blockquote>
<p>well you must use the <a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/forms/form.zep#L535">undocumented function <code>getCustomValue($elemName, $entity, $data)</code></a></p>
<p>Here you will do something like this</p>
<pre><code class="language-php">class YourForm extends Phalcon\Forms\Form {

  // all your code here

  public function getCustomValue($name, $entity, $data) {
      if ($name === 'yourSelectName') {
          return 'what you want for select here';
      }

      if ($entity) {
          return $entity-&gt;toArray()[$name];
      }

      return $data[$name] ?? null;
  }
}</code></pre>
<p>Other way you can pass an object as entity but itsn't an Model. Form docs quote: &quot;An entity such as a model/collection/plain instance or just a plain PHP class can be linked to the form in order to set default values in the form's elements or assign the values from the form to the entity easily&quot; <a href="https://docs.phalcon.io/en/3.2/forms#entities">more info forms doc</a></p>
<p>Good luck</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="53258" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="53258" data-cf-modified-355134721a3f71597c95e8bf-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="17544" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>