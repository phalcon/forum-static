---
layout: default
title: 'Phalcon 4.x Sessions Via MySQL? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/28/session">Session</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon 4.x Sessions Via MySQL?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/13693/JMoodyFWD" class="user-moderator-N"><span itemprop="name">JMoodyFWD</span></a></span>
            <time itemprop="dateCreated" datetime="2020-08-18T18:30:01-07:00">Aug '20</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2020-08-18T18:30:01-07:00">Aug '20</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Dec '20</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>149</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/202aa5b349545e67b7dcdcc1abaa5425?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/13693/JMoodyFWD" class="user-moderator-N"><span itemprop="name">JMoodyFWD</span></a></span>
                <span class="karma">537</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C20829" href="#C20829">
        <time class="action-date">Aug '20</time>
    </a>
</div>
<div class="post-content"><div><p>I've looked at the incubator repo on GitHub for the MySQL session adapter and it seems that it's not up to date with Phalcon 4.x in terms of getting sessions logged within MySQL rather than relying on the Stream adapter to store sessions via files. </p>
<p>I have an app that is starting to get massive traffic and while I'm able to spin up more servers in a load balancer, it becomes an issue keeping the session files synced between multiple servers. If a user on server A gets logged in and then is kicked to server B because of load balancing, they aren't logged in anymore and have to re-create their session.</p>
<p>I'm trying to figure out either a.) what needs to be done to get that incubator script up to date, b.) need an already up to date adapter that someone knows of or c.) how exactly to create my own adapter to properly work with the session adapter interface.</p>
<p>I've been google searching this issue for weeks now and I find it weird nobody has found a solution yet. Maybe I'm missing a thread that got buried?</p>
<p>Any help would be greatly appreciated.</p>
<p>P.S. - On a side note, is there any way with the Stream Adapter for sessions to be set to a time limit? I'm having trouble finding how to do that in the docs.</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-74f66b7237fe04a28fa95132-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-74f66b7237fe04a28fa95132-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c897fab3d4f3e07ca673337a1efa9cbf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6133/corentin-begne" class="user-moderator-N"><span itemprop="name">corentin-begne</span></a>        </span>
        <br>

        <span class="karma">12.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="64083" data-toggle="modal" data-target="#historyModal">
                edited <span>Aug '20</span>
              </span><br/><a name="C64083" href="#C64083">
                <time itemprop="dateCreated" datetime="2020-08-23T20:09:52-07:00" class="action-date">Aug '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can use memcached locally sharing it to your servers behind the load balancer.<br />
<a href="https://docs.phalcon.io/4.0/fr-fr/session#libmemcached">https://docs.phalcon.io/4.0/fr-fr/session#libmemcached</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64083" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64083" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/202aa5b349545e67b7dcdcc1abaa5425?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/13693/JMoodyFWD" class="user-moderator-N"><span itemprop="name">JMoodyFWD</span></a>        </span>
        <br>

        <span class="karma">537</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C64083"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/c897fab3d4f3e07ca673337a1efa9cbf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        corentin-begne                    </a>
                </div><div class="posts-buttons" align="right"><a name="C64087" href="#C64087">
                <time itemprop="dateCreated" datetime="2020-08-23T22:19:42-07:00" class="action-date">Aug '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>You can use memcached locally sharing it to your servers behind the load balancer.<br />
<a href="https://docs.phalcon.io/4.0/fr-fr/session#libmemcached">https://docs.phalcon.io/4.0/fr-fr/session#libmemcached</a></p>
</blockquote>
<p>Thanks for the suggestion! Unfortunately, because we have developers working on local copies of the website (across Mac, Windows and Linux) and pushing their work through GitHub for review and deployment, adding on to their plate the need to setup and run memcache as part of their local environment would be extremely cumbersome.</p>
<p>The ideal situation would be to get sessions stored via MySQL, as their environments already have that in place and because we plan to leverage session data within the database for analytics and support for users within the app.</p>
<p>I've been trying to wrap my head around the docs regarding making a custom adapter for sessions in Phalcon 4.x, and it seems that the main change was the naming convention. Am I correct in assuming that if I update the class names and paths in the incubator script to use the correct namespaces in Phalcon 4.x that it should be smooth sailing from there?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64087" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64087" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c897fab3d4f3e07ca673337a1efa9cbf?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/6133/corentin-begne" class="user-moderator-N"><span itemprop="name">corentin-begne</span></a>        </span>
        <br>

        <span class="karma">12.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64095" href="#C64095">
                <time itemprop="dateCreated" datetime="2020-08-24T09:02:55-07:00" class="action-date">Aug '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Yes but you should use it only in production and in developpement stay with the stream adapter, your developers doesn't need to share their sessions.<br />
I can't help you about custom adapter, I nerver used it, but maybe namespace update is enough.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64095" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64095" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/747be74e038e35ba2207da09388e3a0d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/8217/talal424" class="user-moderator-N"><span itemprop="name">talal424</span></a>        </span>
        <br>

        <span class="karma">8.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C64191" href="#C64191">
                <time itemprop="dateCreated" datetime="2020-09-03T07:35:33-07:00" class="action-date">Sep '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>if there is no sensitive data why not use jwt</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="64191" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="64191" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a10e0c4de7753b2619f2ce9a61e4bee0?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/14543/Kassulkel" class="user-moderator-N"><span itemprop="name">Kassulkel</span></a>        </span>
        <br>

        <span class="karma">76</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="65099" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '20</span>
              </span><br/><a name="C65099" href="#C65099">
                <time itemprop="dateCreated" datetime="2020-12-10T21:54:16-07:00" class="action-date">Dec '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I worked on a company (adult industry) which handled 1B requests/day... that's 12k req/sec. We used Symfony2 with its standard distribution, with a few tweaks for our use case. Our infrastructure also used Riak for cache storage, RabbitMQ for message broker and Doctrine2 ORM at the top of MySQL for primary storage. So ya... ORMs do perform and ya... a potato can handle your load (as VeonIndigo Cardiksaid).</p>
<p><a href="https://www.indigocard.us/">Indigo Card</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="65099" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="65099" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/202aa5b349545e67b7dcdcc1abaa5425?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/13693/JMoodyFWD" class="user-moderator-N"><span itemprop="name">JMoodyFWD</span></a>        </span>
        <br>

        <span class="karma">537</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="65139" data-toggle="modal" data-target="#historyModal">
                edited <span>Dec '20</span>
              </span><br/><a name="C65139" href="#C65139">
                <time itemprop="dateCreated" datetime="2020-12-14T10:03:04-07:00" class="action-date">Dec '20</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>For anyone who is searching via Google, I found the solution after digging around quite a bit.</p>
<p>First, it seems that the documentation at <a href="https://docs.phalcon.io/4.0/en/session#custom"><a href="https://docs.phalcon.io/4.0/en/session#custom">https://docs.phalcon.io/4.0/en/session#custom</a></a> is not correct, as it is explaining you need to write an adapter that extends <em>SessionHandlerInterface</em>, but as you can only <strong><em>implement</em></strong> interfaces, this leads you down a dead end. Instead, you need to write a class that extends <em>Phalcon\Session\Adapter\AbstractAdapter</em>.</p>
<p>Second, I wasn't aware that with Phalcon 4.x, the team decided to separate their incubator library into different repos, so if you're on Phalcon 4.x and looking for the MySQL database adapter for sessions, it is now located at <a href="https://github.com/phalcon/incubator-session"><a href="https://github.com/phalcon/incubator-session">https://github.com/phalcon/incubator-session</a></a>.</p>
<p>I hope this helps those that are possibly still looking for a solution.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="65139" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="65139" data-cf-modified-74f66b7237fe04a28fa95132-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="20829" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>