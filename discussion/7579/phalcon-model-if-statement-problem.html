---
layout: default
title: 'Phalcon model - if statement problem - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/1/mvc">MVC</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon model - if statement problem</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/4359/Proffnet" class="user-moderator-N"><span itemprop="name">Proffnet</span></a></span>
            <time itemprop="dateCreated" datetime="2015-07-13T07:53:39-07:00">Jul '15</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2015-07-13T07:53:39-07:00">Jul '15</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jul '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">2</span>
                </td>
                <td>
                    <label>Views</label><br>397</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/8d223f364b3199a5717801ea1aa5b40e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/4359/Proffnet" class="user-moderator-N"><span itemprop="name">Proffnet</span></a></span>
                <span class="karma">593</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C7579" href="#C7579">
        <time class="action-date">Jul '15</time>
    </a>
</div>
<div class="post-content"><div><p>My oryginal query is</p>
<p>SELECT
Parts.partid
FROM Parts
LEFT JOIN Pages ON(Pages.datasource_id=Parts.partid AND Pages.page_language=Parts.lang )
LEFT JOIN PartsModyfication ON(PartsModyfication.id=Parts.id)
WHERE Parts.sparte LIKE :sparte: AND Parts.lang =:lang: AND IF(PartsModyfication.partsel &lt;&gt; &quot;&quot; OR PartsModyfication.partsel IS NOT NULL,PartsModyfication.partsel,Parts.partsel) like :partsel: ORDER BY dateupdate DESC</p>
<p>When I run it via executeQuery</p>
<p>$partes = $this-&gt;modelsManager-&gt;executeQuery(
$sQuery,
$bind
);</p>
<p>Phalcon produce query without table aliases in IF statement </p>
<p>SELECT <code>parts</code>.<code>partid</code> AS <code>partid</code> FROM <code>parts</code> LEFT JOIN <code>pages</code> ON (<code>pages</code>.<code>datasource_id</code> = <code>parts</code>.<code>partid</code> AND <code>pages</code>.<code>page_language</code> = <code>parts</code>.<code>lang</code>) LEFT JOIN <code>parts_modyfication</code> ON (<code>parts_modyfication</code>.<code>id</code> = <code>parts</code>.<code>id</code>) WHERE <code>parts</code>.<code>sparte</code> LIKE :sparte AND <code>parts</code>.<code>lang</code> = :lang AND IF(<code>partsel</code> &lt;&gt; '' OR <code>partsel</code> IS NOT NULL, <code>partsel</code>, <code>partsel</code>) LIKE :partsel ORDER BY <code>dateupdate</code> DESC</p>
<p>It coses sql partsel ambiguous  <code>partsel</code> column name problem.</p>
<p>Is there any fix for that?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-16d2903652bfcd4be3554b30-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-16d2903652bfcd4be3554b30-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20587" href="#C20587">
                <time itemprop="dateCreated" datetime="2015-07-13T08:09:23-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>What version of Phalcon are you using? Are you using 2.0.4?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20587" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20587" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/8d223f364b3199a5717801ea1aa5b40e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4359/Proffnet" class="user-moderator-N"><span itemprop="name">Proffnet</span></a>        </span>
        <br>

        <span class="karma">593</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20591" href="#C20591">
                <time itemprop="dateCreated" datetime="2015-07-13T09:33:28-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>No 1.3.0.
I found the solution.
Rescent query wasn't full because I thought that it doesn't matter. The full version of that query is with longer SELECT section</p>
<p>SELECT Parts.partid Parts.partid, Parts.ean, IF(Parts.dateupdate IS NULL, Parts.datecreate, Parts.dateupdate) dateupdate,IF(PartsModyfication.partsel !=&quot;&quot; OR PartsModyfication.partsel IS NOT NULL,PartsModyfication.partsel,Parts.partsel) partsel FROM Parts LEFT JOIN Pages ON(Pages.datasource_id=Parts.partid AND Pages.page_language=Parts.lang ) LEFT JOIN PartsModyfication ON(PartsModyfication.id=Parts.id) WHERE Parts.sparte LIKE :sparte: AND Parts.lang =:lang: AND IF(PartsModyfication.partsel &lt;&gt; &quot;&quot; OR PartsModyfication.partsel IS NOT NULL,PartsModyfication.partsel,Parts.partsel) like :partsel: ORDER BY dateupdate DESC</p>
<p>And  alias 'partsel' in select section causes that problem</p>
<p>It is wire but if you change 'partsel' alias in SELECT section ie. on 'partsel2' or even 'Partsel' (first letter upercase) the problem disappear and phalcon DO add table aliases in WHERE section.</p>
<p>I think that is some kind of bug.</p>
<p>I don't check if the same happend in Phalcon 2.0.4</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20591" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20591" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bca14bc3a838cc7bb0fac119aa87d7e6?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1149/carvajaldiazeduar" class="user-moderator-N"><span itemprop="name">Eduar Carvajal</span></a>        </span>
        <br>

        <span class="karma">1.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C20599" href="#C20599">
                <time itemprop="dateCreated" datetime="2015-07-13T10:11:27-07:00" class="action-date">Jul '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Please check if it happens in 2.0.4 as 1.3.x is no longer supported</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="20599" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="20599" data-cf-modified-16d2903652bfcd4be3554b30-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="7579" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>