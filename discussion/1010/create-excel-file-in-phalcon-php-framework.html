---
layout: default
title: 'create Excel file in Phalcon php framework - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="https://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/5/general">General</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">create Excel file in Phalcon php framework</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="/user/584/nedim23" class="user-moderator-N"><span itemprop="name">nedim23</span></a></span>
            <time itemprop="dateCreated" datetime="2013-10-10T11:27:32-07:00">Oct '13</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2013-10-10T11:27:32-07:00">Oct '13</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Feb '16</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">5</span>
                </td>
                <td>
                    <label>Views</label><br>3204</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">1</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/37b17a163909334a1a9b9eec1a062e29?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="avatar-name"><a href="/user/584/nedim23" class="user-moderator-N"><span itemprop="name">nedim23</span></a></span>
                <span class="karma">18.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1010" href="#C1010">
        <time class="action-date">Oct '13</time>
    </a>
</div>
<div class="post-content"><div><p>I'm working in phalcon php framework and i am trying to create simple xsl file, but when i call my controller i get empty excel table. Can anyone tell me what is wrong in my code. Here is my method:</p>
<pre><code>   public function createExcelAction(){

$loader = new \Phalcon\Loader();

   $loader-&gt;registerClasses(
     array(
    "PHPExcel"=&gt;"C:/wamp/www/phalcon1/Classes/PHPExcel.php",
  "PHPExcel_Writer_Excel2007"=&gt;"C:/wamp/www/phalcon1/Classes/PHPExcel/Writer/PHPExcel_Writer_Excel2007.php"
    )
     );
     $loader-&gt;register();
     $excel = new PHPExcel();
           //$excel = new PHPExcel();
    //activate worksheet number 1
    $excel-&gt;setActiveSheetIndex(0);
    //name the worksheet
    $excel-&gt;getActiveSheet()-&gt;setTitle('test worksheet');
    //set cell A1 content with some text

    $excel-&gt;getActiveSheet()-&gt;setCellValue('A1', 'Rezultati pretrage');
    $excel-&gt;getActiveSheet()-&gt;setCellValue('A2', "Ime");
    $excel-&gt;getActiveSheet()-&gt;setCellValue('C2', "Prezime");
    $excel-&gt;getActiveSheet()-&gt;setCellValue('F2', "Adresa stanovanja");

    $br = rand(0,1000000);
    $naziv = "Pobjeda-Rudet izvjestaj-".$br.".xls";
   //$filename='pobjeda_rudet.xlsx'; //save our workbook as this file name
       header('Content-Type: application/vnd.ms-excel'); //mime typež
     header('Content-Disposition: attachment;filename="'.$naziv.'"');
   // header('Content-Disposition: attachment;filename="'.$filename.'"'); 
      header('Cache-Control: max-age=0'); //no cache
     $objWriter = new PHPExcel_Writer_Excel2007($excel);
     $objWriter-&gt;save(str_replace('.php', '.xls', __FILE__));</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-948adb825b46a2dd0956f9b5-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-948adb825b46a2dd0956f9b5-="">
        <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1566f34c7e5701e26ec2ceb82b90378d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/630/douglaspossas" class="user-moderator-N"><span itemprop="name">Douglas Bezerra Possas</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3793" href="#C3793">
                <time itemprop="dateCreated" datetime="2013-10-10T11:55:34-07:00" class="action-date">Oct '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Remove &quot;header&quot; instructions.</p>
<p>PHPExcel class to add the required information in the header</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3793" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3793" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/37b17a163909334a1a9b9eec1a062e29?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/584/nedim23" class="user-moderator-N"><span itemprop="name">nedim23</span></a>        </span>
        <br>

        <span class="karma">18.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3794" href="#C3794">
                <time itemprop="dateCreated" datetime="2013-10-10T13:42:06-07:00" class="action-date">Oct '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>can you provide me some example, how to add required info in header using PHPExcel, because i deal with this for the first time. Thanks in advace.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3794" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3794" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1566f34c7e5701e26ec2ceb82b90378d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/630/douglaspossas" class="user-moderator-N"><span itemprop="name">Douglas Bezerra Possas</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3795" href="#C3795">
                <time itemprop="dateCreated" datetime="2013-10-10T13:45:22-07:00" class="action-date">Oct '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>public function createExcelAction() {
global $config;</p>
<pre><code>    $loader = new \Phalcon\Loader();

    $loader-&gt;registerDirs(
        array(
            $config-&gt;application-&gt;libraryDir."PHPExcel/"
        )
    );

    // register autoloader
    $loader-&gt;register();

    $excel = new PHPExcel();
    $excel-&gt;setActiveSheetIndex(0);
    $excel-&gt;getActiveSheet()-&gt;setTitle('test worksheet');

    $excel-&gt;getActiveSheet()-&gt;setCellValue('A1', 'Rezultati pretrage');
    $excel-&gt;getActiveSheet()-&gt;setCellValue('A2', "Ime");
    $excel-&gt;getActiveSheet()-&gt;setCellValue('C2', "Prezime");
    $excel-&gt;getActiveSheet()-&gt;setCellValue('F2', "Adresa stanovanja");

    $br = rand(0,1000000);
    $naziv = $br.".xls";
    //$filename='pobjeda_rudet.xlsx'; //save our workbook as this file name
    //header('Content-Type: application/vnd.ms-excel'); //mime typež
    //header('Content-Disposition: attachment;filename="'.$naziv.'"');
    // header('Content-Disposition: attachment;filename="'.$filename.'"'); 
    //header('Cache-Control: max-age=0'); //no cache
    $objWriter = new PHPExcel_Writer_Excel2007($excel);
    $objWriter-&gt;save('../tmp/'.$naziv);

}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3795" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3795" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1566f34c7e5701e26ec2ceb82b90378d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/630/douglaspossas" class="user-moderator-N"><span itemprop="name">Douglas Bezerra Possas</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3796" href="#C3796">
                <time itemprop="dateCreated" datetime="2013-10-10T14:11:53-07:00" class="action-date">Oct '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>the tmp directory (in root folder project) needs to be writable</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3796" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3796" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/1566f34c7e5701e26ec2ceb82b90378d?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/630/douglaspossas" class="user-moderator-N"><span itemprop="name">Douglas Bezerra Possas</span></a>        </span>
        <br>

        <span class="karma">1.4k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C3797" href="#C3797">
                <time itemprop="dateCreated" datetime="2013-10-10T17:50:04-07:00" class="action-date">Oct '13</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>See more in <a href="https://stackoverflow.com/questions/19303339/create-excel-file-in-phalcon-php-framework">https://stackoverflow.com/questions/19303339/create-excel-file-in-phalcon-php-framework</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="3797" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="3797" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="https://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/a04a0c9d2362009cf980d4431b8d7555?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="https://schema.org/Person">
            <a href="/user/6359/msecravi" class="user-moderator-N"><span itemprop="name">msecravi</span></a>        </span>
        <br>

        <span class="karma">62</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C30359" href="#C30359">
                <time itemprop="dateCreated" datetime="2016-02-29T02:17:49-07:00" class="action-date">Feb '16</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Create MyTags function name createExcelAction()
Fatal error: Class 'PHPExcel' not found in /app/customhelpers/MyTags.php on line 1145</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="30359" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="30359" data-cf-modified-948adb825b46a2dd0956f9b5-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1010" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>