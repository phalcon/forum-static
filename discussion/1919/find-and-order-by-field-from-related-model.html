---
layout: default
title: 'Find()  and order by field from related model - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/2/orm">ORM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Find()  and order by field from related model</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a></span>
            <time itemprop="dateCreated" datetime="2014-03-26T13:05:01-07:00">Mar '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-03-26T13:05:01-07:00">Mar '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Oct '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">8</span>
                </td>
                <td>
                    <label>Views</label><br>16609</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a></span>
                <span class="karma">21.2k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C1919" href="#C1919">
        <time class="action-date">Mar '14</time>
    </a>
</div>
<div class="post-content"><div><p>Hello! </p>
<p>I'm working on a search, order and paginate option for my project and this all works ok. But i have a one question. </p>
<p>Is it possible to order on a field from a related model? </p>
<p>For example: i have an object called Robot, and each robot has one Manufacturer, they are related with IDs, is there a way to sort on the manufacturers name with use of Robos::find() ? </p>
<p>Robots::find(array('order', 'manufacturername DESC')); </p>
<p>I can't find anything in the documentation or on the forum about this. I know i can do this with raw SQL queries and joining the manufacturer table but i would like to avoid that. </p>
<p>Thanks in advance!</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-0616fe08d59b26d79e128d90-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-0616fe08d59b26d79e128d90-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6608" href="#C6608">
                <time itemprop="dateCreated" datetime="2014-03-26T13:14:05-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't think there is with just find().  At least with PHQL, your result set can still be a collection of Robots, so you don't need to instantiate &amp; populate a bunch of objects.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6608" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6608" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a>        </span>
        <br>

        <span class="karma">21.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6610" href="#C6610">
                <time itemprop="dateCreated" datetime="2014-03-26T13:19:58-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Hmm ok, thanks i was already afraid of this. </p>
<p>Would be cool if you could sort on the values of the object inside your collection. Not sure how heavy this is for the server but for example if have a few of these fields like the examle above and also some calculated fields the sorting query is going to be 'complex'.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6610" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6610" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6612" href="#C6612">
                <time itemprop="dateCreated" datetime="2014-03-26T13:24:20-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can sort on values of the object, but you're wanting to sort on values of a related object.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6612" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6612" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a>        </span>
        <br>

        <span class="karma">21.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6613" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6613" href="#C6613">
                <time itemprop="dateCreated" datetime="2014-03-26T13:26:34-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>yes indeed, that was what I meant.</p>
<p>Isnt it possible to do the following in this case: and than order on this field?</p>
<p>Model:</p>
<pre><code class="language-php">    class Product {
      public $manufacturername

      public function afterFetch()
      {
          $this-&gt;manufacturername = $this-&gt;manufacturer-&gt;name;
      }
    }</code></pre>
<p><strong>Edit</strong>: this does not work with find() because it runs a query and it can't find the manufacturername field (ofcourse). Btw,  I see that there is a 'filter' option in a resultset but not an order/sort option (<a href="http://docs.phalcon.io/en/1.2.6/api/Phalcon_Mvc_Model_Resultset.html">http://docs.phalcon.io/en/1.2.6/api/Phalcon_Mvc_Model_Resultset.html</a>)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6613" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6613" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6614" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6614" href="#C6614">
                <time itemprop="dateCreated" datetime="2014-03-26T15:04:59-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You can do anything always ;)<br />
I don't know what your models are, but shape it for your use, should work  </p>
<pre><code class="language-php">class Robots extends \Phalcon\Mvc\Model
{

    public function find_extended($parameters)
    {
        $robots = self::find($parameters);
        foreach($robots as $robot)
        {
            $manufactures = Manufactures::find(array(
                    "robot_manufacture = {$robot-&gt;id}",
                    "order" =&gt; "manufacture_name"
                ));

            $robot-&gt;manufactures = $manufactures;
            $new_collection[] = $robot;
        }

        return $new_collection;
    }    
} </code></pre>
<p>You can use it like this</p>
<pre><code class="language-php">class IndexController extends \Phalcon\Mvc\Controller 
{
    public function indexAction()
    {
        $robots = Robots::find_extended(array(
            "robot_generation = 'steel'",
            "order" =&gt; "robot_name ASC"
        ));

        foreach($robots as $robot)
        {
            print_r($robot-&gt;manufactures-&gt;toArray()); //your manufactures should be sorted
        }
    }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6614" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6614" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6615" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6615" href="#C6615">
                <time itemprop="dateCreated" datetime="2014-03-26T15:24:40-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>or you can try something like this:</p>
<pre><code class="language-php">class Manufactures extends \Phalcon\Model\Mvc
{
    public function find($parameters)
    {
        $parameters['order'] = "name ASC";
        return parent::find($parameters);
    }
}</code></pre>
<p>Try one of this solution and reply if it works.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6615" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6615" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/c393137504e3c8e04fec99f187fcc33e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1057/maxgalbu" class="user-moderator-N"><span itemprop="name">Max Galbusera</span></a>        </span>
        <br>

        <span class="karma">3.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6620" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6620" href="#C6620">
                <time itemprop="dateCreated" datetime="2014-03-26T16:06:14-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/kaphert">@kaphert</a> you can join tables using Robots::query() aka <code>Phalcon\Mvc\Model\Criteria</code> or using <code>Phalcon\Mvc\Model\Query\Builder</code>:</p>
<pre><code class="language-php">$robots = Robots::query()
    -&gt;columns("Robots.id")
    -&gt;leftJoin("Manufacturers") //This should work without a condition if you defined a relation between Robots and Manufacturers
    -&gt;order("Manufacturers.name")
    -&gt;execute()</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6620" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6620" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a>        </span>
        <br>

        <span class="karma">21.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6622" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6622" href="#C6622">
                <time itemprop="dateCreated" datetime="2014-03-26T16:51:58-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Karol">@Karol</a> Marcinkiewicz that is indeed a solution. But not sure if this is flexible enough in my case<a href="https://forum.phalcon.io/user/0/maxgalbu">
@maxgalbu</a> this is also an idea! And pretty straightforward</p>
<p>My idea is to make it flexible to sort on all possible fields of the model or related models and search in all these fields. Not that I need to sort/search on ALL of the fields but it is nice to have the possibility of doing it, right? I was hoping phalcon was going to help me a little bit but i'm afraid it is going to be a little bit more extra work :-) </p>
<p>I'm going to try both solution tomorrow and see what works best in my case. </p>
<p>Thanks a lot for now !</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6622" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6622" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6624" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6624" href="#C6624">
                <time itemprop="dateCreated" datetime="2014-03-26T20:46:50-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>It is hot idea, you can beautify it or extend as you wish. As parameter to find is always array() you can push there option which you use fo what you want.</p>
<p>Using in Controller</p>
<pre><code class="language-php">class IndexController extends \Phalcon\Mvc\Controller
{
    public function indexAction()
    {
        $robots = Robots::find_extended(array(
                "robot_generation = 'steel'",
                "order" =&gt; "robot_name ASC",
                /* below you define $parameters for Manufactures::find($parameters) */
                "manufactures_find" =&gt; array(
                    "country = 'USA'",
                    "order" =&gt; "name ASC"
                )
            ));

        foreach($robots as $robot)
        {
            print_r($robot-&gt;manufactures-&gt;toArray()); //your manufactures should be sorted
        }
    }
}</code></pre>
<p>Model method</p>
<pre><code class="language-php">class Robots extends \Phalcon\Mvc\Model
{
    public function find_extended($parameters)
    {
        $manufactures_find = $parameters['manufactures_find']; // get $parameters for Manufactures::find($parameters);

        /* i don't know if you have to unset below, i didn't test it so maybe find() use only what it knows nothing more */
        unset($parameters['manufactures_find']); //remove above parameters from parameters to Robots::find($parameters);

        $robots = self::find($parameters);
        foreach($robots as $robot)
        {
            $manufactures = Manufactures::find($manufactures_find); // use above parameters to search and sort as you wish

            $robot-&gt;manufactures = $manufactures;
            $new_collection[] = $robot;
        }

        return $new_collection;
    }
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6624" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6624" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a>        </span>
        <br>

        <span class="karma">21.2k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6632" href="#C6632">
                <time itemprop="dateCreated" datetime="2014-03-27T05:39:03-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/Karol">@Karol</a>, at first I thought this was going to work i don't think this is going to work. Now you are sorting all manufacturers by name for each robot. But the order of the robots do not change in this case, correct? </p>
<p>I have 1 robot that has 1 manufacturer, I want to sort all robots based on the name of the manufacturer. </p>
<p>I'm going to try one of the other solutions =)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6632" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6632" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/21f0e8bdd7d2f5cdcf825811f3e24c06?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1072/kaphert" class="user-moderator-N"><span itemprop="name">kaphert</span></a>        </span>
        <br>

        <span class="karma">21.2k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="6642" data-toggle="modal" data-target="#historyModal">
                edited <span>Mar '14</span>
              </span><br/><a name="C6642" href="#C6642">
                <time itemprop="dateCreated" datetime="2014-03-27T08:49:30-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ok guys, i've made a solution that works for me and is also pretty flexible based on the querybuilder. </p>
<p>In my controller:</p>
<pre><code class="language-php">    $aFilter = array(
            'conditions' =&gt; 'name LIKE :search: OR Models\Manufacturer.name LIKE :search:',
            'bind' =&gt; array(
                    'search' =&gt; '%search value%'   
                ),
            'order' =&gt; 'Models\Manufacturer.name DESC',
        );
    Robot::search($aFilter);</code></pre>
<p>In my model i've made the following: </p>
<pre><code class="language-php">    public static function search($params=null)
    {
        $query = self::query();

        // check if we need to join a table     
        preg_match_all('/[\S]*\./', $params['conditions'] .' '. $params['order'], $aModelsToJoin);
        if(count($aModelsToJoin) &gt; 0) {
            // remove duplicates
            $aModelsToJoin = array_filter(array_unique($aModelsToJoin));
            foreach ($aModelsToJoin as $model) {
                $query-&gt;leftJoin(rtrim($model[0],'.'));
            }
        }

        if(isset($params['conditions'])) {         
            $query-&gt;where($params['conditions'],$params['bind']);
        }

        if(isset($params['order'])) {         
            $query-&gt;order($params['order']);    
        }            

        return $query-&gt;execute();
    }</code></pre>
<p>It searches for table aliases and joins them if needed, works like a charm in my case and I can add this to my base controller so it is available in every model.</p>
<p>Thanks for all your help, it helped me out a lot to figure out a solution!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6642" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6642" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/693cd29a926f2659ccec45ba126abd71?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/11/doit76" class="user-moderator-N"><span itemprop="name">Karol Marcinkiewicz</span></a>        </span>
        <br>

        <span class="karma">40.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6644" href="#C6644">
                <time itemprop="dateCreated" datetime="2014-03-27T09:33:08-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><a href="https://forum.phalcon.io/user/0/kaphert">@kaphert</a> i showed you a way how you can extends models and do what you want. Thay you can do anything yourself, don't wait for framework to do everything for you. I am happy that you tried to find implementation and it works for you. We didn't know your envoirment, schema, target etc, we were trying to help you to push forward your knowledge about framework :)<br />
Good work</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6644" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6644" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/746a625a9264a203a6ddf711e0c6b120?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/301/quasipickle" class="user-moderator-Y"><span itemprop="name">Dylan Anderson</span></a>        </span>
        <br>

        <span class="karma">125.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C6646" href="#C6646">
                <time itemprop="dateCreated" datetime="2014-03-27T09:43:42-07:00" class="action-date">Mar '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Might I suggest that since you're sending an array to <code>search()</code>, that you add a new item <strong>join</strong> rather than regexing your query?  Regex is powerful, but slow, and you're doing extra work in your method to accommodate some shortcomings.  Using a <strong>join</strong> item, you wouldn't have to run <code>preg_match_all()</code> or remove duplicates.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="6646" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="6646" data-cf-modified-0616fe08d59b26d79e128d90-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="1919" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>