---
layout: default
title: 'Phalcon moveTo function is not moving files to target directory in server? - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/25/configuration">Configuration</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">Phalcon moveTo function is not moving files to target directory in server?</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a></span>
            <time itemprop="dateCreated" datetime="2019-08-05T07:38:51-07:00">Aug '19</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2019-08-05T07:38:51-07:00">Aug '19</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Aug '19</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">4</span>
                </td>
                <td>
                    <label>Views</label><br>261</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/d3b07acb440fe79976cb95ea365d0054?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a></span>
                <span class="karma">5.8k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C19915" href="#C19915">
        <time class="action-date">Aug '19</time>
    </a>
</div>
<div class="post-content"><div><p>I'm trying to upload an image to a specific directory but the function <code>moveTo</code> is not moving the image.</p>
<pre><code>public function uploadRecipeImageAction() {
    if ($this-&gt;request-&gt;hasFiles() == true) {
        $file = $this-&gt;request-&gt;getUploadedFiles()[0];
        $target_file = '/uploads/ketogenic-recipes/'.preg_replace("/[^a-z0-9\_\-\.]/i", '', basename($file-&gt;getName()));
        $file-&gt;moveTo($_SERVER['DOCUMENT_ROOT'] . $target_file);
    }
    return $target_file;
}</code></pre>
<p>The function works fine locally but it's not working in server. There are no errors in logs</p>
<p><code>uploads</code> and <code>ketogenic-recipes</code> directory permissions are set to <code>0775</code></p>
<p>PHP Version <strong>7.2.20</strong></p>
<p>Phalcon version is <strong>3.4</strong></p>
<pre><code>var_dump($_SERVER['DOCUMENT_ROOT']) = string(30) "/home/web/public_html/test2"
var_dump($target_file); = string(42) "/uploads/ketogenic-recipes/harrypotter.jpg"</code></pre></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-96a237610c81331ae49a5028-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-96a237610c81331ae49a5028-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1632/ruudboon" class="user-moderator-N"><span itemprop="name">Ruud Boon</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60617" href="#C60617">
                <time itemprop="dateCreated" datetime="2019-08-05T07:47:41-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Most of the time this is caused by a permission issue.
Could you try </p>
<pre><code>if (is_writable(dirname($_SERVER['DOCUMENT_ROOT'].$target_file))) {
    echo 'The dir is writable';
} else {
    echo 'The dir is not writable';
}</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60617" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60617" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d3b07acb440fe79976cb95ea365d0054?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a>        </span>
        <br>

        <span class="karma">5.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60617"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Ruud Boon                    </a>
                </div><div class="posts-buttons" align="right"><a name="C60619" href="#C60619">
                <time itemprop="dateCreated" datetime="2019-08-05T07:49:55-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>Most of the time this is caused by a permission issue.
Could you try </p>
<pre><code>if (is_writable(dirname($_SERVER['DOCUMENT_ROOT'].$target_file))) {
   echo 'The dir is writable';
} else {
   echo 'The dir is not writable';
}</code></pre>
<p>The dir is not writable but permissions are set to 0775? Should I try 777? and will it not be dangerous? Any other alternative?</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60619" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60619" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d3b07acb440fe79976cb95ea365d0054?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a>        </span>
        <br>

        <span class="karma">5.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60617"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Ruud Boon                    </a>
                </div><div class="posts-buttons" align="right"><a name="C60621" href="#C60621">
                <time itemprop="dateCreated" datetime="2019-08-05T07:53:11-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>Most of the time this is caused by a permission issue.
Could you try </p>
<pre><code>if (is_writable(dirname($_SERVER['DOCUMENT_ROOT'].$target_file))) {
   echo 'The dir is writable';
} else {
   echo 'The dir is not writable';
}</code></pre>
</blockquote>
<p>I changed <code>uploads</code> and directories permission to <code>777</code> but still I got the not writable message!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60621" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60621" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1632/ruudboon" class="user-moderator-N"><span itemprop="name">Ruud Boon</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60623" href="#C60623">
                <time itemprop="dateCreated" datetime="2019-08-05T07:56:55-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This will depend on your server configuration and owner of the directory.
If your webserver is running as user www and the owner of the directory is www you should be fine with 0775.
First number is Owner, Second Group, third is everybody (<a href="https://en.wikipedia.org/wiki/Chmod">https://en.wikipedia.org/wiki/Chmod</a>)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60623" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60623" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1632/ruudboon" class="user-moderator-N"><span itemprop="name">Ruud Boon</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60625" href="#C60625">
                <time itemprop="dateCreated" datetime="2019-08-05T07:58:19-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>I changed uploads and directories permission to 777 but still I got the not writable message!
Maybe your webserver config is blocking this. And are you sure the path is correct?</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60625" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60625" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d3b07acb440fe79976cb95ea365d0054?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a>        </span>
        <br>

        <span class="karma">5.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C60623"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Ruud Boon                    </a>
                </div><div class="posts-buttons" align="right"><a name="C60627" href="#C60627">
                <time itemprop="dateCreated" datetime="2019-08-05T08:09:42-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>This will depend on your server configuration and owner of the directory.
If your webserver is running as user www and the owner of the directory is www you should be fine with 0775.
First number is Owner, Second Group, third is everybody (<a href="https://en.wikipedia.org/wiki/Chmod">https://en.wikipedia.org/wiki/Chmod</a>)</p>
</blockquote>
<p>Everything seems fine but still not moving the images to target directory!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60627" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60627" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d3b07acb440fe79976cb95ea365d0054?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/10073/iftikharuddin" class="user-moderator-N"><span itemprop="name">Iftikhar uddin</span></a>        </span>
        <br>

        <span class="karma">5.8k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="60671" data-toggle="modal" data-target="#historyModal">
                edited <span>Aug '19</span>
              </span><br/><a name="C60671" href="#C60671">
                <time itemprop="dateCreated" datetime="2019-08-08T08:21:22-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>We moved from old server to new server. And I found few wrong configurations which was the reason for not moving images/files to target directories.
Thanks to<a href="https://forum.phalcon.io/user/0/ruudboon"> @ruudboon</a> for the help; </p>
<h2>PHP-FPM was not enabled</h2>
<p>Our site was running on PHP <code>7.2.20</code> but <code>PHP-FPM</code> was not enabled on our website. So this means it was not using site specific <code>php.ini</code></p>
<h2>Wrong home directory</h2>
<p>I mistakenly set home path for the sub-domains in cPanel. They were pointing to the sub-domain root instead of the <code>web</code> folder ( <em>in phalcon we have web as home directory</em> ). So <code>$_SERVER['DOCUMENT_ROOT']</code> was pointing to the root folder; not to the <code>web</code> folder.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60671" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60671" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">2</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/d01ce04a6be1a8b86c3546969d241bd2?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1632/ruudboon" class="user-moderator-N"><span itemprop="name">Ruud Boon</span></a>        </span>
        <br>

        <span class="karma">10.1k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C60673" href="#C60673">
                <time itemprop="dateCreated" datetime="2019-08-08T08:39:45-07:00" class="action-date">Aug '19</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Perfect and thnx for posting the solution!</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="60673" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="60673" data-cf-modified-96a237610c81331ae49a5028-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="19915" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>