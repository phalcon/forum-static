---
layout: default
title: 'uniqueness for collection - Discussion'
---

    <div class="container">
        {% include warning.html %}


<div itemscope itemtype="http://schema.org/Question"><ol class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/category/23/odm">ODM</a></li>
</ol>
<div class="row table-title">
    <div class="col-lg-8 col-md-7 col-sm-6 col-xs-12 wrapper-author">
        <h1 class="" itemprop="name">uniqueness for collection</h1>
        <div class="visible-xs-block mobile-author">
            <span itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a></span>
            <time itemprop="dateCreated" datetime="2014-12-14T11:26:14-07:00">Dec '14</time>
        </div>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-6 hidden-xs text-right wrapper-stats">
        <table class="table-stats" width="100%">
            <tr style="vertical-align: top;">
                <td>
                    <label>Created</label><br>
                    <time itemprop="dateCreated" datetime="2014-12-14T11:26:14-07:00">Dec '14</time>
                </td>
                <td>
                    <label>Last Reply</label><br>Jun '15</td>
                <td>
                    <label>Replies</label><br>
                    <span itemprop="answerCount">10</span>
                </td>
                <td>
                    <label>Views</label><br>1929</td>
                <td>
                    <label>Votes</label><br>
                    <span itemprop="upvoteCount">0</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="discussion">
        <div class="row reply-block">
            <div class="col-md-1 col-sm-1 hidden-xs text-center">
                <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded avatar" /><br>
                <span itemprop="author" itemscope itemtype="http://schema.org/Person" class="avatar-name"><a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a></span>
                <span class="karma">10.7k</span>
            </div>
            <div class="col-md-11 col-sm-11 col-xs-12 post-body"><div class="posts-date hidden-xs" align="right">
        <a name="C4250" href="#C4250">
        <time class="action-date">Dec '14</time>
    </a>
</div>
<div class="post-content"><div><p>Is there anything like &quot;Uniqueness&quot; validator for a collection?</p></div>                </div>

                <div class="posts-buttons text-right"><a href="#"  class="btn btn-danger btn-xs" data-cf-modified-3e0e140dd9447a79252d40f7-="">
        <span class="glyphicon glyphicon-thumbs-down"></span></a>
    <a href="#"  class="btn btn-success btn-xs" data-cf-modified-3e0e140dd9447a79252d40f7-="">
        <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
            </div>
        </div><div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14153" href="#C14153">
                <time itemprop="dateCreated" datetime="2014-12-14T11:39:45-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I trying to use :
<a href="https://github.com/phalcon/dasshy/blob/master/app/models/Users.php#L34">https://github.com/phalcon/dasshy/blob/master/app/models/Users.php#L34</a>
<a href="https://github.com/phalcon/dasshy/blob/master/app/validators/Uniqueness.php">https://github.com/phalcon/dasshy/blob/master/app/validators/Uniqueness.php</a></p>
<p>But getting : Fatal error: Declaration of Truffula\Validators\Uniqueness::validate() must be compatible with Phalcon\Mvc\Model\ValidatorInterface::validate(Phalcon\Mvc\ModelInterface $record) in /Users/IGonza/git/truffula/app/validators/Uniqueness.php on line 9</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14153" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14153" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14155" href="#C14155">
                <time itemprop="dateCreated" datetime="2014-12-14T12:37:05-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><pre><code class="language-php">
namespace xxx\Validators;
use Phalcon\Mvc\Model\Validator,
    Phalcon\Mvc\Model\ValidatorInterface,
    Phalcon\Mvc\Model\Message;

class Uniqueness extends Validator implements ValidatorInterface
{
    /**
     * Validates that the record is unique
     *
     * @param Phalcon\Mvc\Collection $record
     * @return boolean
     */
    public function validate($record)
    {
        $field = $this-&gt;getOption('field');

        $count = $record::count(array(
            array($field =&gt; $record-&gt;readAttribute($field))
        ));

        if ($count &gt; 0) {
            $message = $this-&gt;getOption('message');
            $this-&gt;appendMessage(new Message($message, $field));
            return false;
        }

        return true;
    }

    //public function getMessages() {}
}
</code></pre></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14155" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14155" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14156" href="#C14156">
                <time itemprop="dateCreated" datetime="2014-12-14T12:58:31-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>phalcon 2.0.0b</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14156" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14156" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bdee79ea2680ec179fa34b9201fc74b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1873/RompePC" class="user-moderator-N"><span itemprop="name">RompePC</span></a>        </span>
        <br>

        <span class="karma">33.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14158" href="#C14158">
                <time itemprop="dateCreated" datetime="2014-12-14T14:58:19-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><ol>
<li><code>new Uniqueness(["message" =&gt; "bla", "field" =&gt; "bla"])</code>.</li>
<li>Is <code>validation</code>, not <code>validate</code>.</li>
<li>Inside it, you do <code>$this-&gt;validate($validatorOfFirstPoint)</code> (for each validator) and finally <code>return !$this-&gt;validationHasFailed()</code>.</li>
</ol></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14158" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14158" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14159" href="#C14159">
                <time itemprop="dateCreated" datetime="2014-12-14T15:18:17-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><ol>
<li>I have </li>
</ol>
<pre><code class="language-php">$email-&gt;addValidators(array(
    new Uniqueness(array(
                    'field' =&gt; 'email',
                    'message' =&gt; 'This email is already registered'
                ))
));
</code></pre>
<p>2 Where should it be validation but not validate?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14159" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14159" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bdee79ea2680ec179fa34b9201fc74b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1873/RompePC" class="user-moderator-N"><span itemprop="name">RompePC</span></a>        </span>
        <br>

        <span class="karma">33.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14160" href="#C14160">
                <time itemprop="dateCreated" datetime="2014-12-14T15:21:29-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p><code>public function validation()</code></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14160" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14160" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14161" href="#C14161">
                <time itemprop="dateCreated" datetime="2014-12-14T15:24:56-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I don't think so.
Check this : <a href="https://github.com/phalcon/dasshy/blob/master/app/validators/Uniqueness.php">https://github.com/phalcon/dasshy/blob/master/app/validators/Uniqueness.php</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14161" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14161" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bdee79ea2680ec179fa34b9201fc74b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1873/RompePC" class="user-moderator-N"><span itemprop="name">RompePC</span></a>        </span>
        <br>

        <span class="karma">33.8k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14162" href="#C14162">
                <time itemprop="dateCreated" datetime="2014-12-14T16:03:36-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Ah, my fault. I wasn't thinking using own validators, so I'm not of much help...</p>
<p>BTW, the signature of the function looks good. Try specifying <code>(Phalcon\Mvc\ModelInterface $record)</code> (but I don't think it will solve it).</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14162" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14162" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/17876bcd8516dad0f53a307a7d339f04?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2550/IGonza" class="user-moderator-N"><span itemprop="name">IGonza</span></a>        </span>
        <br>

        <span class="karma">10.7k</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C14163" href="#C14163">
                <time itemprop="dateCreated" datetime="2014-12-14T16:05:27-07:00" class="action-date">Dec '14</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>yes, I tried that.. didn't help</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="14163" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="14163" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/86f4bb2bd05efaa356e53793a283cee5?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2915/ilkercapli" class="user-moderator-N"><span itemprop="name">İlker Çaplı</span></a>        </span>
        <br>

        <span class="karma">868</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="15011" data-toggle="modal" data-target="#historyModal">
                edited <span>Jan '15</span>
              </span><br/><a name="C15011" href="#C15011">
                <time itemprop="dateCreated" datetime="2015-01-17T15:02:03-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I have also similar issue but I have implemented Uniqueness validator it works perfectly on new records.
The problem occures when I try to update an entry, validation fires an uniqueness error. It handles operation like create event.</p>
<h2>Here is the update code for collection model:</h2>
<pre><code class="language-php">        $shelf = Collections\ShelfCollection::findFirst(array(
             array('label' =&gt; 'my-label')
         ));

         if($shelf) {
             $shelf-&gt;value = 'changed-value';
             if ($shelf-&gt;save() == false) {
                 foreach ($shelf-&gt;getMessages() as $message) {
                     echo $message, "\n";
                 }
             } else {
                 echo "Shelf value updated successfully!&lt;br /&gt;";
             }
         }
         else {
             echo 'Shelf label not found';
         }</code></pre>
<hr />
<p>Simply you can take a look to my collection model:</p>
<hr />
<pre><code class="language-php"> &lt;?php
 namespace Collections;

 use Validator\Collection\UniqueValidator As Uniqueness,
     Phalcon\Mvc\Model\Message as Message;

 class ShelfCollection extends \Phalcon\Mvc\Collection {

     public $label;
     public $value;

     public function getSource()
     {
         return "shelf";
     }

     public function initialize()
     {
         // Auto generate _id keys
         $this-&gt;useImplicitObjectIds(true);
     }

     public function validation()
     {
         $this-&gt;validate(new Uniqueness(
             array(
                 "field"   =&gt; "value",
                 "message" =&gt; "Value must be unique"
             )
         ));

         $this-&gt;validate(new Uniqueness(
             array(
                 "field"   =&gt; "label",
                 "message" =&gt; "Label must be unique"
             )
         ));

         return $this-&gt;validationHasFailed() != true;
     }

     public function beforeSave()
     {
         // May Apply Here Business Layout Model
     }
 }</code></pre>
<h2>file for: Validator\Collection\UniqueValidator</h2>
<pre><code class="language-php">namespace Validator\Collection;

use Phalcon\Mvc\Model\Validator,
    Phalcon\Mvc\Model\ValidatorInterface;

class UniqueValidator extends Validator implements ValidatorInterface
{

    public function validate($record)
    {
        $field = $this-&gt;getOption('field');
        if ($record-&gt;count(array("field" =&gt; $record-&gt;readAttribute($field)))) {
            $this-&gt;appendMessage("The ".$field." must be unique", $field, "Unique");
            return false;
        }
        return true;
    }

}</code></pre>
<p>I guess we need to redevelop the validate method for uniqueness :)</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15011" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15011" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/2801/kenjis" class="user-moderator-N"><span itemprop="name">kenjis</span></a>        </span>
        <br>

        <span class="karma">2.2k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15011"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/86f4bb2bd05efaa356e53793a283cee5?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        İlker Çaplı                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15014" href="#C15014">
                <time itemprop="dateCreated" datetime="2015-01-17T15:37:07-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>You must add validation logic for updating, because when you update a recored, there is already a record.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15014" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15014" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/bdee79ea2680ec179fa34b9201fc74b7?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/1873/RompePC" class="user-moderator-N"><span itemprop="name">RompePC</span></a>        </span>
        <br>

        <span class="karma">33.8k</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C15014"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/e420241bec32f3d97b60f82e17550c2e?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        kenjis                    </a>
                </div><div class="posts-buttons" align="right"><a name="C15015" href="#C15015">
                <time itemprop="dateCreated" datetime="2015-01-17T16:29:15-07:00" class="action-date">Jan '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><blockquote>
<p>You must add validation logic for updating, because when you update a recored, there is already a record.</p>
</blockquote>
<p>Yep, I said that in other post. You've to control which <em>UNIQUE</em> fields are &quot;updated&quot; or not (I use a private variable). Then, in the validator, if it has changed, add the validator.</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="15015" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="15015" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5e6ccffaa06025155ac2032e926e271a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4093/Nafania" class="user-moderator-N"><span itemprop="name">Nafania</span></a>        </span>
        <br>

        <span class="karma">106</span></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><span class="action-date action-reply-edit" data-id="19591" data-toggle="modal" data-target="#historyModal">
                edited <span>Jun '15</span>
              </span><br/><a name="C19591" href="#C19591">
                <time itemprop="dateCreated" datetime="2015-06-17T02:23:20-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Doesn't work for me</p>
<blockquote>
<p>Fatal error: Declaration of app\common\components\validators\Unique::validate() must be compatible with Phalcon\Mvc\Model\ValidatorInterface::validate(Phalcon\Mvc\ModelInterface $record)</p>
</blockquote>
<p>But if i use declaration as</p>
<p><code>public function validate(\Phalcon\Mvc\ModelInterface $record)</code></p>
<p>I got new error</p>
<blockquote>
<p>Catchable fatal error: Argument 1 passed to app\common\components\validators\Unique::validate() must implement interface Phalcon\Mvc\ModelInterface, instance of \Phalcon\Mvc\Collection given</p>
</blockquote>
<p>How can i solve this?</p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19591" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19591" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/556abc0b0fcdeae8e744e26b773f0174?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4187/fterragna" class="user-moderator-N"><span itemprop="name">fterragna</span></a>        </span>
        <br>

        <span class="karma">84</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C19591"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/5e6ccffaa06025155ac2032e926e271a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Nafania                    </a>
                </div><div class="posts-buttons" align="right"><a name="C19897" href="#C19897">
                <time itemprop="dateCreated" datetime="2015-06-25T11:54:38-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>I'm also experiencing this issue. Anyone have a solution there?</p>
<blockquote>
<p>Doesn't work for me</p>
<blockquote>
<p>Fatal error: Declaration of app\common\components\validators\Unique::validate() must be compatible with Phalcon\Mvc\Model\ValidatorInterface::validate(Phalcon\Mvc\ModelInterface $record)</p>
</blockquote>
<p>But if i use declaration as</p>
<p><code>public function validate(\Phalcon\Mvc\ModelInterface $record)</code></p>
<p>I got new error</p>
<blockquote>
<p>Catchable fatal error: Argument 1 passed to app\common\components\validators\Unique::validate() must implement interface Phalcon\Mvc\ModelInterface, instance of \Phalcon\Mvc\Collection given</p>
</blockquote>
<p>How can i solve this?</p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19897" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19897" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span><span itemprop="upvoteCount">1</span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer acceptedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row reply-accepted">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/210/andresgutierrez" class="user-moderator-Y"><span itemprop="name">Andres Gutierrez</span></a>        </span>
        <br>

        <span class="karma">34.6k</span><div class="accepted-reply">
                <span class="glyphicon glyphicon-ok"></span>
                Accepted<br>answer
            </div></div>
    <div class="col-md-11"><div class="posts-buttons" align="right"><a name="C19901" href="#C19901">
                <time itemprop="dateCreated" datetime="2015-06-25T12:32:18-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>Anyone needing to solve this can follow this answer: <a href="http://stackoverflow.com/questions/13873094/phalcon-odm-validation-messages/13876657#13876657">http://stackoverflow.com/questions/13873094/phalcon-odm-validation-messages/13876657#13876657</a></p></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19901" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span><span itemprop="downvoteCount">1</span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19901" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div itemprop="suggestedAnswer" itemscope itemtype="http://schema.org/Answer" class="reply-block row">
    <div class="col-md-1 small" align="center">
        <img src="https://secure.gravatar.com/avatar/5e6ccffaa06025155ac2032e926e271a?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" />        <br>

        <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <a href="/user/4093/Nafania" class="user-moderator-N"><span itemprop="name">Nafania</span></a>        </span>
        <br>

        <span class="karma">106</span></div>
    <div class="col-md-11"><div class="in-reply-to">
                    <a href="#C19901"><span class="glyphicon glyphicon-chevron-up"></span> in reply to
                        <img src="https://secure.gravatar.com/avatar/2e0bae293948bec8ffec40de279cbe41?s=48&amp;r=pg&amp;d=identicon" class="img-rounded" width="24" height="24" />                        Andres Gutierrez                    </a>
                </div><div class="posts-buttons" align="right"><a name="C19909" href="#C19909">
                <time itemprop="dateCreated" datetime="2015-06-25T13:19:49-07:00" class="action-date">Jun '15</time>
            </a>
        </div>
        <div class="post-content"><div itemprop="text"><p>This not work with latest framework for me cause of incopatible declaration of validate method.</p>
<p>Did you try this on phalcon 2.0?</p>
<blockquote>
<p>Anyone needing to solve this can follow this answer: <a href="http://stackoverflow.com/questions/13873094/phalcon-odm-validation-messages/13876657#13876657">http://stackoverflow.com/questions/13873094/phalcon-odm-validation-messages/13876657#13876657</a></p>
</blockquote></div></div>
        <div class="posts-buttons" align="right"><a href="#"  class="btn btn-danger btn-xs vote-login" data-id="19909" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-down"></span></a>
                <a href="#"  class="btn btn-success btn-xs vote-login" data-id="19909" data-cf-modified-3e0e140dd9447a79252d40f7-="">
                    <span class="glyphicon glyphicon-thumbs-up"></span></a></div>
    </div>
</div>
<div class="row"><div class="col-md-1 small" align="center"></div>
        <div class="col-md-11 login-comment">
            
        </div></div>
</div><input type="hidden" id="post-id" name="post-id" value="4250" /><div id="suggested-posts"></div>
    <div id="sticky-progress" style='display:none'></div>
</div>
    </div>